<html><!-- Mirrored from developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API/Web_audio_spatialization_basics by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 14 Feb 2023 04:49:16 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" href="../../../../../favicon-48x48.cbbd161b.png"><link rel="apple-touch-icon" href="../../../../../apple-touch-icon.6803c6f0.png"><meta name="theme-color" content="#ffffff"><link rel="manifest" href="../../../../../manifest.56b1cedc.json"><link rel="search" type="application/opensearchdescription+xml" href="https://developer.mozilla.org/opensearch.xml" title="MDN Web Docs"><title>Web audio spatialization basics</title><link rel="alternate" title="Fondamentaux pour la spatialisation avec Web Audio" href="https://developer.mozilla.org/fr/docs/Web/API/Web_Audio_API/Web_audio_spatialization_basics" hreflang="fr"><link rel="alternate" title="Web audio 공간화 기초" href="https://developer.mozilla.org/ko/docs/Web/API/Web_Audio_API/Web_audio_spatialization_basics" hreflang="ko"><link rel="alternate" title="Web audio 空间化基础" href="https://developer.mozilla.org/zh-CN/docs/Web/API/Web_Audio_API/Web_audio_spatialization_basics" hreflang="zh"><link rel="alternate" title="Web audio spatialization basics" href="Web_audio_spatialization_basics.html" hreflang="en"><meta name="robots" content="index, follow"><meta name="description" content="Hopefully, this article has given you an insight into how Web Audio spatialization works, and what each of the PannerNode properties do (there are quite a few of them).
  The values can be hard to manipulate sometimes and depending on your use case it can take some time to get them right."><meta property="og:url" content="Web_audio_spatialization_basics.html"><meta property="og:title" content="Web audio spatialization basics - Web APIs | MDN"><meta property="og:locale" content="en-US"><meta property="og:description" content="Hopefully, this article has given you an insight into how Web Audio spatialization works, and what each of the PannerNode properties do (there are quite a few of them).
  The values can be hard to manipulate sometimes and depending on your use case it can take some time to get them right."><meta property="og:image" content="../../../../../mdn-social-share.cd6c4a5a.png"><meta property="twitter:card" content="summary_large_image"><link rel="canonical" href="Web_audio_spatialization_basics.html"><style media="print">.article-actions-container,.document-toc-container,.language-menu,.main-menu-toggle,.mdn-cta-container,.on-github,.page-footer,.sidebar,.top-navigation-main,ul.prev-next{display:none!important}.main-page-content,.main-page-content pre{padding:2px}.main-page-content pre{border-left-width:2px}</style><script src="../../../../../static/js/ga.js" defer=""></script><script defer="defer" src="../../../../../static/js/main.5c9d40d0.js"></script><link href="../../../../../static/css/main.7d378400.css" rel="stylesheet"></head><body><script>document.body.addEventListener("load",(t=>{t.target.classList.contains("interactive")&&t.target.setAttribute("data-readystate","complete")}),{capture:!0});const c={light:"#ffffff",dark:"#1b1b1b"};if(window&&document.documentElement)try{const t=window.localStorage.getItem("theme");t&&(document.documentElement.className=t,document.documentElement.style.backgroundColor=c[t])}catch(t){console.warn("Unable to read theme from localStorage",t)}</script><div id="root"><ul id="nav-access" class="a11y-nav"><li><a id="skip-main" href="#content">Skip to main content</a></li><li><a id="skip-search" href="#top-nav-search-input">Skip to search</a></li><li><a id="skip-select-language" href="#languages-switcher-button">Skip to select language</a></li></ul><div class="page-wrapper  category-api document-page"><div class="main-document-header-container"><header class="main-document-header-container top-navigation 
      
      "><div class="container "><div class="top-navigation-wrap"><a href="https://developer.mozilla.org/en-US/" class="logo" aria-label="MDN homepage"><svg id="mdn-docs-logo" xmlns="http://www.w3.org/2000/svg" x="0" y="0" viewBox="0 0 694.9 104.4" style="enable-background:new 0 0 694.9 104.4" xml:space="preserve" role="img"><title>MDN Web Docs</title><style>.logo-m{fill:var(--text-link)}</style><g class="logo-m"><path d="M40.3 0 11.7 92.1H0L28.5 0h11.8zM50.7 0v92.1H40.3V0h10.4zM91 0 62.5 92.1H50.8L79.3 0H91zM101.4 0v92.1H91V0h10.4z"></path></g><path class="logo-m" d="M627.9 95.6h67v8.8h-67v-8.8z"></path><g style="fill:var(--text-primary)"><path d="M367 42h-4l-10.7 30.8h-5.5l-10.8-26h-.4l-10.5 26h-5.2L308.7 42h-3.8v-5.6H323V42h-6.5l6.8 20.4h.4l10.3-26h4.7l11.2 26h.5l5.7-20.3h-6.2v-5.6H367V42zM401.9 62c-.4 3.2-2 5.9-4.7 8.2-2.8 2.3-6.5 3.4-11.3 3.4-5.4 0-9.7-1.6-13.1-4.7-3.3-3.2-5-7.7-5-13.7 0-5.7 1.6-10.3 4.7-14s7.4-5.5 12.9-5.5c5.1 0 9.1 1.6 11.9 4.7s4.3 6.9 4.3 11.3c0 1.5-.2 3-.5 4.7h-25.6c.3 7.7 4 11.6 10.9 11.6 2.9 0 5.1-.7 6.5-2 1.5-1.4 2.5-3 3-4.9l6 .9zM394 51.3c.2-2.4-.4-4.7-1.8-6.9s-3.8-3.3-7-3.3c-3.1 0-5.3 1-6.9 3-1.5 2-2.5 4.4-2.8 7.2H394zM445 53.7c0 5-1.3 9.5-4 13.7s-6.9 6.2-12.7 6.2c-6 0-10.3-2.2-12.7-6.7-.1.4-.2 1.4-.4 2.9s-.3 2.5-.4 2.9h-7.3c.3-1.7.6-3.5.8-5.3.3-1.8.4-3.7.4-5.5V22.3h-6v-5.6H416v27c1.1-2.2 2.7-4.1 4.7-5.7 2-1.6 4.8-2.4 8.4-2.4 4.6 0 8.4 1.6 11.4 4.7 3 3.2 4.5 7.6 4.5 13.4zm-7.7.6c0-4.2-1-7.4-3-9.5-2-2.2-4.4-3.3-7.4-3.3-3.4 0-6 1.2-8 3.7-1.9 2.4-2.9 5-3 7.7V57c0 3 1 5.6 3 7.7s4.5 3.1 7.6 3.1c3.6 0 6.3-1.3 8.1-3.9 1.8-2.7 2.7-5.9 2.7-9.6zM506.5 72.8h-13.2v-7.2c-1.2 2.2-2.8 4.1-4.9 5.6-2.1 1.6-4.8 2.4-8.3 2.4-4.8 0-8.7-1.6-11.6-4.9-2.9-3.2-4.3-7.7-4.3-13.3 0-5 1.3-9.6 4-13.7 2.6-4.1 6.9-6.2 12.8-6.2 5.7 0 9.8 2.2 12.3 6.5V22.3h-8.6v-5.6h15.8v50.6h6v5.5zM493.2 56v-4.4c-.1-3-1.2-5.5-3.2-7.3s-4.4-2.8-7.2-2.8c-3.6 0-6.3 1.3-8.2 3.9-1.9 2.6-2.8 5.8-2.8 9.6 0 4.1 1 7.3 3 9.5s4.5 3.3 7.4 3.3c3.2 0 5.8-1.3 7.8-3.8 2.1-2.6 3.1-5.3 3.2-8zM546.3 54.6c0 5.6-1.8 10.2-5.3 13.7s-8.2 5.3-13.9 5.3-10.1-1.7-13.4-5.1c-3.3-3.4-5-7.9-5-13.5 0-5.3 1.6-9.9 4.7-13.7 3.2-3.8 7.9-5.7 14.2-5.7s11 1.9 14.1 5.7c3 3.7 4.6 8.1 4.6 13.3zm-7.7-.2c0-4-1-7.2-3-9.5s-4.8-3.5-8.2-3.5c-3.6 0-6.4 1.2-8.3 3.7s-2.9 5.6-2.9 9.5c0 3.7.9 6.8 2.8 9.4 1.9 2.6 4.6 3.9 8.3 3.9 3.6 0 6.4-1.3 8.4-3.8 1.9-2.6 2.9-5.8 2.9-9.7zM583.6 60.2c-.4 3.2-1.9 6.3-4.4 9.1-2.5 2.9-6.4 4.3-11.8 4.3-5.2 0-9.4-1.6-12.6-4.8-3.2-3.2-4.8-7.7-4.8-13.7 0-5.5 1.6-10.1 4.7-13.9 3.2-3.8 7.6-5.7 13.2-5.7 2.3 0 4.6.3 6.7.8 2.2.5 4.2 1.5 6.2 2.9l1.5 9.5-5.9.7-1.3-6.1c-2.1-1.2-4.5-1.8-7.2-1.8-3.5 0-6.1 1.2-7.7 3.7-1.7 2.5-2.5 5.7-2.5 9.6 0 4.1.9 7.3 2.7 9.5 1.8 2.3 4.4 3.4 7.8 3.4 5.2 0 8.2-2.9 9.2-8.8l6.2 1.3zM618.3 62.1c0 3.6-1.5 6.5-4.6 8.5s-7 3-11.7 3c-5.7 0-10.6-1.2-14.6-3.6l1.2-8.8 5.7.6-.2 4.7c1.1.5 2.3.9 3.6 1.1s2.6.3 3.9.3c2.4 0 4.5-.4 6.5-1.3 1.9-.9 2.9-2.2 2.9-4.1 0-1.8-.8-3.1-2.3-3.8s-3.5-1.3-5.8-1.7-4.6-.9-6.9-1.4c-2.3-.6-4.2-1.6-5.7-2.9-1.6-1.4-2.3-3.5-2.3-6.3 0-4.1 1.5-6.9 4.6-8.5s6.4-2.4 9.9-2.4c2.6 0 5 .3 7.2.9 2.2.6 4.3 1.4 6.1 2.4l.8 8.8-5.8.7-.8-5.7c-2.3-1-4.7-1.6-7.2-1.6-2.1 0-3.7.4-5.1 1.1-1.3.8-2 2-2 3.8 0 1.7.8 2.9 2.3 3.6 1.5.7 3.4 1.2 5.7 1.6 2.2.4 4.5.8 6.7 1.4 2.2.6 4.1 1.6 5.7 3 1.4 1.6 2.2 3.7 2.2 6.6zM197.6 73.2h-17.1v-5.5h3.8V51.9c0-3.7-.7-6.3-2.1-7.9-1.4-1.6-3.3-2.3-5.7-2.3-3.2 0-5.6 1.1-7.2 3.4s-2.4 4.6-2.5 6.9v15.6h6v5.5h-17.1v-5.5h3.8V51.9c0-3.8-.7-6.4-2.1-7.9-1.4-1.5-3.3-2.3-5.6-2.3-3.2 0-5.5 1.1-7.2 3.3-1.6 2.2-2.4 4.5-2.5 6.9v15.8h6.9v5.5h-20.2v-5.5h6V42.4h-6.1v-5.6h13.4v6.4c1.2-2.1 2.7-3.8 4.7-5.2 2-1.3 4.4-2 7.3-2s5.3.7 7.5 2.1c2.2 1.4 3.7 3.5 4.5 6.4 1.1-2.5 2.7-4.5 4.9-6.1s4.8-2.4 7.9-2.4c3.5 0 6.5 1.1 8.9 3.3s3.7 5.6 3.7 10.2v18.2h6.1v5.5zm42.5 0h-13.2V66c-1.2 2.2-2.8 4.1-4.9 5.6-2.1 1.6-4.8 2.4-8.3 2.4-4.8 0-8.7-1.6-11.6-4.9-2.9-3.2-4.3-7.7-4.3-13.3 0-5 1.3-9.6 4-13.7 2.6-4.1 6.9-6.2 12.8-6.2s9.8 2.2 12.3 6.5V22.7h-8.6v-5.6h15.8v50.6h6v5.5zm-13.3-16.8V52c-.1-3-1.2-5.5-3.2-7.3s-4.4-2.8-7.2-2.8c-3.6 0-6.3 1.3-8.2 3.9-1.9 2.6-2.8 5.8-2.8 9.6 0 4.1 1 7.3 3 9.5s4.5 3.3 7.4 3.3c3.2 0 5.8-1.3 7.8-3.8 2.1-2.6 3.1-5.3 3.2-8zm61.5 16.8H269v-5.5h6V51.9c0-3.7-.7-6.3-2.2-7.9-1.4-1.6-3.4-2.3-5.7-2.3-3.1 0-5.6 1-7.4 3s-2.8 4.4-2.9 7v15.9h6v5.5h-19.3v-5.5h6V42.4h-6.2v-5.6h13.6V43c2.6-4.6 6.8-6.9 12.7-6.9 3.6 0 6.7 1.1 9.2 3.3s3.7 5.6 3.7 10.2v18.2h6v5.4h-.2z"></path></g></svg></a><button title="Open main menu" type="button" class="button action has-icon main-menu-toggle" aria-haspopup="menu" aria-label="Open main menu" aria-expanded="false"><span class="button-wrap"><span class="icon icon-menu "></span><span class="visually-hidden">Open main menu</span></span></button></div><div class="top-navigation-main"><nav class="main-nav" aria-label="Main menu"><ul class="main-menu nojs"><li class="top-level-entry-container"><button type="button" id="references-button" class="top-level-entry menu-toggle" aria-controls="references-menu" aria-expanded="false">References</button><a href="https://developer.mozilla.org/en-US/docs/Web" class="top-level-entry">References</a><ul id="references-menu" class="submenu references hidden inline-submenu-lg" aria-labelledby="references-button"><li class="apis-link-container mobile-only "><a href="https://developer.mozilla.org/en-US/docs/Web" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">Overview / Web Technology</div><p class="submenu-item-description">Web technology reference for developers</p></div></a></li><li class="html-link-container "><a href="https://developer.mozilla.org/en-US/docs/Web/HTML" class="submenu-item "><div class="submenu-icon html"></div><div class="submenu-content-container"><div class="submenu-item-heading">HTML</div><p class="submenu-item-description">Structure of content on the web</p></div></a></li><li class="css-link-container "><a href="https://developer.mozilla.org/en-US/docs/Web/CSS" class="submenu-item "><div class="submenu-icon css"></div><div class="submenu-content-container"><div class="submenu-item-heading">CSS</div><p class="submenu-item-description">Code used to describe document style</p></div></a></li><li class="javascript-link-container "><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript" class="submenu-item "><div class="submenu-icon javascript"></div><div class="submenu-content-container"><div class="submenu-item-heading">JavaScript</div><p class="submenu-item-description">General-purpose scripting language</p></div></a></li><li class="http-link-container "><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP" class="submenu-item "><div class="submenu-icon http"></div><div class="submenu-content-container"><div class="submenu-item-heading">HTTP</div><p class="submenu-item-description">Protocol for transmitting web resources</p></div></a></li><li class="apis-link-container "><a href="../../API.html" class="submenu-item "><div class="submenu-icon apis"></div><div class="submenu-content-container"><div class="submenu-item-heading">Web APIs</div><p class="submenu-item-description">Interfaces for building web applications</p></div></a></li><li class="apis-link-container "><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">Web Extensions</div><p class="submenu-item-description">Developing extensions for web browsers</p></div></a></li><li class="apis-link-container desktop-only "><a href="https://developer.mozilla.org/en-US/docs/Web" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">Web Technology</div><p class="submenu-item-description">Web technology reference for developers</p></div></a></li></ul></li><li class="top-level-entry-container"><button type="button" id="guides-button" class="top-level-entry menu-toggle" aria-controls="guides-menu" aria-expanded="false">Guides</button><a href="https://developer.mozilla.org/en-US/docs/Learn" class="top-level-entry">Guides</a><ul id="guides-menu" class="submenu guides hidden inline-submenu-lg" aria-labelledby="guides-button"><li class="apis-link-container mobile-only "><a href="https://developer.mozilla.org/en-US/docs/Learn" class="submenu-item "><div class="submenu-icon learn"></div><div class="submenu-content-container"><div class="submenu-item-heading">Overview / MDN Learning Area</div><p class="submenu-item-description">Learn web development</p></div></a></li><li class="apis-link-container desktop-only "><a href="https://developer.mozilla.org/en-US/docs/Learn" class="submenu-item "><div class="submenu-icon learn"></div><div class="submenu-content-container"><div class="submenu-item-heading">MDN Learning Area</div><p class="submenu-item-description">Learn web development</p></div></a></li><li class="html-link-container "><a href="https://developer.mozilla.org/en-US/docs/Learn/HTML" class="submenu-item "><div class="submenu-icon html"></div><div class="submenu-content-container"><div class="submenu-item-heading">HTML</div><p class="submenu-item-description">Learn to structure web content with HTML</p></div></a></li><li class="css-link-container "><a href="https://developer.mozilla.org/en-US/docs/Learn/CSS" class="submenu-item "><div class="submenu-icon css"></div><div class="submenu-content-container"><div class="submenu-item-heading">CSS</div><p class="submenu-item-description">Learn to style content using CSS</p></div></a></li><li class="javascript-link-container "><a href="https://developer.mozilla.org/en-US/docs/Learn/JavaScript" class="submenu-item "><div class="submenu-icon javascript"></div><div class="submenu-content-container"><div class="submenu-item-heading">JavaScript</div><p class="submenu-item-description">Learn to run scripts in the browser</p></div></a></li><li class=" "><a href="https://developer.mozilla.org/en-US/docs/Web/Accessibility" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">Accessibility</div><p class="submenu-item-description">Learn to make the web accessible to all</p></div></a></li></ul></li><li class="top-level-entry-container"><button type="button" id="mdn-plus-button" class="top-level-entry menu-toggle" aria-controls="mdn-plus-menu" aria-expanded="false">MDN Plus</button><a href="https://developer.mozilla.org/en-US/plus" class="top-level-entry">MDN Plus</a><ul id="mdn-plus-menu" class="submenu mdn-plus hidden inline-submenu-lg" aria-labelledby="mdn-plus-button"><li class=" "><a href="https://developer.mozilla.org/en-US/plus" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">Overview</div><p class="submenu-item-description">A customized MDN experience</p></div></a></li><li class=" "><a href="https://developer.mozilla.org/en-US/plus/updates" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">Updates</div><p class="submenu-item-description">All browser compatibility updates at a glance</p></div></a></li><li class=" "><a href="https://developer.mozilla.org/en-US/plus/docs/features/overview" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">Documentation</div><p class="submenu-item-description">Learn how to use MDN Plus</p></div></a></li><li class=" "><a href="https://developer.mozilla.org/en-US/plus/docs/faq" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">FAQ</div><p class="submenu-item-description">Frequently asked questions about MDN Plus</p></div></a></li></ul></li></ul></nav><div class="header-search"><form action="https://developer.mozilla.org/en-US/search" role="search" aria-haspopup="listbox" aria-owns="top-nav-search-menu" aria-expanded="false" class="search-form search-widget" id="top-nav-search-form"><label id="top-nav-search-label" for="top-nav-search-input" class="visually-hidden">Search MDN</label><input id="top-nav-search-input" aria-autocomplete="list" aria-controls="top-nav-search-menu" aria-labelledby="top-nav-search-label" autocomplete="off" type="search" class="search-input-field" name="q" placeholder="   " required="" value=""><button type="button" class="button action has-icon clear-search-button"><span class="button-wrap"><span class="icon icon-cancel "></span><span class="visually-hidden">Clear search input</span></span></button><button type="submit" class="button action has-icon search-button"><span class="button-wrap"><span class="icon icon-search "></span><span class="visually-hidden">Search</span></span></button><div id="top-nav-search-menu" role="listbox" aria-labelledby="top-nav-search-label"></div></form></div><div class="theme-switcher-menu"><button type="button" class="button action has-icon theme-switcher-menu small" aria-haspopup="menu"><span class="button-wrap"><span class="icon icon-theme-os-default "></span>Theme</span></button></div><ul class="auth-container"><li><a href="https://developer.mozilla.org/users/fxa/login/authenticate/?next=%2Fen-US%2Fdocs%2FWeb%2FAPI%2FWeb_Audio_API%2FWeb_audio_spatialization_basics" class="signin-link" rel="nofollow">Already a subscriber?</a></li><li><a class="button primary mdn-plus-subscribe-link" href="https://developer.mozilla.org/en-US/plus"><span class="button-wrap">Get MDN Plus</span></a></li></ul></div></div></header><div class="article-actions-container"><div class="container"><button type="button" class="button action has-icon sidebar-button" aria-label="Expand sidebar" aria-expanded="false" aria-controls="sidebar-quicklinks"><span class="button-wrap"><span class="icon icon-sidebar "></span></span></button><nav class="breadcrumbs-container" aria-label="Breadcrumb"><ol typeof="BreadcrumbList" vocab="https://schema.org/" aria-label="breadcrumbs"><li property="itemListElement" typeof="ListItem"><a class="breadcrumb" property="item" typeof="WebPage" href="https://developer.mozilla.org/en-US/docs/Web"><span property="name">References</span></a><meta property="position" content="1"></li><li property="itemListElement" typeof="ListItem"><a class="breadcrumb" property="item" typeof="WebPage" href="../../API.html"><span property="name">Web APIs</span></a><meta property="position" content="2"></li><li property="itemListElement" typeof="ListItem"><a class="breadcrumb" property="item" typeof="WebPage" href="../Web_Audio_API.html"><span property="name">Web Audio API</span></a><meta property="position" content="3"></li><li property="itemListElement" typeof="ListItem"><a class="breadcrumb-current-page" property="item" typeof="WebPage" href="Web_audio_spatialization_basics.html"><span property="name">Web audio spatialization basics</span></a><meta property="position" content="4"></li></ol></nav><div class="article-actions"><button type="button" class="button action has-icon article-actions-toggle" aria-label="Article actions"><span class="button-wrap"><span class="icon icon-ellipses "></span><span class="article-actions-dialog-heading">Article Actions</span></span></button><ul class="article-actions-entries"><li class="article-actions-entry"><div class="languages-switcher-menu open-on-focus-within"><button id="languages-switcher-button" type="button" class="button action small has-icon languages-switcher-menu" aria-haspopup="menu"><span class="button-wrap"><span class="icon icon-language "></span>English (US)</span></button></div></li></ul></div></div></div></div><div class="main-wrapper"><aside id="sidebar-quicklinks" class="sidebar"><button type="button" class="button action backdrop" aria-label="Collapse sidebar"><span class="button-wrap"></span></button><nav aria-label="Related Topics" class="sidebar-inner"><div class="in-nav-toc"><div class="document-toc-container"><section class="document-toc"><header><h2 class="document-toc-heading">In this article</h2></header><ul class="document-toc-list"><li class="document-toc-item "><a class="document-toc-link" href="#basics_of_spatialization">Basics of spatialization</a></li><li class="document-toc-item "><a class="document-toc-link" href="#3d_boombox_demo">3D boombox demo</a></li><li class="document-toc-item "><a class="document-toc-link" href="#creating_an_audio_listener">Creating an audio listener</a></li><li class="document-toc-item "><a class="document-toc-link" href="#creating_a_panner_node">Creating a panner node</a></li><li class="document-toc-item "><a class="document-toc-link" href="#moving_the_boombox">Moving the boombox</a></li><li class="document-toc-item "><a class="document-toc-link" href="#wiring_up_our_controls">Wiring up our controls</a></li><li class="document-toc-item "><a class="document-toc-link" href="#connecting_our_graph">Connecting our graph</a></li><li class="document-toc-item "><a class="document-toc-link" href="#summary">Summary</a></li></ul></section></div></div><div><ol><li><strong><a href="../Web_Audio_API.html">Web Audio API</a></strong></li><li class="toggle"><details open=""><summary>Guides</summary><ol><li><a href="Using_Web_Audio_API.html">Using the Web Audio API</a></li><li><a href="Basic_concepts_behind_Web_Audio_API.html">Basic concepts behind Web Audio API</a></li><li><a href="Best_practices.html">Web Audio API best practices</a></li><li><a href="Advanced_techniques.html">Advanced techniques: Creating and sequencing audio</a></li><li><a href="Using_AudioWorklet.html">Background audio processing using AudioWorklet</a></li><li><a href="Controlling_multiple_parameters_with_ConstantSourceNode.html">Controlling multiple parameters with ConstantSourceNode</a></li><li><a href="Migrating_from_webkitAudioContext.html">Migrating from webkitAudioContext</a></li><li><a href="Simple_synth.html">Example and tutorial: Simple synth keyboard</a></li><li><a href="Tools.html">Tools for analyzing Web Audio usage</a></li><li><a href="Using_IIR_filters.html">Using IIR filters</a></li><li><a href="Visualizations_with_Web_Audio_API.html">Visualizations with Web Audio API</a></li><li><em><a href="Web_audio_spatialization_basics.html" aria-current="page">Web audio spatialization basics</a></em></li></ol></details></li><li class="toggle"><details open=""><summary>Interfaces</summary><ol><li><a href="../AnalyserNode.html"><code>AnalyserNode</code></a></li><li><a href="../AudioBuffer.html"><code>AudioBuffer</code></a></li><li><a href="../AudioBufferSourceNode.html"><code>AudioBufferSourceNode</code></a></li><li><a href="../AudioContext.html"><code>AudioContext</code></a></li><li><a href="../AudioDestinationNode.html"><code>AudioDestinationNode</code></a></li><li><a href="../AudioListener.html"><code>AudioListener</code></a></li><li><a href="../AudioNode.html"><code>AudioNode</code></a></li><li><a href="../AudioParam.html"><code>AudioParam</code></a></li><li><a href="../AudioProcessingEvent.html"><code>AudioProcessingEvent</code></a></li><li><a href="../AudioScheduledSourceNode.html"><code>AudioScheduledSourceNode</code></a></li><li><a href="../AudioSinkInfo.html"><code>AudioSinkInfo</code></a></li><li><a href="../AudioWorklet.html"><code>AudioWorklet</code></a></li><li><a href="../AudioWorkletGlobalScope.html"><code>AudioWorkletGlobalScope</code></a></li><li><a href="../AudioWorkletNode.html"><code>AudioWorkletNode</code></a></li><li><a href="../AudioWorkletProcessor.html"><code>AudioWorkletProcessor</code></a></li><li><a href="../BaseAudioContext.html"><code>BaseAudioContext</code></a></li><li><a href="../BiquadFilterNode.html"><code>BiquadFilterNode</code></a></li><li><a href="../ChannelMergerNode.html"><code>ChannelMergerNode</code></a></li><li><a href="../ChannelSplitterNode.html"><code>ChannelSplitterNode</code></a></li><li><a href="../ConstantSourceNode.html"><code>ConstantSourceNode</code></a></li><li><a href="../ConvolverNode.html"><code>ConvolverNode</code></a></li><li><a href="../DelayNode.html"><code>DelayNode</code></a></li><li><a href="../DynamicsCompressorNode.html"><code>DynamicsCompressorNode</code></a></li><li><a href="../GainNode.html"><code>GainNode</code></a></li><li><a href="../IIRFilterNode.html"><code>IIRFilterNode</code></a></li><li><a href="../MediaElementAudioSourceNode.html"><code>MediaElementAudioSourceNode</code></a></li><li><a href="../MediaStreamAudioDestinationNode.html"><code>MediaStreamAudioDestinationNode</code></a></li><li><a href="../MediaStreamAudioSourceNode.html"><code>MediaStreamAudioSourceNode</code></a></li><li><a href="../OfflineAudioCompletionEvent.html"><code>OfflineAudioCompletionEvent</code></a></li><li><a href="../OfflineAudioContext.html"><code>OfflineAudioContext</code></a></li><li><a href="../OscillatorNode.html"><code>OscillatorNode</code></a></li><li><a href="../PannerNode.html"><code>PannerNode</code></a></li><li><a href="../PeriodicWave.html"><code>PeriodicWave</code></a></li><li><a href="../WaveShaperNode.html"><code>WaveShaperNode</code></a></li><li><a href="../StereoPannerNode.html"><code>StereoPannerNode</code></a></li></ol></details></li></ol></div></nav></aside><aside class="toc"><nav><div class="document-toc-container"><section class="document-toc"><header><h2 class="document-toc-heading">In this article</h2></header><ul class="document-toc-list"><li class="document-toc-item "><a class="document-toc-link" href="#basics_of_spatialization">Basics of spatialization</a></li><li class="document-toc-item "><a class="document-toc-link" href="#3d_boombox_demo">3D boombox demo</a></li><li class="document-toc-item "><a class="document-toc-link" href="#creating_an_audio_listener">Creating an audio listener</a></li><li class="document-toc-item "><a class="document-toc-link" href="#creating_a_panner_node">Creating a panner node</a></li><li class="document-toc-item "><a class="document-toc-link" href="#moving_the_boombox">Moving the boombox</a></li><li class="document-toc-item "><a class="document-toc-link" href="#wiring_up_our_controls">Wiring up our controls</a></li><li class="document-toc-item "><a class="document-toc-link" href="#connecting_our_graph">Connecting our graph</a></li><li class="document-toc-item "><a class="document-toc-link" href="#summary">Summary</a></li></ul></section></div></nav></aside><main id="content" class="main-content  "><article class="main-page-content" lang="en-US"><h1>Web audio spatialization basics</h1><div class="section-content"><p>
  As if its extensive variety of sound processing (and other) options wasn't enough, the Web Audio API also includes facilities to allow you to emulate the difference in sound as a listener moves around a sound source, for example panning as you move around a sound source inside a 3D game.
  The official term for this is <strong>spatialization</strong>, and this article will cover the basics of how to implement such a system.
</p></div><section aria-labelledby="basics_of_spatialization"><a class="dashAnchor" name="//apple_ref/Section/Basics%20of%20spatialization"></a><h2 id="basics_of_spatialization"><a href="#basics_of_spatialization">Basics of spatialization</a></h2><div class="section-content"><p>
  In Web Audio, complex 3D spatializations are created using the <a href="../PannerNode.html"><code>PannerNode</code></a>, which in layman's terms is basically a whole lotta cool maths to make audio appear in 3D space.
  Think sounds flying over you, creeping up behind you, moving across in front of you.
  That sort of thing.
</p>
<p>
  It's really useful for WebXR and gaming.
  In 3D spaces, it's the only way to achieve realistic audio. Libraries like <a href="https://threejs.org/" class="external" target="_blank">three.js</a> and <a href="https://aframe.io/" class="external" target="_blank">A-frame</a> harness its potential when dealing with sound.
  It's worth noting that you don't <em>have</em> to move sound within a full 3D space either — you could stick with just a 2D plane, so if you were planning a 2D game, this would still be the node you were looking for.
</p>
<div class="notecard note" id="sect1">
  <p>
    <strong>Note:</strong> There's also a <a href="../StereoPannerNode.html"><code>StereoPannerNode</code></a> designed to deal with the common use case of creating simple left and right stereo panning effects.
    This is much simpler to use, but obviously nowhere near as versatile.
    If you just want a simple stereo panning effect, our <a href="../../../../../../mdn.github.io/webaudio-examples/stereo-panner-node/index.html" class="external" target="_blank">StereoPannerNode example</a> (<a href="https://github.com/mdn/webaudio-examples/tree/master/stereo-panner-node" class="external" target="_blank">see source code</a>) should give you everything you need.
  </p>
</div></div></section><section aria-labelledby="3d_boombox_demo"><a class="dashAnchor" name="//apple_ref/Section/3D%20boombox%20demo"></a><h2 id="3d_boombox_demo"><a href="#3d_boombox_demo">3D boombox demo</a></h2><div class="section-content"><p>
  To demonstrate 3D spatialization we've created a modified version of the boombox demo we created in our basic <a href="Using_Web_Audio_API.html">Using the Web Audio API</a> guide.
  See the <a href="../../../../../../mdn.github.io/webaudio-examples/spatialization/index.html" class="external" target="_blank">3D spatialization demo live</a> (and see the <a href="https://github.com/mdn/webaudio-examples/tree/master/spatialization" class="external" target="_blank">source code</a> also).
</p>
<p>
  <img src="Web_audio_spatialization_basics/web-audio-spatialization.png" alt="A simple UI with a rotated boombox and controls to move it left and right and in and out, and rotate it." width="949" height="724" loading="lazy">
</p>
<p>
  The boombox sits inside a room (defined by the edges of the browser viewport), and in this demo, we can move and rotate it with the provided controls.
  When we move the boombox, the sound it produces changes accordingly, panning as it moves to the left or right of the room, or becoming quieter as it is moved away from the user or is rotated so the speakers are facing away from them, etc.
  This is done by setting the different properties of the <code>PannerNode</code> object instance in relation to that movement, to emulate spacialization.
</p>
<div class="notecard note" id="sect2">
  <p><strong>Note:</strong> The experience is much better if you use headphones, or have some kind of surround sound system to plug your computer into.</p>
</div></div></section><section aria-labelledby="creating_an_audio_listener"><a class="dashAnchor" name="//apple_ref/Section/Creating%20an%20audio%20listener"></a><h2 id="creating_an_audio_listener"><a href="#creating_an_audio_listener">Creating an audio listener</a></h2><div class="section-content"><p>
  So let's begin! The <a href="../BaseAudioContext.html"><code>BaseAudioContext</code></a> (the interface the <a href="../AudioContext.html"><code>AudioContext</code></a> is extended from) has a <a href="../BaseAudioContext/listener.html"><code>listener</code></a> property that returns an <a href="../AudioListener.html"><code>AudioListener</code></a> object.
  This represents the listener of the scene, usually your user.
  You can define where they are in space and in which direction they are facing.
  They remain static. The <code>pannerNode</code> can then calculate its sound position relative to the position of the listener.
</p>
<p>Let's create our context and listener and set the listener's position to emulate a person looking into our room:</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token keyword">const</span> AudioContext <span class="token operator">=</span> window<span class="token punctuation">.</span>AudioContext <span class="token operator">||</span> window<span class="token punctuation">.</span>webkitAudioContext<span class="token punctuation">;</span>
<span class="token keyword">const</span> audioCtx <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AudioContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> listener <span class="token operator">=</span> audioCtx<span class="token punctuation">.</span>listener<span class="token punctuation">;</span>

<span class="token keyword">const</span> posX <span class="token operator">=</span> window<span class="token punctuation">.</span>innerWidth<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> posY <span class="token operator">=</span> window<span class="token punctuation">.</span>innerHeight<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> posZ <span class="token operator">=</span> <span class="token number">300</span><span class="token punctuation">;</span>

listener<span class="token punctuation">.</span>positionX<span class="token punctuation">.</span>value <span class="token operator">=</span> posX<span class="token punctuation">;</span>
listener<span class="token punctuation">.</span>positionY<span class="token punctuation">.</span>value <span class="token operator">=</span> posY<span class="token punctuation">;</span>
listener<span class="token punctuation">.</span>positionZ<span class="token punctuation">.</span>value <span class="token operator">=</span> posZ<span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">;</span>
</code></pre></div>
<p>We could move the listener left or right using <code>positionX</code>, up or down using <code>positionY</code>, or in or out of the room using <code>positionZ</code>. Here we are setting the listener to be in the middle of the viewport and slightly in front of our boombox. We can also set the direction the listener is facing. The default values for these work well:</p>
<div class="code-example"><pre class="brush: js notranslate"><code>listener<span class="token punctuation">.</span>forwardX<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
listener<span class="token punctuation">.</span>forwardY<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
listener<span class="token punctuation">.</span>forwardZ<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
listener<span class="token punctuation">.</span>upX<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
listener<span class="token punctuation">.</span>upY<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
listener<span class="token punctuation">.</span>upZ<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
</code></pre></div>
<p>
  The forward properties represent the 3D coordinate position of the listener's forward direction (e.g. the direction they are facing in), while the up properties represent the 3D coordinate position of the top of the listener's head.
  These two together can nicely set the direction.
</p></div></section><section aria-labelledby="creating_a_panner_node"><a class="dashAnchor" name="//apple_ref/Section/Creating%20a%20panner%20node"></a><h2 id="creating_a_panner_node"><a href="#creating_a_panner_node">Creating a panner node</a></h2><div class="section-content"><p>Let's create our <a href="../PannerNode.html"><code>PannerNode</code></a>. This has a whole bunch of properties associated with it. Let's take a look at each of them:</p>
<p>
  To start we can set the <a href="../PannerNode/panningModel.html"><code>panningModel</code></a>.
  This is the spacialization algorithm that's used to position the audio in 3D space. We can set this to:
</p>
<p><code>equalpower</code> — The default and the general way panning is figured out</p>
<p><code>HRTF</code> — This stands for 'Head-related transfer function' and looks to take into account the human head when figuring out where the sound is.</p>
<p>Pretty clever stuff. Let's use the <code>HRTF</code> model!</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token keyword">const</span> panningModel <span class="token operator">=</span> <span class="token string">'HRTF'</span><span class="token punctuation">;</span>
</code></pre></div>
<p>
  The <a href="../PannerNode/coneInnerAngle.html"><code>coneInnerAngle</code></a> and <a href="../PannerNode/coneOuterAngle.html"><code>coneOuterAngle</code></a> properties specify where the volume emanates from.
  By default, both are 360 degrees.
  Our boombox speakers will have smaller cones, which we can define.
  The inner cone is where gain (volume) is always emulated at a maximum and the outer cone is where the gain starts to drop away.
  The gain is reduced by the value of the <a href="../PannerNode/coneOuterGain.html"><code>coneOuterGain</code></a>.
  Let's create constants that store the values we'll use for these parameters later on:
</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token keyword">const</span> innerCone <span class="token operator">=</span> <span class="token number">60</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> outerCone <span class="token operator">=</span> <span class="token number">90</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> outerGain <span class="token operator">=</span> <span class="token number">0.3</span><span class="token punctuation">;</span>
</code></pre></div>
<p>The next parameter is <a href="../PannerNode/distanceModel.html"><code>distanceModel</code></a> — this can only be set to <code>linear</code>, <code>inverse</code>, or <code>exponential</code>. These are different algorithms, which are used to reduce the volume of the audio source as it moves away from the listener. We'll use <code>linear</code>, as it is simple:</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token keyword">const</span> distanceModel <span class="token operator">=</span> <span class="token string">'linear'</span><span class="token punctuation">;</span>
</code></pre></div>
<p>
  We can set a maximum distance (<a href="../PannerNode/maxDistance.html"><code>maxDistance</code></a>) between the source and the listener — the volume will not be reduced anymore if the source moves further away from this point.
  This can be useful, as you may find you want to emulate distance, but volume can drop out and that's actually not what you want.
  By default, it's 10,000 (a unitless relative value). We can keep it as this:
</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token keyword">const</span> maxDistance <span class="token operator">=</span> <span class="token number">10000</span><span class="token punctuation">;</span>
</code></pre></div>
<p>
  There's also a reference distance (<a href="../PannerNode/refDistance.html"><code>refDistance</code></a>), which is used by the distance models.
  We can keep that at the default value of <code>1</code> as well:
</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token keyword">const</span> refDistance <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre></div>
<p>
  Then there's the roll-off factor (<a href="../PannerNode/rolloffFactor.html"><code>rolloffFactor</code></a>) — how quickly does the volume reduce as the panner moves away from the listener.
  The default value is 1; let's make that a bit bigger to exaggerate our movements.
</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token keyword">const</span> rollOff <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
</code></pre></div>
<p>
  Now we can start setting our position and orientation of our boombox.
  This is a lot like how we did it with our listener.
  These are also the parameters we're going to change when the controls on our interface are used.
</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token keyword">const</span> positionX <span class="token operator">=</span> posX<span class="token punctuation">;</span>
<span class="token keyword">const</span> positionY <span class="token operator">=</span> posY<span class="token punctuation">;</span>
<span class="token keyword">const</span> positionZ <span class="token operator">=</span> posZ<span class="token punctuation">;</span>

<span class="token keyword">const</span> orientationX <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> orientationY <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> orientationZ <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">;</span>
</code></pre></div>
<p>
  Note the minus value on our z orientation — this sets the boombox to face us.
  A positive value would set the sound source facing away from us.
</p>
<p>Let's use the relevant constructor for creating our panner node and pass in all those parameters we set above:</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token keyword">const</span> panner <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PannerNode</span><span class="token punctuation">(</span>audioCtx<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  panningModel<span class="token punctuation">,</span>
  distanceModel<span class="token punctuation">,</span>
  positionX<span class="token punctuation">,</span>
  positionY<span class="token punctuation">,</span>
  positionZ<span class="token punctuation">,</span>
  orientationX<span class="token punctuation">,</span>
  orientationY<span class="token punctuation">,</span>
  orientationZ<span class="token punctuation">,</span>
  refDistance<span class="token punctuation">,</span>
  maxDistance<span class="token punctuation">,</span>
  <span class="token literal-property property">rolloffFactor</span><span class="token operator">:</span> rollOff<span class="token punctuation">,</span>
  <span class="token literal-property property">coneInnerAngle</span><span class="token operator">:</span> innerCone<span class="token punctuation">,</span>
  <span class="token literal-property property">coneOuterAngle</span><span class="token operator">:</span> outerCone<span class="token punctuation">,</span>
  <span class="token literal-property property">coneOuterGain</span><span class="token operator">:</span> outerGain<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></div></section><section aria-labelledby="moving_the_boombox"><a class="dashAnchor" name="//apple_ref/Section/Moving%20the%20boombox"></a><h2 id="moving_the_boombox"><a href="#moving_the_boombox">Moving the boombox</a></h2><div class="section-content"><p>
  Now we're going to move our boombox around our 'room'. We've got some controls set up to do this.
  We can move it left and right, up and down, and back and forth; we can also rotate it.
  The sound direction is coming from the boombox speaker at the front, so when we rotate it, we can alter the sound's direction — i.e. make it project to the back when the boombox is rotated 180 degrees and facing away from us.
</p>
<p>
  We need to set up a few things for the interface.
  First, we'll get references to the elements we want to move, then we'll store references to the values we'll change when we set up <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Transforms">CSS transforms</a> to actually do the movement.
  Finally, we'll set some bounds so our boombox doesn't move too far in any direction:
</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token keyword">const</span> moveControls <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#move-controls'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'button'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> boombox <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.boombox-body'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// the values for our CSS transforms</span>
<span class="token keyword">const</span> transform <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">xAxis</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token literal-property property">yAxis</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token literal-property property">zAxis</span><span class="token operator">:</span> <span class="token number">0.8</span><span class="token punctuation">,</span>
  <span class="token literal-property property">rotateX</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token literal-property property">rotateY</span><span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span>

<span class="token comment">// set our bounds</span>
<span class="token keyword">const</span> topBound <span class="token operator">=</span> <span class="token operator">-</span>posY<span class="token punctuation">;</span>
<span class="token keyword">const</span> bottomBound <span class="token operator">=</span> posY<span class="token punctuation">;</span>
<span class="token keyword">const</span> rightBound <span class="token operator">=</span> posX<span class="token punctuation">;</span>
<span class="token keyword">const</span> leftBound <span class="token operator">=</span> <span class="token operator">-</span>posX<span class="token punctuation">;</span>
<span class="token keyword">const</span> innerBound <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> outerBound <span class="token operator">=</span> <span class="token number">1.5</span><span class="token punctuation">;</span>
</code></pre></div>
<p>Let's create a function that takes the direction we want to move as a parameter, and both modifies the CSS transform and updates the position and orientation values of our panner node properties to change the sound as appropriate.</p>
<p>
  To start with let's take a look at our left, right, up and down values as these are pretty straightforward.
  We'll move the boombox along these axis and update the appropriate position.
</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token keyword">function</span> <span class="token function">moveBoombox</span><span class="token punctuation">(</span><span class="token parameter">direction</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>direction<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">'left'</span><span class="token operator">:</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>transform<span class="token punctuation">.</span>xAxis <span class="token operator">&gt;</span> leftBound<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        transform<span class="token punctuation">.</span>xAxis <span class="token operator">-=</span> <span class="token number">5</span><span class="token punctuation">;</span>
        panner<span class="token punctuation">.</span>positionX<span class="token punctuation">.</span>value <span class="token operator">-=</span> <span class="token number">0.1</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">'up'</span><span class="token operator">:</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>transform<span class="token punctuation">.</span>yAxis <span class="token operator">&gt;</span> topBound<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        transform<span class="token punctuation">.</span>yAxis <span class="token operator">-=</span> <span class="token number">5</span><span class="token punctuation">;</span>
        panner<span class="token punctuation">.</span>positionY<span class="token punctuation">.</span>value <span class="token operator">-=</span> <span class="token number">0.3</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">'right'</span><span class="token operator">:</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>transform<span class="token punctuation">.</span>xAxis <span class="token operator">&lt;</span> rightBound<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        transform<span class="token punctuation">.</span>xAxis <span class="token operator">+=</span> <span class="token number">5</span><span class="token punctuation">;</span>
        panner<span class="token punctuation">.</span>positionX<span class="token punctuation">.</span>value <span class="token operator">+=</span> <span class="token number">0.1</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">'down'</span><span class="token operator">:</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>transform<span class="token punctuation">.</span>yAxis <span class="token operator">&lt;</span> bottomBound<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        transform<span class="token punctuation">.</span>yAxis <span class="token operator">+=</span> <span class="token number">5</span><span class="token punctuation">;</span>
        panner<span class="token punctuation">.</span>positionY<span class="token punctuation">.</span>value <span class="token operator">+=</span> <span class="token number">0.3</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>It's a similar story for our move in and out values too:</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token keyword">case</span> <span class="token string">'back'</span><span class="token operator">:</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>transform<span class="token punctuation">.</span>zAxis <span class="token operator">&gt;</span> innerBound<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    transform<span class="token punctuation">.</span>zAxis <span class="token operator">-=</span> <span class="token number">0.01</span><span class="token punctuation">;</span>
    panner<span class="token punctuation">.</span>positionZ<span class="token punctuation">.</span>value <span class="token operator">+=</span> <span class="token number">40</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">break</span><span class="token punctuation">;</span>
<span class="token keyword">case</span> <span class="token string">'forward'</span><span class="token operator">:</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>transform<span class="token punctuation">.</span>zAxis <span class="token operator">&lt;</span> outerBound<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    transform<span class="token punctuation">.</span>zAxis <span class="token operator">+=</span> <span class="token number">0.01</span><span class="token punctuation">;</span>
    panner<span class="token punctuation">.</span>positionZ<span class="token punctuation">.</span>value <span class="token operator">-=</span> <span class="token number">40</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">break</span><span class="token punctuation">;</span>
</code></pre></div>
<p>
  Our rotation values are a little more involved, however, as we need to move the sound <em>around</em>.
  Not only do we have to update two axis values (e.g. if you rotate an object around the x-axis, you update the y and z coordinates for that object), but we also need to do some more maths for this.
  The rotation is a circle and we need <a href="../../JavaScript/Reference/Global_Objects/Math/sin.html"><code>Math.sin</code></a> and <a href="../../JavaScript/Reference/Global_Objects/Math/cos.html"><code>Math.cos</code></a> to help us draw that circle.
</p>
<p>Let's set up a rotation rate, which we'll convert into a radian range value for use in <code>Math.sin</code> and <code>Math.cos</code> later, when we want to figure out the new coordinates when we're rotating our boombox:</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token comment">// set up rotation constants</span>
<span class="token keyword">const</span> rotationRate <span class="token operator">=</span> <span class="token number">60</span><span class="token punctuation">;</span> <span class="token comment">// bigger number equals slower sound rotation</span>

<span class="token keyword">const</span> q <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token operator">/</span>rotationRate<span class="token punctuation">;</span> <span class="token comment">//rotation increment in radians</span>
</code></pre></div>
<p>We can also use this to work out degrees rotated, which will help with the CSS transforms we will have to create (note we need both an x and y-axis for the CSS transforms):</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token comment">// get degrees for CSS</span>
<span class="token keyword">const</span> degreesX <span class="token operator">=</span> <span class="token punctuation">(</span>q <span class="token operator">*</span> <span class="token number">180</span><span class="token punctuation">)</span><span class="token operator">/</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> degreesY <span class="token operator">=</span> <span class="token punctuation">(</span>q <span class="token operator">*</span> <span class="token number">180</span><span class="token punctuation">)</span><span class="token operator">/</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">;</span>
</code></pre></div>
<p>Let's take a look at our left rotation as an example. We need to change the x orientation and the z orientation of the panner coordinates, to move around the y-axis for our left rotation:</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token keyword">case</span> <span class="token string">'rotate-left'</span><span class="token operator">:</span>
  transform<span class="token punctuation">.</span>rotateY <span class="token operator">-=</span> degreesY<span class="token punctuation">;</span>

  <span class="token comment">// 'left' is rotation about y-axis with negative angle increment</span>
  z <span class="token operator">=</span> panner<span class="token punctuation">.</span>orientationZ<span class="token punctuation">.</span>value<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span> <span class="token operator">-</span> panner<span class="token punctuation">.</span>orientationX<span class="token punctuation">.</span>value<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">;</span>
  x <span class="token operator">=</span> panner<span class="token punctuation">.</span>orientationZ<span class="token punctuation">.</span>value<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span> <span class="token operator">+</span> panner<span class="token punctuation">.</span>orientationX<span class="token punctuation">.</span>value<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">;</span>
  y <span class="token operator">=</span> panner<span class="token punctuation">.</span>orientationY<span class="token punctuation">.</span>value<span class="token punctuation">;</span>

  panner<span class="token punctuation">.</span>orientationX<span class="token punctuation">.</span>value <span class="token operator">=</span> x<span class="token punctuation">;</span>
  panner<span class="token punctuation">.</span>orientationY<span class="token punctuation">.</span>value <span class="token operator">=</span> y<span class="token punctuation">;</span>
  panner<span class="token punctuation">.</span>orientationZ<span class="token punctuation">.</span>value <span class="token operator">=</span> z<span class="token punctuation">;</span>
  <span class="token keyword">break</span><span class="token punctuation">;</span>
</code></pre></div>
<p>This <em>is</em> a little confusing, but what we're doing is using sin and cos to help us work out the circular motion the coordinates need for the rotation of the boombox.</p>
<p>We can do this for all the axes. We just need to choose the right orientations to update and whether we want a positive or negative increment.</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token keyword">case</span> <span class="token string">'rotate-right'</span><span class="token operator">:</span>
  transform<span class="token punctuation">.</span>rotateY <span class="token operator">+=</span> degreesY<span class="token punctuation">;</span>
  <span class="token comment">// 'right' is rotation about y-axis with positive angle increment</span>
  z <span class="token operator">=</span> panner<span class="token punctuation">.</span>orientationZ<span class="token punctuation">.</span>value<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span><span class="token operator">-</span>q<span class="token punctuation">)</span> <span class="token operator">-</span> panner<span class="token punctuation">.</span>orientationX<span class="token punctuation">.</span>value<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token operator">-</span>q<span class="token punctuation">)</span><span class="token punctuation">;</span>
  x <span class="token operator">=</span> panner<span class="token punctuation">.</span>orientationZ<span class="token punctuation">.</span>value<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token operator">-</span>q<span class="token punctuation">)</span> <span class="token operator">+</span> panner<span class="token punctuation">.</span>orientationX<span class="token punctuation">.</span>value<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span><span class="token operator">-</span>q<span class="token punctuation">)</span><span class="token punctuation">;</span>
  y <span class="token operator">=</span> panner<span class="token punctuation">.</span>orientationY<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
  panner<span class="token punctuation">.</span>orientationX<span class="token punctuation">.</span>value <span class="token operator">=</span> x<span class="token punctuation">;</span>
  panner<span class="token punctuation">.</span>orientationY<span class="token punctuation">.</span>value <span class="token operator">=</span> y<span class="token punctuation">;</span>
  panner<span class="token punctuation">.</span>orientationZ<span class="token punctuation">.</span>value <span class="token operator">=</span> z<span class="token punctuation">;</span>
  <span class="token keyword">break</span><span class="token punctuation">;</span>
<span class="token keyword">case</span> <span class="token string">'rotate-up'</span><span class="token operator">:</span>
  transform<span class="token punctuation">.</span>rotateX <span class="token operator">+=</span> degreesX<span class="token punctuation">;</span>
  <span class="token comment">// 'up' is rotation about x-axis with negative angle increment</span>
  z <span class="token operator">=</span> panner<span class="token punctuation">.</span>orientationZ<span class="token punctuation">.</span>value<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span><span class="token operator">-</span>q<span class="token punctuation">)</span> <span class="token operator">-</span> panner<span class="token punctuation">.</span>orientationY<span class="token punctuation">.</span>value<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token operator">-</span>q<span class="token punctuation">)</span><span class="token punctuation">;</span>
  y <span class="token operator">=</span> panner<span class="token punctuation">.</span>orientationZ<span class="token punctuation">.</span>value<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token operator">-</span>q<span class="token punctuation">)</span> <span class="token operator">+</span> panner<span class="token punctuation">.</span>orientationY<span class="token punctuation">.</span>value<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span><span class="token operator">-</span>q<span class="token punctuation">)</span><span class="token punctuation">;</span>
  x <span class="token operator">=</span> panner<span class="token punctuation">.</span>orientationX<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
  panner<span class="token punctuation">.</span>orientationX<span class="token punctuation">.</span>value <span class="token operator">=</span> x<span class="token punctuation">;</span>
  panner<span class="token punctuation">.</span>orientationY<span class="token punctuation">.</span>value <span class="token operator">=</span> y<span class="token punctuation">;</span>
  panner<span class="token punctuation">.</span>orientationZ<span class="token punctuation">.</span>value <span class="token operator">=</span> z<span class="token punctuation">;</span>
  <span class="token keyword">break</span><span class="token punctuation">;</span>
<span class="token keyword">case</span> <span class="token string">'rotate-down'</span><span class="token operator">:</span>
  transform<span class="token punctuation">.</span>rotateX <span class="token operator">-=</span> degreesX<span class="token punctuation">;</span>
  <span class="token comment">// 'down' is rotation about x-axis with positive angle increment</span>
  z <span class="token operator">=</span> panner<span class="token punctuation">.</span>orientationZ<span class="token punctuation">.</span>value<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span> <span class="token operator">-</span> panner<span class="token punctuation">.</span>orientationY<span class="token punctuation">.</span>value<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">;</span>
  y <span class="token operator">=</span> panner<span class="token punctuation">.</span>orientationZ<span class="token punctuation">.</span>value<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span> <span class="token operator">+</span> panner<span class="token punctuation">.</span>orientationY<span class="token punctuation">.</span>value<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">;</span>
  x <span class="token operator">=</span> panner<span class="token punctuation">.</span>orientationX<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
  panner<span class="token punctuation">.</span>orientationX<span class="token punctuation">.</span>value <span class="token operator">=</span> x<span class="token punctuation">;</span>
  panner<span class="token punctuation">.</span>orientationY<span class="token punctuation">.</span>value <span class="token operator">=</span> y<span class="token punctuation">;</span>
  panner<span class="token punctuation">.</span>orientationZ<span class="token punctuation">.</span>value <span class="token operator">=</span> z<span class="token punctuation">;</span>
  <span class="token keyword">break</span><span class="token punctuation">;</span>
</code></pre></div>
<p>
  One last thing — we need to update the CSS and keep a reference of the last move for the mouse event.
  Here's the final <code>moveBoombox</code> function.
</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token keyword">function</span> <span class="token function">moveBoombox</span><span class="token punctuation">(</span><span class="token parameter">direction<span class="token punctuation">,</span> prevMove</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>direction<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">'left'</span><span class="token operator">:</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>transform<span class="token punctuation">.</span>xAxis <span class="token operator">&gt;</span> leftBound<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        transform<span class="token punctuation">.</span>xAxis <span class="token operator">-=</span> <span class="token number">5</span><span class="token punctuation">;</span>
        panner<span class="token punctuation">.</span>positionX<span class="token punctuation">.</span>value <span class="token operator">-=</span> <span class="token number">0.1</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">'up'</span><span class="token operator">:</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>transform<span class="token punctuation">.</span>yAxis <span class="token operator">&gt;</span> topBound<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        transform<span class="token punctuation">.</span>yAxis <span class="token operator">-=</span> <span class="token number">5</span><span class="token punctuation">;</span>
        panner<span class="token punctuation">.</span>positionY<span class="token punctuation">.</span>value <span class="token operator">-=</span> <span class="token number">0.3</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">'right'</span><span class="token operator">:</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>transform<span class="token punctuation">.</span>xAxis <span class="token operator">&lt;</span> rightBound<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        transform<span class="token punctuation">.</span>xAxis <span class="token operator">+=</span> <span class="token number">5</span><span class="token punctuation">;</span>
        panner<span class="token punctuation">.</span>positionX<span class="token punctuation">.</span>value <span class="token operator">+=</span> <span class="token number">0.1</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">'down'</span><span class="token operator">:</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>transform<span class="token punctuation">.</span>yAxis <span class="token operator">&lt;</span> bottomBound<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        transform<span class="token punctuation">.</span>yAxis <span class="token operator">+=</span> <span class="token number">5</span><span class="token punctuation">;</span>
        panner<span class="token punctuation">.</span>positionY<span class="token punctuation">.</span>value <span class="token operator">+=</span> <span class="token number">0.3</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">'back'</span><span class="token operator">:</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>transform<span class="token punctuation">.</span>zAxis <span class="token operator">&gt;</span> innerBound<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        transform<span class="token punctuation">.</span>zAxis <span class="token operator">-=</span> <span class="token number">0.01</span><span class="token punctuation">;</span>
        panner<span class="token punctuation">.</span>positionZ<span class="token punctuation">.</span>value <span class="token operator">+=</span> <span class="token number">40</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">'forward'</span><span class="token operator">:</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>transform<span class="token punctuation">.</span>zAxis <span class="token operator">&lt;</span> outerBound<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        transform<span class="token punctuation">.</span>zAxis <span class="token operator">+=</span> <span class="token number">0.01</span><span class="token punctuation">;</span>
        panner<span class="token punctuation">.</span>positionZ<span class="token punctuation">.</span>value <span class="token operator">-=</span> <span class="token number">40</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">'rotate-left'</span><span class="token operator">:</span>
      transform<span class="token punctuation">.</span>rotateY <span class="token operator">-=</span> degreesY<span class="token punctuation">;</span>

      <span class="token comment">// 'left' is rotation about y-axis with negative angle increment</span>
      z <span class="token operator">=</span> panner<span class="token punctuation">.</span>orientationZ<span class="token punctuation">.</span>value<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span> <span class="token operator">-</span> panner<span class="token punctuation">.</span>orientationX<span class="token punctuation">.</span>value<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">;</span>
      x <span class="token operator">=</span> panner<span class="token punctuation">.</span>orientationZ<span class="token punctuation">.</span>value<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span> <span class="token operator">+</span> panner<span class="token punctuation">.</span>orientationX<span class="token punctuation">.</span>value<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">;</span>
      y <span class="token operator">=</span> panner<span class="token punctuation">.</span>orientationY<span class="token punctuation">.</span>value<span class="token punctuation">;</span>

      panner<span class="token punctuation">.</span>orientationX<span class="token punctuation">.</span>value <span class="token operator">=</span> x<span class="token punctuation">;</span>
      panner<span class="token punctuation">.</span>orientationY<span class="token punctuation">.</span>value <span class="token operator">=</span> y<span class="token punctuation">;</span>
      panner<span class="token punctuation">.</span>orientationZ<span class="token punctuation">.</span>value <span class="token operator">=</span> z<span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">'rotate-right'</span><span class="token operator">:</span>
      transform<span class="token punctuation">.</span>rotateY <span class="token operator">+=</span> degreesY<span class="token punctuation">;</span>
      <span class="token comment">// 'right' is rotation about y-axis with positive angle increment</span>
      z <span class="token operator">=</span> panner<span class="token punctuation">.</span>orientationZ<span class="token punctuation">.</span>value<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span><span class="token operator">-</span>q<span class="token punctuation">)</span> <span class="token operator">-</span> panner<span class="token punctuation">.</span>orientationX<span class="token punctuation">.</span>value<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token operator">-</span>q<span class="token punctuation">)</span><span class="token punctuation">;</span>
      x <span class="token operator">=</span> panner<span class="token punctuation">.</span>orientationZ<span class="token punctuation">.</span>value<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token operator">-</span>q<span class="token punctuation">)</span> <span class="token operator">+</span> panner<span class="token punctuation">.</span>orientationX<span class="token punctuation">.</span>value<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span><span class="token operator">-</span>q<span class="token punctuation">)</span><span class="token punctuation">;</span>
      y <span class="token operator">=</span> panner<span class="token punctuation">.</span>orientationY<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
      panner<span class="token punctuation">.</span>orientationX<span class="token punctuation">.</span>value <span class="token operator">=</span> x<span class="token punctuation">;</span>
      panner<span class="token punctuation">.</span>orientationY<span class="token punctuation">.</span>value <span class="token operator">=</span> y<span class="token punctuation">;</span>
      panner<span class="token punctuation">.</span>orientationZ<span class="token punctuation">.</span>value <span class="token operator">=</span> z<span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">'rotate-up'</span><span class="token operator">:</span>
      transform<span class="token punctuation">.</span>rotateX <span class="token operator">+=</span> degreesX<span class="token punctuation">;</span>
      <span class="token comment">// 'up' is rotation about x-axis with negative angle increment</span>
      z <span class="token operator">=</span> panner<span class="token punctuation">.</span>orientationZ<span class="token punctuation">.</span>value<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span><span class="token operator">-</span>q<span class="token punctuation">)</span> <span class="token operator">-</span> panner<span class="token punctuation">.</span>orientationY<span class="token punctuation">.</span>value<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token operator">-</span>q<span class="token punctuation">)</span><span class="token punctuation">;</span>
      y <span class="token operator">=</span> panner<span class="token punctuation">.</span>orientationZ<span class="token punctuation">.</span>value<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token operator">-</span>q<span class="token punctuation">)</span> <span class="token operator">+</span> panner<span class="token punctuation">.</span>orientationY<span class="token punctuation">.</span>value<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span><span class="token operator">-</span>q<span class="token punctuation">)</span><span class="token punctuation">;</span>
      x <span class="token operator">=</span> panner<span class="token punctuation">.</span>orientationX<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
      panner<span class="token punctuation">.</span>orientationX<span class="token punctuation">.</span>value <span class="token operator">=</span> x<span class="token punctuation">;</span>
      panner<span class="token punctuation">.</span>orientationY<span class="token punctuation">.</span>value <span class="token operator">=</span> y<span class="token punctuation">;</span>
      panner<span class="token punctuation">.</span>orientationZ<span class="token punctuation">.</span>value <span class="token operator">=</span> z<span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">'rotate-down'</span><span class="token operator">:</span>
      transform<span class="token punctuation">.</span>rotateX <span class="token operator">-=</span> degreesX<span class="token punctuation">;</span>
      <span class="token comment">// 'down' is rotation about x-axis with positive angle increment</span>
      z <span class="token operator">=</span> panner<span class="token punctuation">.</span>orientationZ<span class="token punctuation">.</span>value<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span> <span class="token operator">-</span> panner<span class="token punctuation">.</span>orientationY<span class="token punctuation">.</span>value<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">;</span>
      y <span class="token operator">=</span> panner<span class="token punctuation">.</span>orientationZ<span class="token punctuation">.</span>value<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span> <span class="token operator">+</span> panner<span class="token punctuation">.</span>orientationY<span class="token punctuation">.</span>value<span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">;</span>
      x <span class="token operator">=</span> panner<span class="token punctuation">.</span>orientationX<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
      panner<span class="token punctuation">.</span>orientationX<span class="token punctuation">.</span>value <span class="token operator">=</span> x<span class="token punctuation">;</span>
      panner<span class="token punctuation">.</span>orientationY<span class="token punctuation">.</span>value <span class="token operator">=</span> y<span class="token punctuation">;</span>
      panner<span class="token punctuation">.</span>orientationZ<span class="token punctuation">.</span>value <span class="token operator">=</span> z<span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  boombox<span class="token punctuation">.</span>style<span class="token punctuation">.</span>transform <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">translateX(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>transform<span class="token punctuation">.</span>xAxis<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px) </span><span class="token template-punctuation string">`</span></span> <span class="token operator">+</span>
    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">translateY(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>transform<span class="token punctuation">.</span>yAxis<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px) </span><span class="token template-punctuation string">`</span></span> <span class="token operator">+</span>
    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">scale(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>transform<span class="token punctuation">.</span>zAxis<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">) </span><span class="token template-punctuation string">`</span></span> <span class="token operator">+</span>
    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">rotateY(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>transform<span class="token punctuation">.</span>rotateY<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">deg) </span><span class="token template-punctuation string">`</span></span> <span class="token operator">+</span>
    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">rotateX(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>transform<span class="token punctuation">.</span>rotateX<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">deg)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> move <span class="token operator">=</span> prevMove <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  move<span class="token punctuation">.</span>frameId <span class="token operator">=</span> <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">moveBoombox</span><span class="token punctuation">(</span>direction<span class="token punctuation">,</span> move<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> move<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div></section><section aria-labelledby="wiring_up_our_controls"><a class="dashAnchor" name="//apple_ref/Section/Wiring%20up%20our%20controls"></a><h2 id="wiring_up_our_controls"><a href="#wiring_up_our_controls">Wiring up our controls</a></h2><div class="section-content"><p>Wiring up out control buttons is comparatively simple — now we can listen for a mouse event on our controls and run this function, as well as stop it when the mouse is released:</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token comment">// for each of our controls, move the boombox and change the position values</span>
moveControls<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">el</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token keyword">let</span> moving<span class="token punctuation">;</span>
  el<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'mousedown'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> direction <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>control<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>moving <span class="token operator">&amp;&amp;</span> moving<span class="token punctuation">.</span>frameId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">cancelAnimationFrame</span><span class="token punctuation">(</span>moving<span class="token punctuation">.</span>frameId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    moving <span class="token operator">=</span> <span class="token function">moveBoombox</span><span class="token punctuation">(</span>direction<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'mouseup'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>moving <span class="token operator">&amp;&amp;</span> moving<span class="token punctuation">.</span>frameId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">cancelAnimationFrame</span><span class="token punctuation">(</span>moving<span class="token punctuation">.</span>frameId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></div></section><section aria-labelledby="connecting_our_graph"><a class="dashAnchor" name="//apple_ref/Section/Connecting%20our%20graph"></a><h2 id="connecting_our_graph"><a href="#connecting_our_graph">Connecting our graph</a></h2><div class="section-content"><p>Our HTML contains the audio element we want to be affected by the panner node.</p>
<div class="code-example"><pre class="brush: html notranslate"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>audio</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>myCoolTrack.mp3<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>audio</span><span class="token punctuation">&gt;</span></span>
</code></pre></div>
<p>We need to grab the source from that element and pipe it into the Web Audio API using the <a href="../AudioContext/createMediaElementSource.html"><code>AudioContext.createMediaElementSource</code></a>.</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token comment">// get the audio element</span>
<span class="token keyword">const</span> audioElement <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'audio'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// pass it into the audio context</span>
<span class="token keyword">const</span> track <span class="token operator">=</span> audioContext<span class="token punctuation">.</span><span class="token function">createMediaElementSource</span><span class="token punctuation">(</span>audioElement<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>Next we have to connect our audio graph. We connect our input (the track) to our modification node (the panner) to our destination (in this case the speakers).</p>
<div class="code-example"><pre class="brush: js notranslate"><code>track<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>panner<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>audioCtx<span class="token punctuation">.</span>destination<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>Let's create a play button, that when clicked will play or pause the audio depending on the current state.</p>
<div class="code-example"><pre class="brush: html notranslate"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">data-playing</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span> <span class="token attr-name">role</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>switch<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Play/Pause<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre></div>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token comment">// Select our play button</span>
<span class="token keyword">const</span> playButton <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'button'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

playButton<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// Check if context is in suspended state (autoplay policy)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>audioContext<span class="token punctuation">.</span>state <span class="token operator">===</span> <span class="token string">'suspended'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    audioContext<span class="token punctuation">.</span><span class="token function">resume</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Play or pause track depending on state</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>playButton<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>playing <span class="token operator">===</span> <span class="token string">'false'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    audioElement<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    playButton<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>playing <span class="token operator">=</span> <span class="token string">'true'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>playButton<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>playing <span class="token operator">===</span> <span class="token string">'true'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    audioElement<span class="token punctuation">.</span><span class="token function">pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    playButton<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>playing <span class="token operator">=</span> <span class="token string">'false'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>For a more in depth look at playing/controlling audio and audio graphs check out <a href="Using_Web_Audio_API.html">Using The Web Audio API.</a></p></div></section><section aria-labelledby="summary"><a class="dashAnchor" name="//apple_ref/Section/Summary"></a><h2 id="summary"><a href="#summary">Summary</a></h2><div class="section-content"><p>
  Hopefully, this article has given you an insight into how Web Audio spatialization works, and what each of the <a href="../PannerNode.html"><code>PannerNode</code></a> properties do (there are quite a few of them).
  The values can be hard to manipulate sometimes and depending on your use case it can take some time to get them right.
</p>
<div class="notecard note" id="sect3">
  <p>
    <strong>Note:</strong> There are slight differences in the way the audio spatialization sounds across different browsers.
    The panner node does some very involved maths under the hood;
    there are a <a href="https://wpt.fyi/results/webaudio/the-audio-api/the-pannernode-interface?label=stable&amp;aligned=true" class="external" target="_blank">number of tests here</a> so you can keep track of the status of the inner workings of this node across different platforms.
  </p>
</div>
<p>
  Again, you can <a href="../../../../../../mdn.github.io/webaudio-examples/spatialization/index.html" class="external" target="_blank">check out the final demo here</a>, and the <a href="https://github.com/mdn/webaudio-examples/tree/master/spatialization" class="external" target="_blank">final source code is here</a>.
  There is also a <a href="https://codepen.io/Rumyra/pen/MqayoK?editors=0100" class="external" target="_blank">Codepen demo too</a>.
</p>
<p>
  If you are working with 3D games and/or WebXR it's a good idea to harness a 3D library to create such functionality, rather than trying to do this all yourself from first principles.
  We rolled our own in this article to give you an idea of how it works, but you'll save a lot of time by taking advantage of work others have done before you.
</p></div></section><aside class="metadata"><div class="metadata-content-container"><div id="on-github" class="on-github"><h3>Found a content problem with this page?</h3><ul><li>Edit the page <a href="https://github.com/mdn/content/edit/main/files/en-us/web/api/web_audio_api/web_audio_spatialization_basics/index.md" title="This will take you to GitHub, where you'll need to sign in first." target="_blank" rel="noopener noreferrer">on GitHub</a>.</li><li>Report the <a href="https://github.com/mdn/content/issues/new?template=page-report.yml&amp;mdn-url=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FWeb_Audio_API%2FWeb_audio_spatialization_basics&amp;metadata=%3C%21--+Do+not+make+changes+below+this+line+--%3E%0A%3Cdetails%3E%0A%3Csummary%3EPage+report+details%3C%2Fsummary%3E%0A%0A*+Folder%3A+%60en-us%2Fweb%2Fapi%2Fweb_audio_api%2Fweb_audio_spatialization_basics%60%0A*+MDN+URL%3A+https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FWeb_Audio_API%2FWeb_audio_spatialization_basics%0A*+GitHub+URL%3A+https%3A%2F%2Fgithub.com%2Fmdn%2Fcontent%2Fblob%2Fmain%2Ffiles%2Fen-us%2Fweb%2Fapi%2Fweb_audio_api%2Fweb_audio_spatialization_basics%2Findex.md%0A*+Last+commit%3A+https%3A%2F%2Fgithub.com%2Fmdn%2Fcontent%2Fcommit%2F003b0ec96775d2ce0a6590ab708ec69dc695cf0d%0A*+Document+last+modified%3A+2022-10-23T21%3A43%3A47.000Z%0A%0A%3C%2Fdetails%3E" title="This will take you to GitHub to file a new issue." target="_blank" rel="noopener noreferrer">content issue</a>.</li><li>View the source <a href="https://github.com/mdn/content/blob/main/files/en-us/web/api/web_audio_api/web_audio_spatialization_basics/index.md?plain=1" title="Folder: en-us/web/api/web_audio_api/web_audio_spatialization_basics (Opens in a new tab)" target="_blank" rel="noopener noreferrer">on GitHub</a>.</li></ul>Want to get more involved? Learn<!-- --> <a href="https://github.com/mdn/content/blob/main/CONTRIBUTING.md" title="This will take you to our contribution guidelines on GitHub." target="_blank" rel="noopener noreferrer">how to contribute</a>.</div><p class="last-modified-date">This page was last modified on<!-- --> <time datetime="2022-10-23T21:43:47.000Z">Oct 23, 2022</time> by<!-- --> <a href="Web_audio_spatialization_basics/contributors.txt">MDN contributors</a>.</p></div></aside></article></main></div><footer id="nav-footer" class="page-footer"><div><a href="http://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API/Web_audio_spatialization_basics">Web audio spatialization basics</a> by <a href="http://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API/Web_audio_spatialization_basics$history">Mozilla Contributors</a> is licensed under <a href="http://creativecommons.org/licenses/by-sa/2.5/">CC-BY-SA 2.5</a>.</div></footer></div></div><script type="application/json" id="hydration">{"doc":{"isMarkdown":true,"isTranslated":false,"isActive":true,"flaws":{},"title":"Web audio spatialization basics","mdn_url":"/en-US/docs/Web/API/Web_Audio_API/Web_audio_spatialization_basics","locale":"en-US","native":"English (US)","sidebarHTML":"<ol><li><strong><a href=\"/en-US/docs/Web/API/Web_Audio_API\">Web Audio API</a></strong></li><li class=\"toggle\"><details open=\"\"><summary>Guides</summary><ol><li><a href=\"/en-US/docs/Web/API/Web_Audio_API/Using_Web_Audio_API\">Using the Web Audio API</a></li><li><a href=\"/en-US/docs/Web/API/Web_Audio_API/Basic_concepts_behind_Web_Audio_API\">Basic concepts behind Web Audio API</a></li><li><a href=\"/en-US/docs/Web/API/Web_Audio_API/Best_practices\">Web Audio API best practices</a></li><li><a href=\"/en-US/docs/Web/API/Web_Audio_API/Advanced_techniques\">Advanced techniques: Creating and sequencing audio</a></li><li><a href=\"/en-US/docs/Web/API/Web_Audio_API/Using_AudioWorklet\">Background audio processing using AudioWorklet</a></li><li><a href=\"/en-US/docs/Web/API/Web_Audio_API/Controlling_multiple_parameters_with_ConstantSourceNode\">Controlling multiple parameters with ConstantSourceNode</a></li><li><a href=\"/en-US/docs/Web/API/Web_Audio_API/Migrating_from_webkitAudioContext\">Migrating from webkitAudioContext</a></li><li><a href=\"/en-US/docs/Web/API/Web_Audio_API/Simple_synth\">Example and tutorial: Simple synth keyboard</a></li><li><a href=\"/en-US/docs/Web/API/Web_Audio_API/Tools\">Tools for analyzing Web Audio usage</a></li><li><a href=\"/en-US/docs/Web/API/Web_Audio_API/Using_IIR_filters\">Using IIR filters</a></li><li><a href=\"/en-US/docs/Web/API/Web_Audio_API/Visualizations_with_Web_Audio_API\">Visualizations with Web Audio API</a></li><li><em><a href=\"/en-US/docs/Web/API/Web_Audio_API/Web_audio_spatialization_basics\" aria-current=\"page\">Web audio spatialization basics</a></em></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Interfaces</summary><ol><li><a href=\"/en-US/docs/Web/API/AnalyserNode\"><code>AnalyserNode</code></a></li><li><a href=\"/en-US/docs/Web/API/AudioBuffer\"><code>AudioBuffer</code></a></li><li><a href=\"/en-US/docs/Web/API/AudioBufferSourceNode\"><code>AudioBufferSourceNode</code></a></li><li><a href=\"/en-US/docs/Web/API/AudioContext\"><code>AudioContext</code></a></li><li><a href=\"/en-US/docs/Web/API/AudioDestinationNode\"><code>AudioDestinationNode</code></a></li><li><a href=\"/en-US/docs/Web/API/AudioListener\"><code>AudioListener</code></a></li><li><a href=\"/en-US/docs/Web/API/AudioNode\"><code>AudioNode</code></a></li><li><a href=\"/en-US/docs/Web/API/AudioParam\"><code>AudioParam</code></a></li><li><a href=\"/en-US/docs/Web/API/AudioProcessingEvent\"><code>AudioProcessingEvent</code></a></li><li><a href=\"/en-US/docs/Web/API/AudioScheduledSourceNode\"><code>AudioScheduledSourceNode</code></a></li><li><a href=\"/en-US/docs/Web/API/AudioSinkInfo\"><code>AudioSinkInfo</code></a></li><li><a href=\"/en-US/docs/Web/API/AudioWorklet\"><code>AudioWorklet</code></a></li><li><a href=\"/en-US/docs/Web/API/AudioWorkletGlobalScope\"><code>AudioWorkletGlobalScope</code></a></li><li><a href=\"/en-US/docs/Web/API/AudioWorkletNode\"><code>AudioWorkletNode</code></a></li><li><a href=\"/en-US/docs/Web/API/AudioWorkletProcessor\"><code>AudioWorkletProcessor</code></a></li><li><a href=\"/en-US/docs/Web/API/BaseAudioContext\"><code>BaseAudioContext</code></a></li><li><a href=\"/en-US/docs/Web/API/BiquadFilterNode\"><code>BiquadFilterNode</code></a></li><li><a href=\"/en-US/docs/Web/API/ChannelMergerNode\"><code>ChannelMergerNode</code></a></li><li><a href=\"/en-US/docs/Web/API/ChannelSplitterNode\"><code>ChannelSplitterNode</code></a></li><li><a href=\"/en-US/docs/Web/API/ConstantSourceNode\"><code>ConstantSourceNode</code></a></li><li><a href=\"/en-US/docs/Web/API/ConvolverNode\"><code>ConvolverNode</code></a></li><li><a href=\"/en-US/docs/Web/API/DelayNode\"><code>DelayNode</code></a></li><li><a href=\"/en-US/docs/Web/API/DynamicsCompressorNode\"><code>DynamicsCompressorNode</code></a></li><li><a href=\"/en-US/docs/Web/API/GainNode\"><code>GainNode</code></a></li><li><a href=\"/en-US/docs/Web/API/IIRFilterNode\"><code>IIRFilterNode</code></a></li><li><a href=\"/en-US/docs/Web/API/MediaElementAudioSourceNode\"><code>MediaElementAudioSourceNode</code></a></li><li><a href=\"/en-US/docs/Web/API/MediaStreamAudioDestinationNode\"><code>MediaStreamAudioDestinationNode</code></a></li><li><a href=\"/en-US/docs/Web/API/MediaStreamAudioSourceNode\"><code>MediaStreamAudioSourceNode</code></a></li><li><a href=\"/en-US/docs/Web/API/OfflineAudioCompletionEvent\"><code>OfflineAudioCompletionEvent</code></a></li><li><a href=\"/en-US/docs/Web/API/OfflineAudioContext\"><code>OfflineAudioContext</code></a></li><li><a href=\"/en-US/docs/Web/API/OscillatorNode\"><code>OscillatorNode</code></a></li><li><a href=\"/en-US/docs/Web/API/PannerNode\"><code>PannerNode</code></a></li><li><a href=\"/en-US/docs/Web/API/PeriodicWave\"><code>PeriodicWave</code></a></li><li><a href=\"/en-US/docs/Web/API/WaveShaperNode\"><code>WaveShaperNode</code></a></li><li><a href=\"/en-US/docs/Web/API/StereoPannerNode\"><code>StereoPannerNode</code></a></li></ol></details></li></ol>","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p>\n  As if its extensive variety of sound processing (and other) options wasn't enough, the Web Audio API also includes facilities to allow you to emulate the difference in sound as a listener moves around a sound source, for example panning as you move around a sound source inside a 3D game.\n  The official term for this is <strong>spatialization</strong>, and this article will cover the basics of how to implement such a system.\n</p>"}},{"type":"prose","value":{"id":"basics_of_spatialization","title":"Basics of spatialization","isH3":false,"content":"<p>\n  In Web Audio, complex 3D spatializations are created using the <a href=\"/en-US/docs/Web/API/PannerNode\"><code>PannerNode</code></a>, which in layman's terms is basically a whole lotta cool maths to make audio appear in 3D space.\n  Think sounds flying over you, creeping up behind you, moving across in front of you.\n  That sort of thing.\n</p>\n<p>\n  It's really useful for WebXR and gaming.\n  In 3D spaces, it's the only way to achieve realistic audio. Libraries like <a href=\"https://threejs.org/\" class=\"external\" target=\"_blank\">three.js</a> and <a href=\"https://aframe.io/\" class=\"external\" target=\"_blank\">A-frame</a> harness its potential when dealing with sound.\n  It's worth noting that you don't <em>have</em> to move sound within a full 3D space either — you could stick with just a 2D plane, so if you were planning a 2D game, this would still be the node you were looking for.\n</p>\n<div class=\"notecard note\" id=\"sect1\">\n  <p>\n    <strong>Note:</strong> There's also a <a href=\"/en-US/docs/Web/API/StereoPannerNode\"><code>StereoPannerNode</code></a> designed to deal with the common use case of creating simple left and right stereo panning effects.\n    This is much simpler to use, but obviously nowhere near as versatile.\n    If you just want a simple stereo panning effect, our <a href=\"https://mdn.github.io/webaudio-examples/stereo-panner-node/\" class=\"external\" target=\"_blank\">StereoPannerNode example</a> (<a href=\"https://github.com/mdn/webaudio-examples/tree/master/stereo-panner-node\" class=\"external\" target=\"_blank\">see source code</a>) should give you everything you need.\n  </p>\n</div>"}},{"type":"prose","value":{"id":"3d_boombox_demo","title":"3D boombox demo","isH3":false,"content":"<p>\n  To demonstrate 3D spatialization we've created a modified version of the boombox demo we created in our basic <a href=\"/en-US/docs/Web/API/Web_Audio_API/Using_Web_Audio_API\">Using the Web Audio API</a> guide.\n  See the <a href=\"https://mdn.github.io/webaudio-examples/spatialization/\" class=\"external\" target=\"_blank\">3D spatialization demo live</a> (and see the <a href=\"https://github.com/mdn/webaudio-examples/tree/master/spatialization\" class=\"external\" target=\"_blank\">source code</a> also).\n</p>\n<p>\n  <img src=\"/en-US/docs/Web/API/Web_Audio_API/Web_audio_spatialization_basics/web-audio-spatialization.png\" alt=\"A simple UI with a rotated boombox and controls to move it left and right and in and out, and rotate it.\" width=\"949\" height=\"724\" loading=\"lazy\">\n</p>\n<p>\n  The boombox sits inside a room (defined by the edges of the browser viewport), and in this demo, we can move and rotate it with the provided controls.\n  When we move the boombox, the sound it produces changes accordingly, panning as it moves to the left or right of the room, or becoming quieter as it is moved away from the user or is rotated so the speakers are facing away from them, etc.\n  This is done by setting the different properties of the <code>PannerNode</code> object instance in relation to that movement, to emulate spacialization.\n</p>\n<div class=\"notecard note\" id=\"sect2\">\n  <p><strong>Note:</strong> The experience is much better if you use headphones, or have some kind of surround sound system to plug your computer into.</p>\n</div>"}},{"type":"prose","value":{"id":"creating_an_audio_listener","title":"Creating an audio listener","isH3":false,"content":"<p>\n  So let's begin! The <a href=\"/en-US/docs/Web/API/BaseAudioContext\"><code>BaseAudioContext</code></a> (the interface the <a href=\"/en-US/docs/Web/API/AudioContext\"><code>AudioContext</code></a> is extended from) has a <a href=\"/en-US/docs/Web/API/BaseAudioContext/listener\"><code>listener</code></a> property that returns an <a href=\"/en-US/docs/Web/API/AudioListener\"><code>AudioListener</code></a> object.\n  This represents the listener of the scene, usually your user.\n  You can define where they are in space and in which direction they are facing.\n  They remain static. The <code>pannerNode</code> can then calculate its sound position relative to the position of the listener.\n</p>\n<p>Let's create our context and listener and set the listener's position to emulate a person looking into our room:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">const</span> AudioContext <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>AudioContext <span class=\"token operator\">||</span> window<span class=\"token punctuation\">.</span>webkitAudioContext<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> audioCtx <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AudioContext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> listener <span class=\"token operator\">=</span> audioCtx<span class=\"token punctuation\">.</span>listener<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> posX <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>innerWidth<span class=\"token operator\">/</span><span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> posY <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>innerHeight<span class=\"token operator\">/</span><span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> posZ <span class=\"token operator\">=</span> <span class=\"token number\">300</span><span class=\"token punctuation\">;</span>\n\nlistener<span class=\"token punctuation\">.</span>positionX<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> posX<span class=\"token punctuation\">;</span>\nlistener<span class=\"token punctuation\">.</span>positionY<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> posY<span class=\"token punctuation\">;</span>\nlistener<span class=\"token punctuation\">.</span>positionZ<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> posZ<span class=\"token operator\">-</span><span class=\"token number\">5</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>We could move the listener left or right using <code>positionX</code>, up or down using <code>positionY</code>, or in or out of the room using <code>positionZ</code>. Here we are setting the listener to be in the middle of the viewport and slightly in front of our boombox. We can also set the direction the listener is facing. The default values for these work well:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>listener<span class=\"token punctuation\">.</span>forwardX<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\nlistener<span class=\"token punctuation\">.</span>forwardY<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\nlistener<span class=\"token punctuation\">.</span>forwardZ<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\nlistener<span class=\"token punctuation\">.</span>upX<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\nlistener<span class=\"token punctuation\">.</span>upY<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\nlistener<span class=\"token punctuation\">.</span>upZ<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>\n  The forward properties represent the 3D coordinate position of the listener's forward direction (e.g. the direction they are facing in), while the up properties represent the 3D coordinate position of the top of the listener's head.\n  These two together can nicely set the direction.\n</p>"}},{"type":"prose","value":{"id":"creating_a_panner_node","title":"Creating a panner node","isH3":false,"content":"<p>Let's create our <a href=\"/en-US/docs/Web/API/PannerNode\"><code>PannerNode</code></a>. This has a whole bunch of properties associated with it. Let's take a look at each of them:</p>\n<p>\n  To start we can set the <a href=\"/en-US/docs/Web/API/PannerNode/panningModel\"><code>panningModel</code></a>.\n  This is the spacialization algorithm that's used to position the audio in 3D space. We can set this to:\n</p>\n<p><code>equalpower</code> — The default and the general way panning is figured out</p>\n<p><code>HRTF</code> — This stands for 'Head-related transfer function' and looks to take into account the human head when figuring out where the sound is.</p>\n<p>Pretty clever stuff. Let's use the <code>HRTF</code> model!</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">const</span> panningModel <span class=\"token operator\">=</span> <span class=\"token string\">'HRTF'</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>\n  The <a href=\"/en-US/docs/Web/API/PannerNode/coneInnerAngle\"><code>coneInnerAngle</code></a> and <a href=\"/en-US/docs/Web/API/PannerNode/coneOuterAngle\"><code>coneOuterAngle</code></a> properties specify where the volume emanates from.\n  By default, both are 360 degrees.\n  Our boombox speakers will have smaller cones, which we can define.\n  The inner cone is where gain (volume) is always emulated at a maximum and the outer cone is where the gain starts to drop away.\n  The gain is reduced by the value of the <a href=\"/en-US/docs/Web/API/PannerNode/coneOuterGain\"><code>coneOuterGain</code></a>.\n  Let's create constants that store the values we'll use for these parameters later on:\n</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">const</span> innerCone <span class=\"token operator\">=</span> <span class=\"token number\">60</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> outerCone <span class=\"token operator\">=</span> <span class=\"token number\">90</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> outerGain <span class=\"token operator\">=</span> <span class=\"token number\">0.3</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>The next parameter is <a href=\"/en-US/docs/Web/API/PannerNode/distanceModel\"><code>distanceModel</code></a> — this can only be set to <code>linear</code>, <code>inverse</code>, or <code>exponential</code>. These are different algorithms, which are used to reduce the volume of the audio source as it moves away from the listener. We'll use <code>linear</code>, as it is simple:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">const</span> distanceModel <span class=\"token operator\">=</span> <span class=\"token string\">'linear'</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>\n  We can set a maximum distance (<a href=\"/en-US/docs/Web/API/PannerNode/maxDistance\"><code>maxDistance</code></a>) between the source and the listener — the volume will not be reduced anymore if the source moves further away from this point.\n  This can be useful, as you may find you want to emulate distance, but volume can drop out and that's actually not what you want.\n  By default, it's 10,000 (a unitless relative value). We can keep it as this:\n</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">const</span> maxDistance <span class=\"token operator\">=</span> <span class=\"token number\">10000</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>\n  There's also a reference distance (<a href=\"/en-US/docs/Web/API/PannerNode/refDistance\"><code>refDistance</code></a>), which is used by the distance models.\n  We can keep that at the default value of <code>1</code> as well:\n</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">const</span> refDistance <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>\n  Then there's the roll-off factor (<a href=\"/en-US/docs/Web/API/PannerNode/rolloffFactor\"><code>rolloffFactor</code></a>) — how quickly does the volume reduce as the panner moves away from the listener.\n  The default value is 1; let's make that a bit bigger to exaggerate our movements.\n</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">const</span> rollOff <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>\n  Now we can start setting our position and orientation of our boombox.\n  This is a lot like how we did it with our listener.\n  These are also the parameters we're going to change when the controls on our interface are used.\n</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">const</span> positionX <span class=\"token operator\">=</span> posX<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> positionY <span class=\"token operator\">=</span> posY<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> positionZ <span class=\"token operator\">=</span> posZ<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> orientationX <span class=\"token operator\">=</span> <span class=\"token number\">0.0</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> orientationY <span class=\"token operator\">=</span> <span class=\"token number\">0.0</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> orientationZ <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1.0</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>\n  Note the minus value on our z orientation — this sets the boombox to face us.\n  A positive value would set the sound source facing away from us.\n</p>\n<p>Let's use the relevant constructor for creating our panner node and pass in all those parameters we set above:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">const</span> panner <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">PannerNode</span><span class=\"token punctuation\">(</span>audioCtx<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  panningModel<span class=\"token punctuation\">,</span>\n  distanceModel<span class=\"token punctuation\">,</span>\n  positionX<span class=\"token punctuation\">,</span>\n  positionY<span class=\"token punctuation\">,</span>\n  positionZ<span class=\"token punctuation\">,</span>\n  orientationX<span class=\"token punctuation\">,</span>\n  orientationY<span class=\"token punctuation\">,</span>\n  orientationZ<span class=\"token punctuation\">,</span>\n  refDistance<span class=\"token punctuation\">,</span>\n  maxDistance<span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">rolloffFactor</span><span class=\"token operator\">:</span> rollOff<span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">coneInnerAngle</span><span class=\"token operator\">:</span> innerCone<span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">coneOuterAngle</span><span class=\"token operator\">:</span> outerCone<span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">coneOuterGain</span><span class=\"token operator\">:</span> outerGain<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"moving_the_boombox","title":"Moving the boombox","isH3":false,"content":"<p>\n  Now we're going to move our boombox around our 'room'. We've got some controls set up to do this.\n  We can move it left and right, up and down, and back and forth; we can also rotate it.\n  The sound direction is coming from the boombox speaker at the front, so when we rotate it, we can alter the sound's direction — i.e. make it project to the back when the boombox is rotated 180 degrees and facing away from us.\n</p>\n<p>\n  We need to set up a few things for the interface.\n  First, we'll get references to the elements we want to move, then we'll store references to the values we'll change when we set up <a href=\"/en-US/docs/Web/CSS/CSS_Transforms\">CSS transforms</a> to actually do the movement.\n  Finally, we'll set some bounds so our boombox doesn't move too far in any direction:\n</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">const</span> moveControls <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#move-controls'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">querySelectorAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">'button'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> boombox <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.boombox-body'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// the values for our CSS transforms</span>\n<span class=\"token keyword\">const</span> transform <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">xAxis</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">yAxis</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">zAxis</span><span class=\"token operator\">:</span> <span class=\"token number\">0.8</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">rotateX</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">rotateY</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// set our bounds</span>\n<span class=\"token keyword\">const</span> topBound <span class=\"token operator\">=</span> <span class=\"token operator\">-</span>posY<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> bottomBound <span class=\"token operator\">=</span> posY<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> rightBound <span class=\"token operator\">=</span> posX<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> leftBound <span class=\"token operator\">=</span> <span class=\"token operator\">-</span>posX<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> innerBound <span class=\"token operator\">=</span> <span class=\"token number\">0.1</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> outerBound <span class=\"token operator\">=</span> <span class=\"token number\">1.5</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Let's create a function that takes the direction we want to move as a parameter, and both modifies the CSS transform and updates the position and orientation values of our panner node properties to change the sound as appropriate.</p>\n<p>\n  To start with let's take a look at our left, right, up and down values as these are pretty straightforward.\n  We'll move the boombox along these axis and update the appropriate position.\n</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">function</span> <span class=\"token function\">moveBoombox</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">direction</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>direction<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'left'</span><span class=\"token operator\">:</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>transform<span class=\"token punctuation\">.</span>xAxis <span class=\"token operator\">&gt;</span> leftBound<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        transform<span class=\"token punctuation\">.</span>xAxis <span class=\"token operator\">-=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span>\n        panner<span class=\"token punctuation\">.</span>positionX<span class=\"token punctuation\">.</span>value <span class=\"token operator\">-=</span> <span class=\"token number\">0.1</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'up'</span><span class=\"token operator\">:</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>transform<span class=\"token punctuation\">.</span>yAxis <span class=\"token operator\">&gt;</span> topBound<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        transform<span class=\"token punctuation\">.</span>yAxis <span class=\"token operator\">-=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span>\n        panner<span class=\"token punctuation\">.</span>positionY<span class=\"token punctuation\">.</span>value <span class=\"token operator\">-=</span> <span class=\"token number\">0.3</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'right'</span><span class=\"token operator\">:</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>transform<span class=\"token punctuation\">.</span>xAxis <span class=\"token operator\">&lt;</span> rightBound<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        transform<span class=\"token punctuation\">.</span>xAxis <span class=\"token operator\">+=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span>\n        panner<span class=\"token punctuation\">.</span>positionX<span class=\"token punctuation\">.</span>value <span class=\"token operator\">+=</span> <span class=\"token number\">0.1</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'down'</span><span class=\"token operator\">:</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>transform<span class=\"token punctuation\">.</span>yAxis <span class=\"token operator\">&lt;</span> bottomBound<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        transform<span class=\"token punctuation\">.</span>yAxis <span class=\"token operator\">+=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span>\n        panner<span class=\"token punctuation\">.</span>positionY<span class=\"token punctuation\">.</span>value <span class=\"token operator\">+=</span> <span class=\"token number\">0.3</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>It's a similar story for our move in and out values too:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">case</span> <span class=\"token string\">'back'</span><span class=\"token operator\">:</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>transform<span class=\"token punctuation\">.</span>zAxis <span class=\"token operator\">&gt;</span> innerBound<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    transform<span class=\"token punctuation\">.</span>zAxis <span class=\"token operator\">-=</span> <span class=\"token number\">0.01</span><span class=\"token punctuation\">;</span>\n    panner<span class=\"token punctuation\">.</span>positionZ<span class=\"token punctuation\">.</span>value <span class=\"token operator\">+=</span> <span class=\"token number\">40</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">case</span> <span class=\"token string\">'forward'</span><span class=\"token operator\">:</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>transform<span class=\"token punctuation\">.</span>zAxis <span class=\"token operator\">&lt;</span> outerBound<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    transform<span class=\"token punctuation\">.</span>zAxis <span class=\"token operator\">+=</span> <span class=\"token number\">0.01</span><span class=\"token punctuation\">;</span>\n    panner<span class=\"token punctuation\">.</span>positionZ<span class=\"token punctuation\">.</span>value <span class=\"token operator\">-=</span> <span class=\"token number\">40</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>\n  Our rotation values are a little more involved, however, as we need to move the sound <em>around</em>.\n  Not only do we have to update two axis values (e.g. if you rotate an object around the x-axis, you update the y and z coordinates for that object), but we also need to do some more maths for this.\n  The rotation is a circle and we need <a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/sin\"><code>Math.sin</code></a> and <a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/cos\"><code>Math.cos</code></a> to help us draw that circle.\n</p>\n<p>Let's set up a rotation rate, which we'll convert into a radian range value for use in <code>Math.sin</code> and <code>Math.cos</code> later, when we want to figure out the new coordinates when we're rotating our boombox:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// set up rotation constants</span>\n<span class=\"token keyword\">const</span> rotationRate <span class=\"token operator\">=</span> <span class=\"token number\">60</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// bigger number equals slower sound rotation</span>\n\n<span class=\"token keyword\">const</span> q <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token constant\">PI</span><span class=\"token operator\">/</span>rotationRate<span class=\"token punctuation\">;</span> <span class=\"token comment\">//rotation increment in radians</span>\n</code></pre></div>\n<p>We can also use this to work out degrees rotated, which will help with the CSS transforms we will have to create (note we need both an x and y-axis for the CSS transforms):</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// get degrees for CSS</span>\n<span class=\"token keyword\">const</span> degreesX <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>q <span class=\"token operator\">*</span> <span class=\"token number\">180</span><span class=\"token punctuation\">)</span><span class=\"token operator\">/</span>Math<span class=\"token punctuation\">.</span><span class=\"token constant\">PI</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> degreesY <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>q <span class=\"token operator\">*</span> <span class=\"token number\">180</span><span class=\"token punctuation\">)</span><span class=\"token operator\">/</span>Math<span class=\"token punctuation\">.</span><span class=\"token constant\">PI</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Let's take a look at our left rotation as an example. We need to change the x orientation and the z orientation of the panner coordinates, to move around the y-axis for our left rotation:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">case</span> <span class=\"token string\">'rotate-left'</span><span class=\"token operator\">:</span>\n  transform<span class=\"token punctuation\">.</span>rotateY <span class=\"token operator\">-=</span> degreesY<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// 'left' is rotation about y-axis with negative angle increment</span>\n  z <span class=\"token operator\">=</span> panner<span class=\"token punctuation\">.</span>orientationZ<span class=\"token punctuation\">.</span>value<span class=\"token operator\">*</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">cos</span><span class=\"token punctuation\">(</span>q<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> panner<span class=\"token punctuation\">.</span>orientationX<span class=\"token punctuation\">.</span>value<span class=\"token operator\">*</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">sin</span><span class=\"token punctuation\">(</span>q<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  x <span class=\"token operator\">=</span> panner<span class=\"token punctuation\">.</span>orientationZ<span class=\"token punctuation\">.</span>value<span class=\"token operator\">*</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">sin</span><span class=\"token punctuation\">(</span>q<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> panner<span class=\"token punctuation\">.</span>orientationX<span class=\"token punctuation\">.</span>value<span class=\"token operator\">*</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">cos</span><span class=\"token punctuation\">(</span>q<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  y <span class=\"token operator\">=</span> panner<span class=\"token punctuation\">.</span>orientationY<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span>\n\n  panner<span class=\"token punctuation\">.</span>orientationX<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> x<span class=\"token punctuation\">;</span>\n  panner<span class=\"token punctuation\">.</span>orientationY<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> y<span class=\"token punctuation\">;</span>\n  panner<span class=\"token punctuation\">.</span>orientationZ<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> z<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>This <em>is</em> a little confusing, but what we're doing is using sin and cos to help us work out the circular motion the coordinates need for the rotation of the boombox.</p>\n<p>We can do this for all the axes. We just need to choose the right orientations to update and whether we want a positive or negative increment.</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">case</span> <span class=\"token string\">'rotate-right'</span><span class=\"token operator\">:</span>\n  transform<span class=\"token punctuation\">.</span>rotateY <span class=\"token operator\">+=</span> degreesY<span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// 'right' is rotation about y-axis with positive angle increment</span>\n  z <span class=\"token operator\">=</span> panner<span class=\"token punctuation\">.</span>orientationZ<span class=\"token punctuation\">.</span>value<span class=\"token operator\">*</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">cos</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>q<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> panner<span class=\"token punctuation\">.</span>orientationX<span class=\"token punctuation\">.</span>value<span class=\"token operator\">*</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">sin</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>q<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  x <span class=\"token operator\">=</span> panner<span class=\"token punctuation\">.</span>orientationZ<span class=\"token punctuation\">.</span>value<span class=\"token operator\">*</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">sin</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>q<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> panner<span class=\"token punctuation\">.</span>orientationX<span class=\"token punctuation\">.</span>value<span class=\"token operator\">*</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">cos</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>q<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  y <span class=\"token operator\">=</span> panner<span class=\"token punctuation\">.</span>orientationY<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span>\n  panner<span class=\"token punctuation\">.</span>orientationX<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> x<span class=\"token punctuation\">;</span>\n  panner<span class=\"token punctuation\">.</span>orientationY<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> y<span class=\"token punctuation\">;</span>\n  panner<span class=\"token punctuation\">.</span>orientationZ<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> z<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">case</span> <span class=\"token string\">'rotate-up'</span><span class=\"token operator\">:</span>\n  transform<span class=\"token punctuation\">.</span>rotateX <span class=\"token operator\">+=</span> degreesX<span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// 'up' is rotation about x-axis with negative angle increment</span>\n  z <span class=\"token operator\">=</span> panner<span class=\"token punctuation\">.</span>orientationZ<span class=\"token punctuation\">.</span>value<span class=\"token operator\">*</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">cos</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>q<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> panner<span class=\"token punctuation\">.</span>orientationY<span class=\"token punctuation\">.</span>value<span class=\"token operator\">*</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">sin</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>q<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  y <span class=\"token operator\">=</span> panner<span class=\"token punctuation\">.</span>orientationZ<span class=\"token punctuation\">.</span>value<span class=\"token operator\">*</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">sin</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>q<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> panner<span class=\"token punctuation\">.</span>orientationY<span class=\"token punctuation\">.</span>value<span class=\"token operator\">*</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">cos</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>q<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  x <span class=\"token operator\">=</span> panner<span class=\"token punctuation\">.</span>orientationX<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span>\n  panner<span class=\"token punctuation\">.</span>orientationX<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> x<span class=\"token punctuation\">;</span>\n  panner<span class=\"token punctuation\">.</span>orientationY<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> y<span class=\"token punctuation\">;</span>\n  panner<span class=\"token punctuation\">.</span>orientationZ<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> z<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">case</span> <span class=\"token string\">'rotate-down'</span><span class=\"token operator\">:</span>\n  transform<span class=\"token punctuation\">.</span>rotateX <span class=\"token operator\">-=</span> degreesX<span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// 'down' is rotation about x-axis with positive angle increment</span>\n  z <span class=\"token operator\">=</span> panner<span class=\"token punctuation\">.</span>orientationZ<span class=\"token punctuation\">.</span>value<span class=\"token operator\">*</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">cos</span><span class=\"token punctuation\">(</span>q<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> panner<span class=\"token punctuation\">.</span>orientationY<span class=\"token punctuation\">.</span>value<span class=\"token operator\">*</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">sin</span><span class=\"token punctuation\">(</span>q<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  y <span class=\"token operator\">=</span> panner<span class=\"token punctuation\">.</span>orientationZ<span class=\"token punctuation\">.</span>value<span class=\"token operator\">*</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">sin</span><span class=\"token punctuation\">(</span>q<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> panner<span class=\"token punctuation\">.</span>orientationY<span class=\"token punctuation\">.</span>value<span class=\"token operator\">*</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">cos</span><span class=\"token punctuation\">(</span>q<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  x <span class=\"token operator\">=</span> panner<span class=\"token punctuation\">.</span>orientationX<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span>\n  panner<span class=\"token punctuation\">.</span>orientationX<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> x<span class=\"token punctuation\">;</span>\n  panner<span class=\"token punctuation\">.</span>orientationY<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> y<span class=\"token punctuation\">;</span>\n  panner<span class=\"token punctuation\">.</span>orientationZ<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> z<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>\n  One last thing — we need to update the CSS and keep a reference of the last move for the mouse event.\n  Here's the final <code>moveBoombox</code> function.\n</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">function</span> <span class=\"token function\">moveBoombox</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">direction<span class=\"token punctuation\">,</span> prevMove</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>direction<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'left'</span><span class=\"token operator\">:</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>transform<span class=\"token punctuation\">.</span>xAxis <span class=\"token operator\">&gt;</span> leftBound<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        transform<span class=\"token punctuation\">.</span>xAxis <span class=\"token operator\">-=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span>\n        panner<span class=\"token punctuation\">.</span>positionX<span class=\"token punctuation\">.</span>value <span class=\"token operator\">-=</span> <span class=\"token number\">0.1</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'up'</span><span class=\"token operator\">:</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>transform<span class=\"token punctuation\">.</span>yAxis <span class=\"token operator\">&gt;</span> topBound<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        transform<span class=\"token punctuation\">.</span>yAxis <span class=\"token operator\">-=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span>\n        panner<span class=\"token punctuation\">.</span>positionY<span class=\"token punctuation\">.</span>value <span class=\"token operator\">-=</span> <span class=\"token number\">0.3</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'right'</span><span class=\"token operator\">:</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>transform<span class=\"token punctuation\">.</span>xAxis <span class=\"token operator\">&lt;</span> rightBound<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        transform<span class=\"token punctuation\">.</span>xAxis <span class=\"token operator\">+=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span>\n        panner<span class=\"token punctuation\">.</span>positionX<span class=\"token punctuation\">.</span>value <span class=\"token operator\">+=</span> <span class=\"token number\">0.1</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'down'</span><span class=\"token operator\">:</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>transform<span class=\"token punctuation\">.</span>yAxis <span class=\"token operator\">&lt;</span> bottomBound<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        transform<span class=\"token punctuation\">.</span>yAxis <span class=\"token operator\">+=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span>\n        panner<span class=\"token punctuation\">.</span>positionY<span class=\"token punctuation\">.</span>value <span class=\"token operator\">+=</span> <span class=\"token number\">0.3</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'back'</span><span class=\"token operator\">:</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>transform<span class=\"token punctuation\">.</span>zAxis <span class=\"token operator\">&gt;</span> innerBound<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        transform<span class=\"token punctuation\">.</span>zAxis <span class=\"token operator\">-=</span> <span class=\"token number\">0.01</span><span class=\"token punctuation\">;</span>\n        panner<span class=\"token punctuation\">.</span>positionZ<span class=\"token punctuation\">.</span>value <span class=\"token operator\">+=</span> <span class=\"token number\">40</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'forward'</span><span class=\"token operator\">:</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>transform<span class=\"token punctuation\">.</span>zAxis <span class=\"token operator\">&lt;</span> outerBound<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        transform<span class=\"token punctuation\">.</span>zAxis <span class=\"token operator\">+=</span> <span class=\"token number\">0.01</span><span class=\"token punctuation\">;</span>\n        panner<span class=\"token punctuation\">.</span>positionZ<span class=\"token punctuation\">.</span>value <span class=\"token operator\">-=</span> <span class=\"token number\">40</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'rotate-left'</span><span class=\"token operator\">:</span>\n      transform<span class=\"token punctuation\">.</span>rotateY <span class=\"token operator\">-=</span> degreesY<span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\">// 'left' is rotation about y-axis with negative angle increment</span>\n      z <span class=\"token operator\">=</span> panner<span class=\"token punctuation\">.</span>orientationZ<span class=\"token punctuation\">.</span>value<span class=\"token operator\">*</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">cos</span><span class=\"token punctuation\">(</span>q<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> panner<span class=\"token punctuation\">.</span>orientationX<span class=\"token punctuation\">.</span>value<span class=\"token operator\">*</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">sin</span><span class=\"token punctuation\">(</span>q<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      x <span class=\"token operator\">=</span> panner<span class=\"token punctuation\">.</span>orientationZ<span class=\"token punctuation\">.</span>value<span class=\"token operator\">*</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">sin</span><span class=\"token punctuation\">(</span>q<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> panner<span class=\"token punctuation\">.</span>orientationX<span class=\"token punctuation\">.</span>value<span class=\"token operator\">*</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">cos</span><span class=\"token punctuation\">(</span>q<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      y <span class=\"token operator\">=</span> panner<span class=\"token punctuation\">.</span>orientationY<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span>\n\n      panner<span class=\"token punctuation\">.</span>orientationX<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> x<span class=\"token punctuation\">;</span>\n      panner<span class=\"token punctuation\">.</span>orientationY<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> y<span class=\"token punctuation\">;</span>\n      panner<span class=\"token punctuation\">.</span>orientationZ<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> z<span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'rotate-right'</span><span class=\"token operator\">:</span>\n      transform<span class=\"token punctuation\">.</span>rotateY <span class=\"token operator\">+=</span> degreesY<span class=\"token punctuation\">;</span>\n      <span class=\"token comment\">// 'right' is rotation about y-axis with positive angle increment</span>\n      z <span class=\"token operator\">=</span> panner<span class=\"token punctuation\">.</span>orientationZ<span class=\"token punctuation\">.</span>value<span class=\"token operator\">*</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">cos</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>q<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> panner<span class=\"token punctuation\">.</span>orientationX<span class=\"token punctuation\">.</span>value<span class=\"token operator\">*</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">sin</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>q<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      x <span class=\"token operator\">=</span> panner<span class=\"token punctuation\">.</span>orientationZ<span class=\"token punctuation\">.</span>value<span class=\"token operator\">*</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">sin</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>q<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> panner<span class=\"token punctuation\">.</span>orientationX<span class=\"token punctuation\">.</span>value<span class=\"token operator\">*</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">cos</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>q<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      y <span class=\"token operator\">=</span> panner<span class=\"token punctuation\">.</span>orientationY<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span>\n      panner<span class=\"token punctuation\">.</span>orientationX<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> x<span class=\"token punctuation\">;</span>\n      panner<span class=\"token punctuation\">.</span>orientationY<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> y<span class=\"token punctuation\">;</span>\n      panner<span class=\"token punctuation\">.</span>orientationZ<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> z<span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'rotate-up'</span><span class=\"token operator\">:</span>\n      transform<span class=\"token punctuation\">.</span>rotateX <span class=\"token operator\">+=</span> degreesX<span class=\"token punctuation\">;</span>\n      <span class=\"token comment\">// 'up' is rotation about x-axis with negative angle increment</span>\n      z <span class=\"token operator\">=</span> panner<span class=\"token punctuation\">.</span>orientationZ<span class=\"token punctuation\">.</span>value<span class=\"token operator\">*</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">cos</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>q<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> panner<span class=\"token punctuation\">.</span>orientationY<span class=\"token punctuation\">.</span>value<span class=\"token operator\">*</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">sin</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>q<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      y <span class=\"token operator\">=</span> panner<span class=\"token punctuation\">.</span>orientationZ<span class=\"token punctuation\">.</span>value<span class=\"token operator\">*</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">sin</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>q<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> panner<span class=\"token punctuation\">.</span>orientationY<span class=\"token punctuation\">.</span>value<span class=\"token operator\">*</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">cos</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>q<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      x <span class=\"token operator\">=</span> panner<span class=\"token punctuation\">.</span>orientationX<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span>\n      panner<span class=\"token punctuation\">.</span>orientationX<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> x<span class=\"token punctuation\">;</span>\n      panner<span class=\"token punctuation\">.</span>orientationY<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> y<span class=\"token punctuation\">;</span>\n      panner<span class=\"token punctuation\">.</span>orientationZ<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> z<span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'rotate-down'</span><span class=\"token operator\">:</span>\n      transform<span class=\"token punctuation\">.</span>rotateX <span class=\"token operator\">-=</span> degreesX<span class=\"token punctuation\">;</span>\n      <span class=\"token comment\">// 'down' is rotation about x-axis with positive angle increment</span>\n      z <span class=\"token operator\">=</span> panner<span class=\"token punctuation\">.</span>orientationZ<span class=\"token punctuation\">.</span>value<span class=\"token operator\">*</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">cos</span><span class=\"token punctuation\">(</span>q<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> panner<span class=\"token punctuation\">.</span>orientationY<span class=\"token punctuation\">.</span>value<span class=\"token operator\">*</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">sin</span><span class=\"token punctuation\">(</span>q<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      y <span class=\"token operator\">=</span> panner<span class=\"token punctuation\">.</span>orientationZ<span class=\"token punctuation\">.</span>value<span class=\"token operator\">*</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">sin</span><span class=\"token punctuation\">(</span>q<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> panner<span class=\"token punctuation\">.</span>orientationY<span class=\"token punctuation\">.</span>value<span class=\"token operator\">*</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">cos</span><span class=\"token punctuation\">(</span>q<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      x <span class=\"token operator\">=</span> panner<span class=\"token punctuation\">.</span>orientationX<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span>\n      panner<span class=\"token punctuation\">.</span>orientationX<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> x<span class=\"token punctuation\">;</span>\n      panner<span class=\"token punctuation\">.</span>orientationY<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> y<span class=\"token punctuation\">;</span>\n      panner<span class=\"token punctuation\">.</span>orientationZ<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> z<span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  boombox<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>transform <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">translateX(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>transform<span class=\"token punctuation\">.</span>xAxis<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px) </span><span class=\"token template-punctuation string\">`</span></span> <span class=\"token operator\">+</span>\n    <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">translateY(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>transform<span class=\"token punctuation\">.</span>yAxis<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px) </span><span class=\"token template-punctuation string\">`</span></span> <span class=\"token operator\">+</span>\n    <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">scale(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>transform<span class=\"token punctuation\">.</span>zAxis<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">) </span><span class=\"token template-punctuation string\">`</span></span> <span class=\"token operator\">+</span>\n    <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">rotateY(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>transform<span class=\"token punctuation\">.</span>rotateY<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">deg) </span><span class=\"token template-punctuation string\">`</span></span> <span class=\"token operator\">+</span>\n    <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">rotateX(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>transform<span class=\"token punctuation\">.</span>rotateX<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">deg)</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> move <span class=\"token operator\">=</span> prevMove <span class=\"token operator\">||</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  move<span class=\"token punctuation\">.</span>frameId <span class=\"token operator\">=</span> <span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token function\">moveBoombox</span><span class=\"token punctuation\">(</span>direction<span class=\"token punctuation\">,</span> move<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> move<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"wiring_up_our_controls","title":"Wiring up our controls","isH3":false,"content":"<p>Wiring up out control buttons is comparatively simple — now we can listen for a mouse event on our controls and run this function, as well as stop it when the mouse is released:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// for each of our controls, move the boombox and change the position values</span>\nmoveControls<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">el</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">let</span> moving<span class=\"token punctuation\">;</span>\n  el<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'mousedown'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> direction <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dataset<span class=\"token punctuation\">.</span>control<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>moving <span class=\"token operator\">&amp;&amp;</span> moving<span class=\"token punctuation\">.</span>frameId<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">cancelAnimationFrame</span><span class=\"token punctuation\">(</span>moving<span class=\"token punctuation\">.</span>frameId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    moving <span class=\"token operator\">=</span> <span class=\"token function\">moveBoombox</span><span class=\"token punctuation\">(</span>direction<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'mouseup'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>moving <span class=\"token operator\">&amp;&amp;</span> moving<span class=\"token punctuation\">.</span>frameId<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">cancelAnimationFrame</span><span class=\"token punctuation\">(</span>moving<span class=\"token punctuation\">.</span>frameId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"connecting_our_graph","title":"Connecting our graph","isH3":false,"content":"<p>Our HTML contains the audio element we want to be affected by the panner node.</p>\n<div class=\"code-example\"><pre class=\"brush: html notranslate\"><code><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>audio</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>myCoolTrack.mp3<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>audio</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre></div>\n<p>We need to grab the source from that element and pipe it into the Web Audio API using the <a href=\"/en-US/docs/Web/API/AudioContext/createMediaElementSource\"><code>AudioContext.createMediaElementSource</code></a>.</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// get the audio element</span>\n<span class=\"token keyword\">const</span> audioElement <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'audio'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// pass it into the audio context</span>\n<span class=\"token keyword\">const</span> track <span class=\"token operator\">=</span> audioContext<span class=\"token punctuation\">.</span><span class=\"token function\">createMediaElementSource</span><span class=\"token punctuation\">(</span>audioElement<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Next we have to connect our audio graph. We connect our input (the track) to our modification node (the panner) to our destination (in this case the speakers).</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>track<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>panner<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>audioCtx<span class=\"token punctuation\">.</span>destination<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Let's create a play button, that when clicked will play or pause the audio depending on the current state.</p>\n<div class=\"code-example\"><pre class=\"brush: html notranslate\"><code><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">data-playing</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>false<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">role</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>switch<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>Play/Pause<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre></div>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// Select our play button</span>\n<span class=\"token keyword\">const</span> playButton <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'button'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nplayButton<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Check if context is in suspended state (autoplay policy)</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>audioContext<span class=\"token punctuation\">.</span>state <span class=\"token operator\">===</span> <span class=\"token string\">'suspended'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    audioContext<span class=\"token punctuation\">.</span><span class=\"token function\">resume</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// Play or pause track depending on state</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>playButton<span class=\"token punctuation\">.</span>dataset<span class=\"token punctuation\">.</span>playing <span class=\"token operator\">===</span> <span class=\"token string\">'false'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    audioElement<span class=\"token punctuation\">.</span><span class=\"token function\">play</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    playButton<span class=\"token punctuation\">.</span>dataset<span class=\"token punctuation\">.</span>playing <span class=\"token operator\">=</span> <span class=\"token string\">'true'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>playButton<span class=\"token punctuation\">.</span>dataset<span class=\"token punctuation\">.</span>playing <span class=\"token operator\">===</span> <span class=\"token string\">'true'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    audioElement<span class=\"token punctuation\">.</span><span class=\"token function\">pause</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    playButton<span class=\"token punctuation\">.</span>dataset<span class=\"token punctuation\">.</span>playing <span class=\"token operator\">=</span> <span class=\"token string\">'false'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>For a more in depth look at playing/controlling audio and audio graphs check out <a href=\"/en-US/docs/Web/API/Web_Audio_API/Using_Web_Audio_API\">Using The Web Audio API.</a></p>"}},{"type":"prose","value":{"id":"summary","title":"Summary","isH3":false,"content":"<p>\n  Hopefully, this article has given you an insight into how Web Audio spatialization works, and what each of the <a href=\"/en-US/docs/Web/API/PannerNode\"><code>PannerNode</code></a> properties do (there are quite a few of them).\n  The values can be hard to manipulate sometimes and depending on your use case it can take some time to get them right.\n</p>\n<div class=\"notecard note\" id=\"sect3\">\n  <p>\n    <strong>Note:</strong> There are slight differences in the way the audio spatialization sounds across different browsers.\n    The panner node does some very involved maths under the hood;\n    there are a <a href=\"https://wpt.fyi/results/webaudio/the-audio-api/the-pannernode-interface?label=stable&amp;aligned=true\" class=\"external\" target=\"_blank\">number of tests here</a> so you can keep track of the status of the inner workings of this node across different platforms.\n  </p>\n</div>\n<p>\n  Again, you can <a href=\"https://mdn.github.io/webaudio-examples/spatialization/\" class=\"external\" target=\"_blank\">check out the final demo here</a>, and the <a href=\"https://github.com/mdn/webaudio-examples/tree/master/spatialization\" class=\"external\" target=\"_blank\">final source code is here</a>.\n  There is also a <a href=\"https://codepen.io/Rumyra/pen/MqayoK?editors=0100\" class=\"external\" target=\"_blank\">Codepen demo too</a>.\n</p>\n<p>\n  If you are working with 3D games and/or WebXR it's a good idea to harness a 3D library to create such functionality, rather than trying to do this all yourself from first principles.\n  We rolled our own in this article to give you an idea of how it works, but you'll save a lot of time by taking advantage of work others have done before you.\n</p>"}}],"toc":[{"text":"Basics of spatialization","id":"basics_of_spatialization"},{"text":"3D boombox demo","id":"3d_boombox_demo"},{"text":"Creating an audio listener","id":"creating_an_audio_listener"},{"text":"Creating a panner node","id":"creating_a_panner_node"},{"text":"Moving the boombox","id":"moving_the_boombox"},{"text":"Wiring up our controls","id":"wiring_up_our_controls"},{"text":"Connecting our graph","id":"connecting_our_graph"},{"text":"Summary","id":"summary"}],"summary":"Hopefully, this article has given you an insight into how Web Audio spatialization works, and what each of the PannerNode properties do (there are quite a few of them).\n  The values can be hard to manipulate sometimes and depending on your use case it can take some time to get them right.","popularity":0,"modified":"2022-10-23T21:43:47.000Z","other_translations":[{"title":"Fondamentaux pour la spatialisation avec Web Audio","locale":"fr","native":"Français"},{"title":"Web audio 공간화 기초","locale":"ko","native":"한국어"},{"title":"Web audio 空间化基础","locale":"zh-CN","native":"中文 (简体)"}],"source":{"folder":"en-us/web/api/web_audio_api/web_audio_spatialization_basics","github_url":"https://github.com/mdn/content/blob/main/files/en-us/web/api/web_audio_api/web_audio_spatialization_basics/index.md","last_commit_url":"https://github.com/mdn/content/commit/003b0ec96775d2ce0a6590ab708ec69dc695cf0d","filename":"index.md"},"short_title":"Web audio spatialization basics","parents":[{"uri":"/en-US/docs/Web","title":"References"},{"uri":"/en-US/docs/Web/API","title":"Web APIs"},{"uri":"/en-US/docs/Web/API/Web_Audio_API","title":"Web Audio API"},{"uri":"/en-US/docs/Web/API/Web_Audio_API/Web_audio_spatialization_basics","title":"Web audio spatialization basics"}],"pageTitle":"Web audio spatialization basics - Web APIs | MDN","noIndexing":false}}</script>
<!-- Mirrored from developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API/Web_audio_spatialization_basics by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 14 Feb 2023 04:49:16 GMT -->
</body></html>