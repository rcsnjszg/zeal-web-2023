<html><!-- Mirrored from developer.mozilla.org/en-US/docs/Web/API/WebGL_API/WebGL_best_practices by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 14 Feb 2023 04:49:36 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" href="../../../../../favicon-48x48.cbbd161b.png"><link rel="apple-touch-icon" href="../../../../../apple-touch-icon.6803c6f0.png"><meta name="theme-color" content="#ffffff"><link rel="manifest" href="../../../../../manifest.56b1cedc.json"><link rel="search" type="application/opensearchdescription+xml" href="https://developer.mozilla.org/opensearch.xml" title="MDN Web Docs"><title>WebGL best practices</title><link rel="alternate" title="WebGL best practices" href="https://developer.mozilla.org/ja/docs/Web/API/WebGL_API/WebGL_best_practices" hreflang="ja"><link rel="alternate" title="WebGL best practices" href="https://developer.mozilla.org/ko/docs/Web/API/WebGL_API/WebGL_best_practices" hreflang="ko"><link rel="alternate" title="Лучшие практики WebGL" href="https://developer.mozilla.org/ru/docs/Web/API/WebGL_API/WebGL_best_practices" hreflang="ru"><link rel="alternate" title="WebGL best practices" href="https://developer.mozilla.org/zh-CN/docs/Web/API/WebGL_API/WebGL_best_practices" hreflang="zh"><link rel="alternate" title="WebGL best practices" href="WebGL_best_practices.html" hreflang="en"><meta name="robots" content="index, follow"><meta name="description" content="WebGL is a complicated API, and it's often not obvious what the recommended ways to use it are. This page tackles recommendations across the spectrum of expertise, and not only highlights dos and don'ts, but also details why. You can rely on this document to guide your choice of approach, and ensure you're on the right track no matter what browser or hardware your users run."><meta property="og:url" content="WebGL_best_practices.html"><meta property="og:title" content="WebGL best practices - Web APIs | MDN"><meta property="og:locale" content="en-US"><meta property="og:description" content="WebGL is a complicated API, and it's often not obvious what the recommended ways to use it are. This page tackles recommendations across the spectrum of expertise, and not only highlights dos and don'ts, but also details why. You can rely on this document to guide your choice of approach, and ensure you're on the right track no matter what browser or hardware your users run."><meta property="og:image" content="../../../../../mdn-social-share.cd6c4a5a.png"><meta property="twitter:card" content="summary_large_image"><link rel="canonical" href="WebGL_best_practices.html"><style media="print">.article-actions-container,.document-toc-container,.language-menu,.main-menu-toggle,.mdn-cta-container,.on-github,.page-footer,.sidebar,.top-navigation-main,ul.prev-next{display:none!important}.main-page-content,.main-page-content pre{padding:2px}.main-page-content pre{border-left-width:2px}</style><script src="../../../../../static/js/ga.js" defer=""></script><script defer="defer" src="../../../../../static/js/main.5c9d40d0.js"></script><link href="../../../../../static/css/main.7d378400.css" rel="stylesheet"></head><body><script>document.body.addEventListener("load",(t=>{t.target.classList.contains("interactive")&&t.target.setAttribute("data-readystate","complete")}),{capture:!0});const c={light:"#ffffff",dark:"#1b1b1b"};if(window&&document.documentElement)try{const t=window.localStorage.getItem("theme");t&&(document.documentElement.className=t,document.documentElement.style.backgroundColor=c[t])}catch(t){console.warn("Unable to read theme from localStorage",t)}</script><div id="root"><ul id="nav-access" class="a11y-nav"><li><a id="skip-main" href="#content">Skip to main content</a></li><li><a id="skip-search" href="#top-nav-search-input">Skip to search</a></li><li><a id="skip-select-language" href="#languages-switcher-button">Skip to select language</a></li></ul><div class="page-wrapper  category-api document-page"><div class="main-document-header-container"><header class="main-document-header-container top-navigation 
      
      "><div class="container "><div class="top-navigation-wrap"><a href="https://developer.mozilla.org/en-US/" class="logo" aria-label="MDN homepage"><svg id="mdn-docs-logo" xmlns="http://www.w3.org/2000/svg" x="0" y="0" viewBox="0 0 694.9 104.4" style="enable-background:new 0 0 694.9 104.4" xml:space="preserve" role="img"><title>MDN Web Docs</title><style>.logo-m{fill:var(--text-link)}</style><g class="logo-m"><path d="M40.3 0 11.7 92.1H0L28.5 0h11.8zM50.7 0v92.1H40.3V0h10.4zM91 0 62.5 92.1H50.8L79.3 0H91zM101.4 0v92.1H91V0h10.4z"></path></g><path class="logo-m" d="M627.9 95.6h67v8.8h-67v-8.8z"></path><g style="fill:var(--text-primary)"><path d="M367 42h-4l-10.7 30.8h-5.5l-10.8-26h-.4l-10.5 26h-5.2L308.7 42h-3.8v-5.6H323V42h-6.5l6.8 20.4h.4l10.3-26h4.7l11.2 26h.5l5.7-20.3h-6.2v-5.6H367V42zM401.9 62c-.4 3.2-2 5.9-4.7 8.2-2.8 2.3-6.5 3.4-11.3 3.4-5.4 0-9.7-1.6-13.1-4.7-3.3-3.2-5-7.7-5-13.7 0-5.7 1.6-10.3 4.7-14s7.4-5.5 12.9-5.5c5.1 0 9.1 1.6 11.9 4.7s4.3 6.9 4.3 11.3c0 1.5-.2 3-.5 4.7h-25.6c.3 7.7 4 11.6 10.9 11.6 2.9 0 5.1-.7 6.5-2 1.5-1.4 2.5-3 3-4.9l6 .9zM394 51.3c.2-2.4-.4-4.7-1.8-6.9s-3.8-3.3-7-3.3c-3.1 0-5.3 1-6.9 3-1.5 2-2.5 4.4-2.8 7.2H394zM445 53.7c0 5-1.3 9.5-4 13.7s-6.9 6.2-12.7 6.2c-6 0-10.3-2.2-12.7-6.7-.1.4-.2 1.4-.4 2.9s-.3 2.5-.4 2.9h-7.3c.3-1.7.6-3.5.8-5.3.3-1.8.4-3.7.4-5.5V22.3h-6v-5.6H416v27c1.1-2.2 2.7-4.1 4.7-5.7 2-1.6 4.8-2.4 8.4-2.4 4.6 0 8.4 1.6 11.4 4.7 3 3.2 4.5 7.6 4.5 13.4zm-7.7.6c0-4.2-1-7.4-3-9.5-2-2.2-4.4-3.3-7.4-3.3-3.4 0-6 1.2-8 3.7-1.9 2.4-2.9 5-3 7.7V57c0 3 1 5.6 3 7.7s4.5 3.1 7.6 3.1c3.6 0 6.3-1.3 8.1-3.9 1.8-2.7 2.7-5.9 2.7-9.6zM506.5 72.8h-13.2v-7.2c-1.2 2.2-2.8 4.1-4.9 5.6-2.1 1.6-4.8 2.4-8.3 2.4-4.8 0-8.7-1.6-11.6-4.9-2.9-3.2-4.3-7.7-4.3-13.3 0-5 1.3-9.6 4-13.7 2.6-4.1 6.9-6.2 12.8-6.2 5.7 0 9.8 2.2 12.3 6.5V22.3h-8.6v-5.6h15.8v50.6h6v5.5zM493.2 56v-4.4c-.1-3-1.2-5.5-3.2-7.3s-4.4-2.8-7.2-2.8c-3.6 0-6.3 1.3-8.2 3.9-1.9 2.6-2.8 5.8-2.8 9.6 0 4.1 1 7.3 3 9.5s4.5 3.3 7.4 3.3c3.2 0 5.8-1.3 7.8-3.8 2.1-2.6 3.1-5.3 3.2-8zM546.3 54.6c0 5.6-1.8 10.2-5.3 13.7s-8.2 5.3-13.9 5.3-10.1-1.7-13.4-5.1c-3.3-3.4-5-7.9-5-13.5 0-5.3 1.6-9.9 4.7-13.7 3.2-3.8 7.9-5.7 14.2-5.7s11 1.9 14.1 5.7c3 3.7 4.6 8.1 4.6 13.3zm-7.7-.2c0-4-1-7.2-3-9.5s-4.8-3.5-8.2-3.5c-3.6 0-6.4 1.2-8.3 3.7s-2.9 5.6-2.9 9.5c0 3.7.9 6.8 2.8 9.4 1.9 2.6 4.6 3.9 8.3 3.9 3.6 0 6.4-1.3 8.4-3.8 1.9-2.6 2.9-5.8 2.9-9.7zM583.6 60.2c-.4 3.2-1.9 6.3-4.4 9.1-2.5 2.9-6.4 4.3-11.8 4.3-5.2 0-9.4-1.6-12.6-4.8-3.2-3.2-4.8-7.7-4.8-13.7 0-5.5 1.6-10.1 4.7-13.9 3.2-3.8 7.6-5.7 13.2-5.7 2.3 0 4.6.3 6.7.8 2.2.5 4.2 1.5 6.2 2.9l1.5 9.5-5.9.7-1.3-6.1c-2.1-1.2-4.5-1.8-7.2-1.8-3.5 0-6.1 1.2-7.7 3.7-1.7 2.5-2.5 5.7-2.5 9.6 0 4.1.9 7.3 2.7 9.5 1.8 2.3 4.4 3.4 7.8 3.4 5.2 0 8.2-2.9 9.2-8.8l6.2 1.3zM618.3 62.1c0 3.6-1.5 6.5-4.6 8.5s-7 3-11.7 3c-5.7 0-10.6-1.2-14.6-3.6l1.2-8.8 5.7.6-.2 4.7c1.1.5 2.3.9 3.6 1.1s2.6.3 3.9.3c2.4 0 4.5-.4 6.5-1.3 1.9-.9 2.9-2.2 2.9-4.1 0-1.8-.8-3.1-2.3-3.8s-3.5-1.3-5.8-1.7-4.6-.9-6.9-1.4c-2.3-.6-4.2-1.6-5.7-2.9-1.6-1.4-2.3-3.5-2.3-6.3 0-4.1 1.5-6.9 4.6-8.5s6.4-2.4 9.9-2.4c2.6 0 5 .3 7.2.9 2.2.6 4.3 1.4 6.1 2.4l.8 8.8-5.8.7-.8-5.7c-2.3-1-4.7-1.6-7.2-1.6-2.1 0-3.7.4-5.1 1.1-1.3.8-2 2-2 3.8 0 1.7.8 2.9 2.3 3.6 1.5.7 3.4 1.2 5.7 1.6 2.2.4 4.5.8 6.7 1.4 2.2.6 4.1 1.6 5.7 3 1.4 1.6 2.2 3.7 2.2 6.6zM197.6 73.2h-17.1v-5.5h3.8V51.9c0-3.7-.7-6.3-2.1-7.9-1.4-1.6-3.3-2.3-5.7-2.3-3.2 0-5.6 1.1-7.2 3.4s-2.4 4.6-2.5 6.9v15.6h6v5.5h-17.1v-5.5h3.8V51.9c0-3.8-.7-6.4-2.1-7.9-1.4-1.5-3.3-2.3-5.6-2.3-3.2 0-5.5 1.1-7.2 3.3-1.6 2.2-2.4 4.5-2.5 6.9v15.8h6.9v5.5h-20.2v-5.5h6V42.4h-6.1v-5.6h13.4v6.4c1.2-2.1 2.7-3.8 4.7-5.2 2-1.3 4.4-2 7.3-2s5.3.7 7.5 2.1c2.2 1.4 3.7 3.5 4.5 6.4 1.1-2.5 2.7-4.5 4.9-6.1s4.8-2.4 7.9-2.4c3.5 0 6.5 1.1 8.9 3.3s3.7 5.6 3.7 10.2v18.2h6.1v5.5zm42.5 0h-13.2V66c-1.2 2.2-2.8 4.1-4.9 5.6-2.1 1.6-4.8 2.4-8.3 2.4-4.8 0-8.7-1.6-11.6-4.9-2.9-3.2-4.3-7.7-4.3-13.3 0-5 1.3-9.6 4-13.7 2.6-4.1 6.9-6.2 12.8-6.2s9.8 2.2 12.3 6.5V22.7h-8.6v-5.6h15.8v50.6h6v5.5zm-13.3-16.8V52c-.1-3-1.2-5.5-3.2-7.3s-4.4-2.8-7.2-2.8c-3.6 0-6.3 1.3-8.2 3.9-1.9 2.6-2.8 5.8-2.8 9.6 0 4.1 1 7.3 3 9.5s4.5 3.3 7.4 3.3c3.2 0 5.8-1.3 7.8-3.8 2.1-2.6 3.1-5.3 3.2-8zm61.5 16.8H269v-5.5h6V51.9c0-3.7-.7-6.3-2.2-7.9-1.4-1.6-3.4-2.3-5.7-2.3-3.1 0-5.6 1-7.4 3s-2.8 4.4-2.9 7v15.9h6v5.5h-19.3v-5.5h6V42.4h-6.2v-5.6h13.6V43c2.6-4.6 6.8-6.9 12.7-6.9 3.6 0 6.7 1.1 9.2 3.3s3.7 5.6 3.7 10.2v18.2h6v5.4h-.2z"></path></g></svg></a><button title="Open main menu" type="button" class="button action has-icon main-menu-toggle" aria-haspopup="menu" aria-label="Open main menu" aria-expanded="false"><span class="button-wrap"><span class="icon icon-menu "></span><span class="visually-hidden">Open main menu</span></span></button></div><div class="top-navigation-main"><nav class="main-nav" aria-label="Main menu"><ul class="main-menu nojs"><li class="top-level-entry-container"><button type="button" id="references-button" class="top-level-entry menu-toggle" aria-controls="references-menu" aria-expanded="false">References</button><a href="https://developer.mozilla.org/en-US/docs/Web" class="top-level-entry">References</a><ul id="references-menu" class="submenu references hidden inline-submenu-lg" aria-labelledby="references-button"><li class="apis-link-container mobile-only "><a href="https://developer.mozilla.org/en-US/docs/Web" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">Overview / Web Technology</div><p class="submenu-item-description">Web technology reference for developers</p></div></a></li><li class="html-link-container "><a href="https://developer.mozilla.org/en-US/docs/Web/HTML" class="submenu-item "><div class="submenu-icon html"></div><div class="submenu-content-container"><div class="submenu-item-heading">HTML</div><p class="submenu-item-description">Structure of content on the web</p></div></a></li><li class="css-link-container "><a href="https://developer.mozilla.org/en-US/docs/Web/CSS" class="submenu-item "><div class="submenu-icon css"></div><div class="submenu-content-container"><div class="submenu-item-heading">CSS</div><p class="submenu-item-description">Code used to describe document style</p></div></a></li><li class="javascript-link-container "><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript" class="submenu-item "><div class="submenu-icon javascript"></div><div class="submenu-content-container"><div class="submenu-item-heading">JavaScript</div><p class="submenu-item-description">General-purpose scripting language</p></div></a></li><li class="http-link-container "><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP" class="submenu-item "><div class="submenu-icon http"></div><div class="submenu-content-container"><div class="submenu-item-heading">HTTP</div><p class="submenu-item-description">Protocol for transmitting web resources</p></div></a></li><li class="apis-link-container "><a href="../../API.html" class="submenu-item "><div class="submenu-icon apis"></div><div class="submenu-content-container"><div class="submenu-item-heading">Web APIs</div><p class="submenu-item-description">Interfaces for building web applications</p></div></a></li><li class="apis-link-container "><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">Web Extensions</div><p class="submenu-item-description">Developing extensions for web browsers</p></div></a></li><li class="apis-link-container desktop-only "><a href="https://developer.mozilla.org/en-US/docs/Web" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">Web Technology</div><p class="submenu-item-description">Web technology reference for developers</p></div></a></li></ul></li><li class="top-level-entry-container"><button type="button" id="guides-button" class="top-level-entry menu-toggle" aria-controls="guides-menu" aria-expanded="false">Guides</button><a href="https://developer.mozilla.org/en-US/docs/Learn" class="top-level-entry">Guides</a><ul id="guides-menu" class="submenu guides hidden inline-submenu-lg" aria-labelledby="guides-button"><li class="apis-link-container mobile-only "><a href="https://developer.mozilla.org/en-US/docs/Learn" class="submenu-item "><div class="submenu-icon learn"></div><div class="submenu-content-container"><div class="submenu-item-heading">Overview / MDN Learning Area</div><p class="submenu-item-description">Learn web development</p></div></a></li><li class="apis-link-container desktop-only "><a href="https://developer.mozilla.org/en-US/docs/Learn" class="submenu-item "><div class="submenu-icon learn"></div><div class="submenu-content-container"><div class="submenu-item-heading">MDN Learning Area</div><p class="submenu-item-description">Learn web development</p></div></a></li><li class="html-link-container "><a href="https://developer.mozilla.org/en-US/docs/Learn/HTML" class="submenu-item "><div class="submenu-icon html"></div><div class="submenu-content-container"><div class="submenu-item-heading">HTML</div><p class="submenu-item-description">Learn to structure web content with HTML</p></div></a></li><li class="css-link-container "><a href="https://developer.mozilla.org/en-US/docs/Learn/CSS" class="submenu-item "><div class="submenu-icon css"></div><div class="submenu-content-container"><div class="submenu-item-heading">CSS</div><p class="submenu-item-description">Learn to style content using CSS</p></div></a></li><li class="javascript-link-container "><a href="https://developer.mozilla.org/en-US/docs/Learn/JavaScript" class="submenu-item "><div class="submenu-icon javascript"></div><div class="submenu-content-container"><div class="submenu-item-heading">JavaScript</div><p class="submenu-item-description">Learn to run scripts in the browser</p></div></a></li><li class=" "><a href="https://developer.mozilla.org/en-US/docs/Web/Accessibility" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">Accessibility</div><p class="submenu-item-description">Learn to make the web accessible to all</p></div></a></li></ul></li><li class="top-level-entry-container"><button type="button" id="mdn-plus-button" class="top-level-entry menu-toggle" aria-controls="mdn-plus-menu" aria-expanded="false">MDN Plus</button><a href="https://developer.mozilla.org/en-US/plus" class="top-level-entry">MDN Plus</a><ul id="mdn-plus-menu" class="submenu mdn-plus hidden inline-submenu-lg" aria-labelledby="mdn-plus-button"><li class=" "><a href="https://developer.mozilla.org/en-US/plus" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">Overview</div><p class="submenu-item-description">A customized MDN experience</p></div></a></li><li class=" "><a href="https://developer.mozilla.org/en-US/plus/updates" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">Updates</div><p class="submenu-item-description">All browser compatibility updates at a glance</p></div></a></li><li class=" "><a href="https://developer.mozilla.org/en-US/plus/docs/features/overview" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">Documentation</div><p class="submenu-item-description">Learn how to use MDN Plus</p></div></a></li><li class=" "><a href="https://developer.mozilla.org/en-US/plus/docs/faq" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">FAQ</div><p class="submenu-item-description">Frequently asked questions about MDN Plus</p></div></a></li></ul></li></ul></nav><div class="header-search"><form action="https://developer.mozilla.org/en-US/search" role="search" aria-haspopup="listbox" aria-owns="top-nav-search-menu" aria-expanded="false" class="search-form search-widget" id="top-nav-search-form"><label id="top-nav-search-label" for="top-nav-search-input" class="visually-hidden">Search MDN</label><input id="top-nav-search-input" aria-autocomplete="list" aria-controls="top-nav-search-menu" aria-labelledby="top-nav-search-label" autocomplete="off" type="search" class="search-input-field" name="q" placeholder="   " required="" value=""><button type="button" class="button action has-icon clear-search-button"><span class="button-wrap"><span class="icon icon-cancel "></span><span class="visually-hidden">Clear search input</span></span></button><button type="submit" class="button action has-icon search-button"><span class="button-wrap"><span class="icon icon-search "></span><span class="visually-hidden">Search</span></span></button><div id="top-nav-search-menu" role="listbox" aria-labelledby="top-nav-search-label"></div></form></div><div class="theme-switcher-menu"><button type="button" class="button action has-icon theme-switcher-menu small" aria-haspopup="menu"><span class="button-wrap"><span class="icon icon-theme-os-default "></span>Theme</span></button></div><ul class="auth-container"><li><a href="https://developer.mozilla.org/users/fxa/login/authenticate/?next=%2Fen-US%2Fdocs%2FWeb%2FAPI%2FWebGL_API%2FWebGL_best_practices" class="signin-link" rel="nofollow">Already a subscriber?</a></li><li><a class="button primary mdn-plus-subscribe-link" href="https://developer.mozilla.org/en-US/plus"><span class="button-wrap">Get MDN Plus</span></a></li></ul></div></div></header><div class="article-actions-container"><div class="container"><button type="button" class="button action has-icon sidebar-button" aria-label="Expand sidebar" aria-expanded="false" aria-controls="sidebar-quicklinks"><span class="button-wrap"><span class="icon icon-sidebar "></span></span></button><nav class="breadcrumbs-container" aria-label="Breadcrumb"><ol typeof="BreadcrumbList" vocab="https://schema.org/" aria-label="breadcrumbs"><li property="itemListElement" typeof="ListItem"><a class="breadcrumb" property="item" typeof="WebPage" href="https://developer.mozilla.org/en-US/docs/Web"><span property="name">References</span></a><meta property="position" content="1"></li><li property="itemListElement" typeof="ListItem"><a class="breadcrumb" property="item" typeof="WebPage" href="../../API.html"><span property="name">Web APIs</span></a><meta property="position" content="2"></li><li property="itemListElement" typeof="ListItem"><a class="breadcrumb" property="item" typeof="WebPage" href="../WebGL_API.html"><span property="name">WebGL: 2D and 3D graphics for the web</span></a><meta property="position" content="3"></li><li property="itemListElement" typeof="ListItem"><a class="breadcrumb-current-page" property="item" typeof="WebPage" href="WebGL_best_practices.html"><span property="name">WebGL best practices</span></a><meta property="position" content="4"></li></ol></nav><div class="article-actions"><button type="button" class="button action has-icon article-actions-toggle" aria-label="Article actions"><span class="button-wrap"><span class="icon icon-ellipses "></span><span class="article-actions-dialog-heading">Article Actions</span></span></button><ul class="article-actions-entries"><li class="article-actions-entry"><div class="languages-switcher-menu open-on-focus-within"><button id="languages-switcher-button" type="button" class="button action small has-icon languages-switcher-menu" aria-haspopup="menu"><span class="button-wrap"><span class="icon icon-language "></span>English (US)</span></button></div></li></ul></div></div></div></div><div class="main-wrapper"><aside id="sidebar-quicklinks" class="sidebar"><button type="button" class="button action backdrop" aria-label="Collapse sidebar"><span class="button-wrap"></span></button><nav aria-label="Related Topics" class="sidebar-inner"><div class="in-nav-toc"><div class="document-toc-container"><section class="document-toc"><header><h2 class="document-toc-heading">In this article</h2></header><ul class="document-toc-list"><li class="document-toc-item "><a class="document-toc-link" href="#address_and_eliminate_webgl_errors">Address and eliminate WebGL errors</a></li><li class="document-toc-item "><a class="document-toc-link" href="#understand_extension_availability">Understand extension availability</a></li><li class="document-toc-item "><a class="document-toc-link" href="#understand_system_limits">Understand system limits</a></li><li class="document-toc-item "><a class="document-toc-link" href="#avoid_invalidating_fbo_attachment_bindings">Avoid invalidating FBO attachment bindings</a></li><li class="document-toc-item "><a class="document-toc-link" href="#delete_objects_eagerly">Delete objects eagerly</a></li><li class="document-toc-item "><a class="document-toc-link" href="#lose_contexts_eagerly">Lose contexts eagerly</a></li><li class="document-toc-item "><a class="document-toc-link" href="#flush_when_expecting_results">Flush when expecting results</a></li><li class="document-toc-item "><a class="document-toc-link" href="#avoid_blocking_api_calls_in_production">Avoid blocking API calls in production</a></li><li class="document-toc-item "><a class="document-toc-link" href="#always_enable_vertex_attrib_0_as_an_array">Always enable vertex attrib 0 as an array</a></li><li class="document-toc-item "><a class="document-toc-link" href="#estimate_a_per-pixel_vram_budget">Estimate a per-pixel VRAM Budget</a></li><li class="document-toc-item "><a class="document-toc-link" href="#consider_rendering_to_a_smaller_back_buffer">Consider rendering to a smaller back buffer</a></li><li class="document-toc-item "><a class="document-toc-link" href="#batch_draw_calls">Batch draw calls</a></li><li class="document-toc-item "><a class="document-toc-link" href="#avoid_ifdef_gl_es">Avoid "#ifdef GL_ES"</a></li><li class="document-toc-item "><a class="document-toc-link" href="#prefer_doing_work_in_the_vertex_shader">Prefer doing work in the vertex shader</a></li><li class="document-toc-item "><a class="document-toc-link" href="#compile_shaders_and_link_programs_in_parallel">Compile Shaders and Link Programs in parallel</a></li><li class="document-toc-item "><a class="document-toc-link" href="#prefer_khr_parallel_shader_compile">Prefer KHR_parallel_shader_compile</a></li><li class="document-toc-item "><a class="document-toc-link" href="#dont_check_shader_compile_status_unless_linking_fails">Don't check shader compile status unless linking fails</a></li><li class="document-toc-item "><a class="document-toc-link" href="#be_precise_with_glsl_precision_annotations">Be precise with GLSL precision annotations</a></li><li class="document-toc-item "><a class="document-toc-link" href="#prefer_builtins_instead_of_building_your_own">Prefer builtins instead of building your own</a></li><li class="document-toc-item "><a class="document-toc-link" href="#use_mipmaps_for_any_texture_youll_see_in_3d">Use mipmaps for any texture you'll see in 3d</a></li><li class="document-toc-item "><a class="document-toc-link" href="#dont_assume_you_can_render_into_float_textures">Don't assume you can render into float textures</a></li><li class="document-toc-item "><a class="document-toc-link" href="#some_formats_e.g._rgb_may_be_emulated">Some formats (e.g. RGB) may be emulated</a></li><li class="document-toc-item "><a class="document-toc-link" href="#avoid_alphafalse_which_can_be_expensive">Avoid alpha:false, which can be expensive</a></li><li class="document-toc-item "><a class="document-toc-link" href="#consider_compressed_texture_formats">Consider compressed texture formats</a></li><li class="document-toc-item "><a class="document-toc-link" href="#memory_usage_of_depth_and_stencil_formats">Memory usage of depth and stencil formats</a></li><li class="document-toc-item "><a class="document-toc-link" href="#teximagetexsubimage_uploads_esp._videos_can_cause_pipeline_flushes">texImage/texSubImage uploads (esp. videos) can cause pipeline flushes</a></li><li class="document-toc-item "><a class="document-toc-link" href="#use_texstorage_to_create_textures">Use texStorage to create textures</a></li><li class="document-toc-item "><a class="document-toc-link" href="#use_invalidateframebuffer">Use invalidateFramebuffer</a></li><li class="document-toc-item "><a class="document-toc-link" href="#use_non-blocking_async_data_readback">Use non-blocking async data readback</a></li><li class="document-toc-item "><a class="document-toc-link" href="#imagebitmap_creation">ImageBitmap creation</a></li></ul></section></div></div><div><ol><li><strong><a href="../WebGL_API.html">WebGL API</a></strong></li><li class="toggle"><details open=""><summary>Guides</summary><ol><li><a href="Constants.html">WebGL constants</a></li><li><a href="Types.html">WebGL types</a></li><li><a href="WebGL_model_view_projection.html">WebGL model view projection</a></li><li><em><a href="WebGL_best_practices.html" aria-current="page">WebGL best practices</a></em></li><li><a href="By_example.html">WebGL by example</a></li><li><a href="Basic_2D_animation_example.html">A basic 2D WebGL animation example</a></li><li><a href="Compressed_texture_formats.html">Compressed texture formats</a></li><li><a href="Data.html">Data in WebGL</a></li><li><a href="Matrix_math_for_the_web.html">Matrix math for the web</a></li><li><a href="Using_Extensions.html">Using WebGL extensions</a></li></ol></details></li><li class="toggle"><details open=""><summary>Tutorial</summary><ol><li><a href="Tutorial.html">WebGL tutorial</a></li><li><a href="Tutorial/Getting_started_with_WebGL.html">Getting started with WebGL</a></li><li><a href="Tutorial/Adding_2D_content_to_a_WebGL_context.html">Adding 2D content to a WebGL context</a></li><li><a href="Tutorial/Using_shaders_to_apply_color_in_WebGL.html">Using shaders to apply color in WebGL</a></li><li><a href="Tutorial/Animating_objects_with_WebGL.html">Animating objects with WebGL</a></li><li><a href="Tutorial/Creating_3D_objects_using_WebGL.html">Creating 3D objects using WebGL</a></li><li><a href="Tutorial/Using_textures_in_WebGL.html">Using textures in WebGL</a></li><li><a href="Tutorial/Lighting_in_WebGL.html">Lighting in WebGL</a></li><li><a href="Tutorial/Animating_textures_in_WebGL.html">Animating textures in WebGL</a></li></ol></details></li><li class="toggle"><details open=""><summary>Interfaces</summary><ol><li><a href="../WebGLRenderingContext.html"><code>WebGLRenderingContext</code></a></li><li><a href="../WebGLBuffer.html"><code>WebGLBuffer</code></a></li><li><a href="../WebGLFramebuffer.html"><code>WebGLFramebuffer</code></a></li><li><a href="../WebGLRenderbuffer.html"><code>WebGLRenderbuffer</code></a></li><li><a href="../WebGLObject.html"><code>WebGLObject</code></a></li><li><a href="../WebGLProgram.html"><code>WebGLProgram</code></a></li><li><a href="../WebGLShader.html"><code>WebGLShader</code></a></li><li><a href="../WebGLTexture.html"><code>WebGLTexture</code></a></li><li><a href="../WebGLUniformLocation.html"><code>WebGLUniformLocation</code></a></li><li><a href="../WebGLActiveInfo.html"><code>WebGLActiveInfo</code></a></li><li><a href="../WebGLShaderPrecisionFormat.html"><code>WebGLShaderPrecisionFormat</code></a></li><li><a href="../WebGLContextEvent.html"><code>WebGLContextEvent</code></a></li><li><a href="../WebGLQuery.html"><code>WebGLQuery</code></a></li><li><a href="../WebGLSampler.html"><code>WebGLSampler</code></a></li><li><a href="../WebGLSync.html"><code>WebGLSync</code></a></li><li><a href="../WebGLTransformFeedback.html"><code>WebGLTransformFeedback</code></a></li><li><a href="../WebGLVertexArrayObject.html"><code>WebGLVertexArrayObject</code></a></li><li><a href="../WebGL2RenderingContext.html"><code>WebGL2RenderingContext</code></a></li><li><a href="../WEBGL_compressed_texture_s3tc.html"><code>WEBGL_compressed_texture_s3tc</code></a></li><li><a href="../WEBGL_compressed_texture_s3tc_srgb.html"><code>WEBGL_compressed_texture_s3tc_srgb</code></a></li><li><a href="../WEBGL_compressed_texture_etc1.html"><code>WEBGL_compressed_texture_etc1</code></a></li><li><a href="../WEBGL_compressed_texture_pvrtc.html"><code>WEBGL_compressed_texture_pvrtc</code></a></li><li><a href="../WEBGL_debug_renderer_info.html"><code>WEBGL_debug_renderer_info</code></a></li><li><a href="../WEBGL_debug_shaders.html"><code>WEBGL_debug_shaders</code></a></li><li><a href="../WEBGL_depth_texture.html"><code>WEBGL_depth_texture</code></a></li><li><a href="../OES_element_index_uint.html"><code>OES_element_index_uint</code></a></li><li><a href="../EXT_frag_depth.html"><code>EXT_frag_depth</code></a></li><li><a href="../WEBGL_lose_context.html"><code>WEBGL_lose_context</code></a></li><li><a href="../EXT_texture_filter_anisotropic.html"><code>EXT_texture_filter_anisotropic</code></a></li><li><a href="../EXT_sRGB.html"><code>EXT_sRGB</code></a></li><li><a href="../OES_standard_derivatives.html"><code>OES_standard_derivatives</code></a></li><li><a href="../OES_texture_float.html"><code>OES_texture_float</code></a></li><li><a href="../WEBGL_draw_buffers.html"><code>WEBGL_draw_buffers</code></a></li><li><a href="../OES_texture_float_linear.html"><code>OES_texture_float_linear</code></a></li><li><a href="../EXT_shader_texture_lod.html"><code>EXT_shader_texture_lod</code></a></li><li><a href="../OES_texture_half_float.html"><code>OES_texture_half_float</code></a></li><li><a href="../OES_texture_half_float_linear.html"><code>OES_texture_half_float_linear</code></a></li><li><a href="../WEBGL_color_buffer_float.html"><code>WEBGL_color_buffer_float</code></a></li><li><a href="../EXT_color_buffer_half_float.html"><code>EXT_color_buffer_half_float</code></a></li><li><a href="../OES_vertex_array_object.html"><code>OES_vertex_array_object</code></a></li><li><a href="../ANGLE_instanced_arrays.html"><code>ANGLE_instanced_arrays</code></a></li><li><a href="../EXT_blend_minmax.html"><code>EXT_blend_minmax</code></a></li><li><a href="../EXT_disjoint_timer_query.html"><code>EXT_disjoint_timer_query</code></a></li></ol></details></li><li class="toggle"><details open=""><summary>Events</summary><ol><li><a href="../HTMLCanvasElement/webglcontextcreationerror_event.html"><code>HTMLCanvasElement</code>: <code>webglcontextcreationerror</code></a></li><li><a href="../HTMLCanvasElement/webglcontextlost_event.html"><code>HTMLCanvasElement</code>: <code>webglcontextlost</code></a></li><li><a href="../HTMLCanvasElement/webglcontextrestored_event.html"><code>HTMLCanvasElement</code>: <code>webglcontextrestored</code></a></li></ol></details></li></ol></div></nav></aside><aside class="toc"><nav><div class="document-toc-container"><section class="document-toc"><header><h2 class="document-toc-heading">In this article</h2></header><ul class="document-toc-list"><li class="document-toc-item "><a class="document-toc-link" href="#address_and_eliminate_webgl_errors">Address and eliminate WebGL errors</a></li><li class="document-toc-item "><a class="document-toc-link" href="#understand_extension_availability">Understand extension availability</a></li><li class="document-toc-item "><a class="document-toc-link" href="#understand_system_limits">Understand system limits</a></li><li class="document-toc-item "><a class="document-toc-link" href="#avoid_invalidating_fbo_attachment_bindings">Avoid invalidating FBO attachment bindings</a></li><li class="document-toc-item "><a class="document-toc-link" href="#delete_objects_eagerly">Delete objects eagerly</a></li><li class="document-toc-item "><a class="document-toc-link" href="#lose_contexts_eagerly">Lose contexts eagerly</a></li><li class="document-toc-item "><a class="document-toc-link" href="#flush_when_expecting_results">Flush when expecting results</a></li><li class="document-toc-item "><a class="document-toc-link" href="#avoid_blocking_api_calls_in_production">Avoid blocking API calls in production</a></li><li class="document-toc-item "><a class="document-toc-link" href="#always_enable_vertex_attrib_0_as_an_array">Always enable vertex attrib 0 as an array</a></li><li class="document-toc-item "><a class="document-toc-link" href="#estimate_a_per-pixel_vram_budget">Estimate a per-pixel VRAM Budget</a></li><li class="document-toc-item "><a class="document-toc-link" href="#consider_rendering_to_a_smaller_back_buffer">Consider rendering to a smaller back buffer</a></li><li class="document-toc-item "><a class="document-toc-link" href="#batch_draw_calls">Batch draw calls</a></li><li class="document-toc-item "><a class="document-toc-link" href="#avoid_ifdef_gl_es">Avoid "#ifdef GL_ES"</a></li><li class="document-toc-item "><a class="document-toc-link" href="#prefer_doing_work_in_the_vertex_shader">Prefer doing work in the vertex shader</a></li><li class="document-toc-item "><a class="document-toc-link" href="#compile_shaders_and_link_programs_in_parallel">Compile Shaders and Link Programs in parallel</a></li><li class="document-toc-item "><a class="document-toc-link" href="#prefer_khr_parallel_shader_compile">Prefer KHR_parallel_shader_compile</a></li><li class="document-toc-item "><a class="document-toc-link" href="#dont_check_shader_compile_status_unless_linking_fails">Don't check shader compile status unless linking fails</a></li><li class="document-toc-item "><a class="document-toc-link" href="#be_precise_with_glsl_precision_annotations">Be precise with GLSL precision annotations</a></li><li class="document-toc-item "><a class="document-toc-link" href="#prefer_builtins_instead_of_building_your_own">Prefer builtins instead of building your own</a></li><li class="document-toc-item "><a class="document-toc-link" href="#use_mipmaps_for_any_texture_youll_see_in_3d">Use mipmaps for any texture you'll see in 3d</a></li><li class="document-toc-item "><a class="document-toc-link" href="#dont_assume_you_can_render_into_float_textures">Don't assume you can render into float textures</a></li><li class="document-toc-item "><a class="document-toc-link" href="#some_formats_e.g._rgb_may_be_emulated">Some formats (e.g. RGB) may be emulated</a></li><li class="document-toc-item "><a class="document-toc-link" href="#avoid_alphafalse_which_can_be_expensive">Avoid alpha:false, which can be expensive</a></li><li class="document-toc-item "><a class="document-toc-link" href="#consider_compressed_texture_formats">Consider compressed texture formats</a></li><li class="document-toc-item "><a class="document-toc-link" href="#memory_usage_of_depth_and_stencil_formats">Memory usage of depth and stencil formats</a></li><li class="document-toc-item "><a class="document-toc-link" href="#teximagetexsubimage_uploads_esp._videos_can_cause_pipeline_flushes">texImage/texSubImage uploads (esp. videos) can cause pipeline flushes</a></li><li class="document-toc-item "><a class="document-toc-link" href="#use_texstorage_to_create_textures">Use texStorage to create textures</a></li><li class="document-toc-item "><a class="document-toc-link" href="#use_invalidateframebuffer">Use invalidateFramebuffer</a></li><li class="document-toc-item "><a class="document-toc-link" href="#use_non-blocking_async_data_readback">Use non-blocking async data readback</a></li><li class="document-toc-item "><a class="document-toc-link" href="#imagebitmap_creation">ImageBitmap creation</a></li></ul></section></div></nav></aside><main id="content" class="main-content  "><article class="main-page-content" lang="en-US"><h1>WebGL best practices</h1><div class="section-content"><p>WebGL is a complicated API, and it's often not obvious what the recommended ways to use it are. This page tackles recommendations across the spectrum of expertise, and not only highlights dos and don'ts, but also details <em>why</em>. You can rely on this document to guide your choice of approach, and ensure you're on the right track no matter what browser or hardware your users run.</p></div><section aria-labelledby="address_and_eliminate_webgl_errors"><a class="dashAnchor" name="//apple_ref/Section/Address%20and%20eliminate%20WebGL%20errors"></a><h2 id="address_and_eliminate_webgl_errors"><a href="#address_and_eliminate_webgl_errors">Address and eliminate WebGL errors</a></h2><div class="section-content"><p>Your application should run without generating any WebGL errors (as returned by <code>getError</code>). Every WebGL error is reported in the Web Console as a JavaScript warning with a descriptive message. After too many errors (32 in Firefox), WebGL stops generating descriptive messages, which really hinders debugging.</p>
<p>The <em>only</em> errors a well-formed page generates are <code>OUT_OF_MEMORY</code> and <code>CONTEXT_LOST</code>.</p></div></section><section aria-labelledby="understand_extension_availability"><a class="dashAnchor" name="//apple_ref/Section/Understand%20extension%20availability"></a><h2 id="understand_extension_availability"><a href="#understand_extension_availability">Understand extension availability</a></h2><div class="section-content"><p>The availability of most WebGL extensions depends on the client system. When using WebGL extensions, if possible, try to make them optional by gracefully adapting to the case there they are not supported.</p>
<p>These WebGL 1 extensions are universally supported, and can be relied upon to be present:</p>
<ul>
  <li>ANGLE_instanced_arrays</li>
  <li>EXT_blend_minmax</li>
  <li>OES_element_index_uint</li>
  <li>OES_standard_derivatives</li>
  <li>OES_vertex_array_object</li>
  <li>WEBGL_debug_renderer_info</li>
  <li>WEBGL_lose_context</li>
</ul>
<p><em>(see also: <a href="https://kdashg.github.io/misc/webgl/webgl-feature-levels.html" class="external" target="_blank">WebGL feature levels and % support</a>)</em></p>
<p>Consider polyfilling these into WebGLRenderingContext, like: <a href="https://github.com/kdashg/misc/blob/tip/webgl/webgl-v1.1.js" class="external" target="_blank">https://github.com/kdashg/misc/blob/tip/webgl/webgl-v1.1.js</a></p></div></section><section aria-labelledby="understand_system_limits"><a class="dashAnchor" name="//apple_ref/Section/Understand%20system%20limits"></a><h2 id="understand_system_limits"><a href="#understand_system_limits">Understand system limits</a></h2><div class="section-content"><p>Similarly to extensions, the limits of your system will be different than your clients' systems! Don't assume you can use thirty texture samplers per shader just because it works on your machine!</p>
<p>The minimum requirements for WebGL are quite low. In practice, effectively all systems support at least the following:</p>
<pre class="notranslate">MAX_CUBE_MAP_TEXTURE_SIZE: 4096
MAX_RENDERBUFFER_SIZE: 4096
MAX_TEXTURE_SIZE: 4096
MAX_VIEWPORT_DIMS: [4096,4096]
MAX_VERTEX_TEXTURE_IMAGE_UNITS: 4
MAX_TEXTURE_IMAGE_UNITS: 8
MAX_COMBINED_TEXTURE_IMAGE_UNITS: 8
MAX_VERTEX_ATTRIBS: 16
MAX_VARYING_VECTORS: 8
MAX_VERTEX_UNIFORM_VECTORS: 128
MAX_FRAGMENT_UNIFORM_VECTORS: 64
ALIASED_POINT_SIZE_RANGE: [1,100]
</pre>
<p>Your desktop may support 16k textures, or maybe 16 texture units in the vertex shader, but most other systems don't, and content that works for you will not work for them!</p></div></section><section aria-labelledby="avoid_invalidating_fbo_attachment_bindings"><a class="dashAnchor" name="//apple_ref/Section/Avoid%20invalidating%20FBO%20attachment%20bindings"></a><h2 id="avoid_invalidating_fbo_attachment_bindings"><a href="#avoid_invalidating_fbo_attachment_bindings">Avoid invalidating FBO attachment bindings</a></h2><div class="section-content"><p>Almost any change to an FBO's attachment bindings will invalidate its framebuffer completeness. Set up your hot framebuffers ahead of time.</p>
<p>In Firefox, setting the pref <code>webgl.perf.max-warnings</code> to <code>-1</code> in about:config will enable performance warnings that include warnings about FB completeness invalidations.</p></div></section><section aria-labelledby="avoid_changing_vao_attachments_vertexattribpointer_disableenablevertexattribarray"><h3 id="avoid_changing_vao_attachments_vertexattribpointer_disableenablevertexattribarray"><a href="#avoid_changing_vao_attachments_vertexattribpointer_disableenablevertexattribarray">Avoid changing VAO attachments (vertexAttribPointer, disable/enableVertexAttribArray)</a></h3><div class="section-content"><p>Drawing from static, unchanging VAOs is faster than mutating the same VAO for every draw call. For unchanged VAOs, browsers can cache the fetch limits, whereas when VAOs change, browsers must revalidate and recalculate limits. The overhead for this is relatively low, but re-using VAOs means fewer <code>vertexAttribPointer</code> calls too, so it's worth doing wherever it's easy.</p></div></section><section aria-labelledby="delete_objects_eagerly"><a class="dashAnchor" name="//apple_ref/Section/Delete%20objects%20eagerly"></a><h2 id="delete_objects_eagerly"><a href="#delete_objects_eagerly">Delete objects eagerly</a></h2><div class="section-content"><p>Don't wait for the garbage collector/cycle collector to realize objects are orphaned and destroy them. Implementations track the liveness of objects, so 'deleting' them at the API level only releases the handle that refers to the actual object. (conceptually releasing the handle's ref-pointer to the object) Only once the object is unused in the implementation is it actually freed. For example, if you never want to access your shader objects directly again, just delete their handles after attaching them to a program object.</p></div></section><section aria-labelledby="lose_contexts_eagerly"><a class="dashAnchor" name="//apple_ref/Section/Lose%20contexts%20eagerly"></a><h2 id="lose_contexts_eagerly"><a href="#lose_contexts_eagerly">Lose contexts eagerly</a></h2><div class="section-content"><p>Consider also eagerly losing WebGL contexts via the <code>WEBGL_lose_context</code> extension when you're definitely done with them and no longer need the target canvas's rendering results. Note that this is not necessary to do when navigating away from a page - don't add an unload event handler just for this purpose.</p></div></section><section aria-labelledby="flush_when_expecting_results"><a class="dashAnchor" name="//apple_ref/Section/Flush%20when%20expecting%20results"></a><h2 id="flush_when_expecting_results"><a href="#flush_when_expecting_results">Flush when expecting results</a></h2><div class="section-content"><p>Call <code>flush()</code> when expecting results such as queries, or at completion of a rendering frame.</p>
<p>Flush tells the implementation to push all pending commands out for execution, flushing them out of the queue, instead of waiting for more commands to enqueue before sending for execution.</p>
<p>For example, it is possible for the following to never complete without context loss:</p>
<div class="code-example"><pre class="brush: js notranslate"><code>sync <span class="token operator">=</span> <span class="token function">glFenceSync</span><span class="token punctuation">(</span><span class="token constant">GL_SYNC_GPU_COMMANDS_COMPLETE</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">glClientWaitSync</span><span class="token punctuation">(</span>sync<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token constant">GL_TIMEOUT_IGNORED</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>WebGL doesn't have a SwapBuffers call by default, so a flush can help fill the gap, as well.</p></div></section><section aria-labelledby="use_webgl.flush_when_not_using_requestanimationframe"><h3 id="use_webgl.flush_when_not_using_requestanimationframe"><a href="#use_webgl.flush_when_not_using_requestanimationframe">Use <code>webgl.flush()</code> when not using requestAnimationFrame</a></h3><div class="section-content"><p>When not using RAF, (such as when using RPAF; see below) use <code>webgl.flush()</code> to encourage eager execution of enqueued commands.</p>
<p>Because RAF is directly followed by the frame boundary, an explicit <code>webgl.flush()</code> isn't really needed with RAF.</p></div></section><section aria-labelledby="avoid_blocking_api_calls_in_production"><a class="dashAnchor" name="//apple_ref/Section/Avoid%20blocking%20API%20calls%20in%20production"></a><h2 id="avoid_blocking_api_calls_in_production"><a href="#avoid_blocking_api_calls_in_production">Avoid blocking API calls in production</a></h2><div class="section-content"><p>Certain WebGL entry points - including <code>getError</code> and <code>getParameter</code> - cause synchronous stalls on the calling thread. Even basic requests can take as long as 1ms, but they can take even longer if they need to wait for all graphics work to be completed (with an effect similar to <code>glFinish()</code> in native OpenGL).</p>
<p>In production code, avoid such entry points, especially on the browser main thread where they can cause the entire page to jank (often including scrolling or even the whole browser).</p>
<ul>
  <li>
    <code>getError()</code>: causes a flush + round-trip to fetch errors from the GPU process).
    For example, within Firefox, the only time glGetError is checked is after allocations (<code>bufferData</code>, <code>*texImage*</code>, <code>texStorage*</code>) to pick up any GL_OUT_OF_MEMORY errors.
  </li>
  <li><code>getShader/ProgramParameter()</code>, <code>getShader/ProgramInfoLog()</code>, other <code>get</code>s on shaders/programs: flush + shader compile + round-trip, if not done after shader compilation is complete. (See also <a href="#compile_shaders_and_link_programs_in_parallel">parallel shader compilation</a> below.)</li>
  <li><code>get*Parameter()</code> in general: possible flush + round-trip. In some cases, these will be cached to avoid the round-trip, but try to avoid relying on this.</li>
  <li><code>checkFramebufferStatus()</code>: possible flush + round-trip.</li>
  <li><code>getBufferSubData()</code>: usual finish + round-trip. (This is okay for READ buffers in conjunction with fences - see <a href="#non-blocking_async_data_downloadreadback">async data readback</a> below.)</li>
  <li><code>readPixels()</code> to the CPU (i.e. without an UNPACK buffer bound): finish + round-trip. Instead, use GPU-GPU <code>readPixels</code> in conjunction with async data readback.</li>
</ul></div></section><section aria-labelledby="always_enable_vertex_attrib_0_as_an_array"><a class="dashAnchor" name="//apple_ref/Section/Always%20enable%20vertex%20attrib%200%20as%20an%20array"></a><h2 id="always_enable_vertex_attrib_0_as_an_array"><a href="#always_enable_vertex_attrib_0_as_an_array">Always enable vertex attrib 0 as an array</a></h2><div class="section-content"><p>If you draw without vertex attrib 0 enabled as an array, you will force the browser to do complicated emulation when running on desktop OpenGL (such as on macOS). This is because in desktop OpenGL, nothing gets drawn if vertex attrib 0 is not array-enabled. You can use <code>bindAttribLocation</code> to force a vertex attribute to use location 0, and use <code>enableVertexAttribArray(0)</code> to make it array-enabled.</p></div></section><section aria-labelledby="estimate_a_per-pixel_vram_budget"><a class="dashAnchor" name="//apple_ref/Section/Estimate%20a%20per%2Dpixel%20VRAM%20Budget"></a><h2 id="estimate_a_per-pixel_vram_budget"><a href="#estimate_a_per-pixel_vram_budget">Estimate a per-pixel VRAM Budget</a></h2><div class="section-content"><p>WebGL doesn't offer APIs to query the maximum amount of video memory on the system because such queries are not portable. Still, applications must be conscious of VRAM usage and not just allocate as much as possible.</p>
<p>One technique pioneered by the Google Maps team is the notion of a <em>per-pixel VRAM budget</em>:</p>
<p>1) For one system (e.g. a particular desktop / laptop), decide the maximum amount of VRAM your application should use. 2) Compute the number of pixels covered by a maximized browser window. E.g. <code>(window.innerWidth * devicePixelRatio) * (window.innerHeight * window.devicePixelRatio)</code> 3) The per-pixel VRAM budget is (1) divided by (2), and is a constant.</p>
<p>This constant should <em>generally</em> be portable among systems. Mobile devices typically have smaller screens than powerful desktop machines with large monitors. Re-compute this constant on a few target systems to get a reliable estimate.</p>
<p>Now adjust all internal caching in the application (WebGLBuffers, WebGLTextures, etc.) to obey a maximum size, computed by this constant multiplied by the number of pixels covered by the <em>current</em> browser window. This requires estimating the number of bytes consumed by each texture, for example. The cap also must typically be updated as the browser window resizes, and older resources above the limit must be purged.</p>
<p>Keeping the application's VRAM usage under this cap will help to avoid out-of-memory errors and associated instability.</p></div></section><section aria-labelledby="consider_rendering_to_a_smaller_back_buffer"><a class="dashAnchor" name="//apple_ref/Section/Consider%20rendering%20to%20a%20smaller%20back%20buffer"></a><h2 id="consider_rendering_to_a_smaller_back_buffer"><a href="#consider_rendering_to_a_smaller_back_buffer">Consider rendering to a smaller back buffer</a></h2><div class="section-content"><p>A common (and easy) way to trade off quality for speed is rendering into a smaller back buffer, and upscaling the result. Consider reducing canvas.width and height and keeping canvas.style.width and height at a constant size.</p></div></section><section aria-labelledby="batch_draw_calls"><a class="dashAnchor" name="//apple_ref/Section/Batch%20draw%20calls"></a><h2 id="batch_draw_calls"><a href="#batch_draw_calls">Batch draw calls</a></h2><div class="section-content"><p>"Batching" draw calls into fewer, larger draw calls will generally improve performance. If you have 1000 sprites to paint, try to do it as a single drawArrays() or drawElements() call.</p>
<p>It's common to use "degenerate triangles" if you need to draw discontinuous objects as a single drawArrays(TRIANGLE_STRIP) call. Degenerate triangles are triangles with no area, therefore any triangle where more than one point is in the same exact location. These triangles are effectively skipped, which lets you start a new triangle strip unattached to your previous one, without having to split into multiple draw calls.</p>
<p>Another important method for batching is texture atlasing, where multiple images are placed into a single texture, often like a checkerboard. Since you need to split draw call batches to change textures, texture atlasing lets you combine more draw calls into fewer, bigger batches. See <a href="https://webglsamples.org/sprites/readme.html" class="external" target="_blank">this example</a> demonstrating how to combine even sprites referencing multiple texture atlases into a single draw call.</p></div></section><section aria-labelledby="avoid_ifdef_gl_es"><a class="dashAnchor" name="//apple_ref/Section/Avoid%20%22%23ifdef%20GL%5FES%22"></a><h2 id="avoid_ifdef_gl_es"><a href="#avoid_ifdef_gl_es">Avoid "#ifdef GL_ES"</a></h2><div class="section-content"><p>You should never use <code>#ifdef GL_ES</code> in your WebGL shaders; this condition is always true in WebGL. Although some early examples used this, it's not necessary.</p></div></section><section aria-labelledby="prefer_doing_work_in_the_vertex_shader"><a class="dashAnchor" name="//apple_ref/Section/Prefer%20doing%20work%20in%20the%20vertex%20shader"></a><h2 id="prefer_doing_work_in_the_vertex_shader"><a href="#prefer_doing_work_in_the_vertex_shader">Prefer doing work in the vertex shader</a></h2><div class="section-content"><p>Do as much work as you can in the vertex shader, rather than in the fragment shader. This is because per draw call, fragment shaders generally run many more times than vertex shaders. Any calculation that can be done on the vertices and then just interpolated among fragments (via <code>varying</code>s) is a performance boon. (The interpolation of varyings is very cheap, and is done automatically for you through the fixed functionality rasterization phase of the graphics pipeline.)</p>
<p>For example, a simple animation of a textured surface can be achieved through a time-dependent transformation of texture coordinates. (The simplest case being adding a uniform vector to the texture coordinates attribute vector) If visually acceptable, one can transform the texture coordinates in the vertex shader rather than in the fragment shader, to get better performance.</p>
<p>One common trade-off is to some lighting calculations per-vertex instead of per-fragment (pixel). In some cases, especially with simple models or dense vertices, this looks good enough.</p>
<p>The inversion of this is if a model has more vertices than pixels in the rendered output. However, LOD meshes is usually the answer to this problem, rarely moving work from the vertex <em>to</em> the fragment shader.</p></div></section><section aria-labelledby="compile_shaders_and_link_programs_in_parallel"><a class="dashAnchor" name="//apple_ref/Section/Compile%20Shaders%20and%20Link%20Programs%20in%20parallel"></a><h2 id="compile_shaders_and_link_programs_in_parallel"><a href="#compile_shaders_and_link_programs_in_parallel">Compile Shaders and Link Programs in parallel</a></h2><div class="section-content"><p>It's tempting to compile shaders and link programs serially, but many browsers can compile and link in parallel on background threads.</p>
<p>Instead of:</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token keyword">function</span> <span class="token function">compileOnce</span><span class="token punctuation">(</span><span class="token parameter">gl<span class="token punctuation">,</span> shader</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>shader<span class="token punctuation">.</span>compiled<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">compileShader</span><span class="token punctuation">(</span>shader<span class="token punctuation">)</span><span class="token punctuation">;</span>
  shader<span class="token punctuation">.</span>compiled <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token punctuation">[</span>vs<span class="token punctuation">,</span> fs<span class="token punctuation">,</span> prog<span class="token punctuation">]</span> <span class="token keyword">of</span> programs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">compileOnce</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> vs<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">compileOnce</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> fs<span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">linkProgram</span><span class="token punctuation">(</span>prog<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>gl<span class="token punctuation">.</span><span class="token function">getProgramParameter</span><span class="token punctuation">(</span>prog<span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">LINK_STATUS</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Link failed: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>gl<span class="token punctuation">.</span><span class="token function">getProgramInfoLog</span><span class="token punctuation">(</span>prog<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">vs info-log: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>gl<span class="token punctuation">.</span><span class="token function">getShaderInfoLog</span><span class="token punctuation">(</span>vs<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">fs info-log: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>gl<span class="token punctuation">.</span><span class="token function">getShaderInfoLog</span><span class="token punctuation">(</span>fs<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>Consider:</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token keyword">function</span> <span class="token function">compileOnce</span><span class="token punctuation">(</span><span class="token parameter">gl<span class="token punctuation">,</span> shader</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>shader<span class="token punctuation">.</span>compiled<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">compileShader</span><span class="token punctuation">(</span>shader<span class="token punctuation">)</span><span class="token punctuation">;</span>
  shader<span class="token punctuation">.</span>compiled <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token punctuation">[</span>vs<span class="token punctuation">,</span> fs<span class="token punctuation">,</span> prog<span class="token punctuation">]</span> <span class="token keyword">of</span> programs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">compileOnce</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> vs<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">compileOnce</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> fs<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token punctuation">[</span>vs<span class="token punctuation">,</span> fs<span class="token punctuation">,</span> prog<span class="token punctuation">]</span> <span class="token keyword">of</span> programs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  gl<span class="token punctuation">.</span><span class="token function">linkProgram</span><span class="token punctuation">(</span>prog<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token punctuation">[</span>vs<span class="token punctuation">,</span> fs<span class="token punctuation">,</span> prog<span class="token punctuation">]</span> <span class="token keyword">of</span> programs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>gl<span class="token punctuation">.</span><span class="token function">getProgramParameter</span><span class="token punctuation">(</span>prog<span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">LINK_STATUS</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Link failed: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>gl<span class="token punctuation">.</span><span class="token function">getProgramInfoLog</span><span class="token punctuation">(</span>prog<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">vs info-log: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>gl<span class="token punctuation">.</span><span class="token function">getShaderInfoLog</span><span class="token punctuation">(</span>vs<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">fs info-log: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>gl<span class="token punctuation">.</span><span class="token function">getShaderInfoLog</span><span class="token punctuation">(</span>fs<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div></section><section aria-labelledby="prefer_khr_parallel_shader_compile"><a class="dashAnchor" name="//apple_ref/Section/Prefer%20KHR%5Fparallel%5Fshader%5Fcompile"></a><h2 id="prefer_khr_parallel_shader_compile"><a href="#prefer_khr_parallel_shader_compile">Prefer KHR_parallel_shader_compile</a></h2><div class="section-content"><p>While we've described a pattern to allow browsers to compile and link in parallel, normally checking <code>COMPILE_STATUS</code> or <code>LINK_STATUS</code> blocks until the compile or link completes. In browsers where it's available, the <a href="https://www.khronos.org/registry/webgl/extensions/KHR_parallel_shader_compile/" class="external" target="_blank">KHR_parallel_shader_compile</a> extension provides a <em>non-blocking</em> <code>COMPLETION_STATUS</code> query. Prefer to enable and use this extension.</p>
<p>Example usage:</p>
<div class="code-example"><pre class="brush: js notranslate"><code>ext <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">getExtension</span><span class="token punctuation">(</span><span class="token string">"KHR_parallel_shader_compile"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
gl<span class="token punctuation">.</span><span class="token function">compileProgram</span><span class="token punctuation">(</span>vs<span class="token punctuation">)</span><span class="token punctuation">;</span>
gl<span class="token punctuation">.</span><span class="token function">compileProgram</span><span class="token punctuation">(</span>fs<span class="token punctuation">)</span><span class="token punctuation">;</span>
gl<span class="token punctuation">.</span><span class="token function">attachShader</span><span class="token punctuation">(</span>prog<span class="token punctuation">,</span> vs<span class="token punctuation">)</span><span class="token punctuation">;</span>
gl<span class="token punctuation">.</span><span class="token function">attachShader</span><span class="token punctuation">(</span>prog<span class="token punctuation">,</span> fs<span class="token punctuation">)</span><span class="token punctuation">;</span>
gl<span class="token punctuation">.</span><span class="token function">linkProgram</span><span class="token punctuation">(</span>prog<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Store program in your data structure.</span>
<span class="token comment">// Later, for example the next frame:</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>ext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token function">getProgramParameter</span><span class="token punctuation">(</span>prog<span class="token punctuation">,</span> ext<span class="token punctuation">.</span><span class="token constant">COMPLETION_STATUS_KHR</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Check program link status; if OK, use and draw with it.</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token comment">// Program linking is synchronous.</span>
  <span class="token comment">// Check program link status; if OK, use and draw with it.</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>This technique may not work in all applications, for example those which require programs to be immediately available for rendering. Still, consider how variations may work.</p></div></section><section aria-labelledby="dont_check_shader_compile_status_unless_linking_fails"><a class="dashAnchor" name="//apple_ref/Section/Don%27t%20check%20shader%20compile%20status%20unless%20linking%20fails"></a><h2 id="dont_check_shader_compile_status_unless_linking_fails"><a href="#dont_check_shader_compile_status_unless_linking_fails">Don't check shader compile status unless linking fails</a></h2><div class="section-content"><p>There are very few errors that are guaranteed to cause shader compilation failure, but cannot be deferred to link time. The <a href="../../../../../../registry.khronos.org/OpenGL/specs/es/3.0/GLSL_ES_Specification_3.00.pdf" class="external" target="_blank">ESSL3 spec</a> says this under "Error Handling":</p>
<blockquote>
  <p>The implementation should report errors as early a possible but in any case must satisfy the following:</p>
  <ul>
    <li>All lexical, grammatical and semantic errors must have been detected following a call to glLinkProgram</li>
    <li>Errors due to mismatch between the vertex and fragment shader (link errors) must have been detected following a call to glLinkProgram</li>
    <li>Errors due to exceeding resource limits must have been detected following any draw call or a call to glValidateProgram</li>
    <li>A call to glValidateProgram must report all errors associated with a program object given the current GL state.</li>
  </ul>
  <p>The allocation of tasks between the compiler and linker is implementation dependent. Consequently there are many errors which may be detected either at compile or link time, depending on the implementation.</p>
</blockquote>
<p>Additionally, querying compile status is a synchronous call, which breaks pipelining.</p>
<p>Instead of:</p>
<div class="code-example"><pre class="brush: js notranslate"><code>gl<span class="token punctuation">.</span><span class="token function">compileShader</span><span class="token punctuation">(</span>vs<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>gl<span class="token punctuation">.</span><span class="token function">getShaderParameter</span><span class="token punctuation">(</span>vs<span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">COMPILE_STATUS</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">vs compile failed: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>gl<span class="token punctuation">.</span><span class="token function">getShaderInfoLog</span><span class="token punctuation">(</span>vs<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

gl<span class="token punctuation">.</span><span class="token function">compileShader</span><span class="token punctuation">(</span>fs<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>gl<span class="token punctuation">.</span><span class="token function">getShaderParameter</span><span class="token punctuation">(</span>fs<span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">COMPILE_STATUS</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">fs compile failed: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>gl<span class="token punctuation">.</span><span class="token function">getShaderInfoLog</span><span class="token punctuation">(</span>fs<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

gl<span class="token punctuation">.</span><span class="token function">linkProgram</span><span class="token punctuation">(</span>prog<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>gl<span class="token punctuation">.</span><span class="token function">getProgramParameter</span><span class="token punctuation">(</span>vs<span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">LINK_STATUS</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Link failed: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>gl<span class="token punctuation">.</span><span class="token function">getProgramInfoLog</span><span class="token punctuation">(</span>prog<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>Consider:</p>
<div class="code-example"><pre class="brush: js notranslate"><code>gl<span class="token punctuation">.</span><span class="token function">compileShader</span><span class="token punctuation">(</span>vs<span class="token punctuation">)</span><span class="token punctuation">;</span>
gl<span class="token punctuation">.</span><span class="token function">compileShader</span><span class="token punctuation">(</span>fs<span class="token punctuation">)</span><span class="token punctuation">;</span>
gl<span class="token punctuation">.</span><span class="token function">linkProgram</span><span class="token punctuation">(</span>prog<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>gl<span class="token punctuation">.</span><span class="token function">getProgramParameter</span><span class="token punctuation">(</span>vs<span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">LINK_STATUS</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Link failed: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>gl<span class="token punctuation">.</span><span class="token function">getProgramInfoLog</span><span class="token punctuation">(</span>prog<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">vs info-log: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>gl<span class="token punctuation">.</span><span class="token function">getShaderInfoLog</span><span class="token punctuation">(</span>vs<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">fs info-log: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>gl<span class="token punctuation">.</span><span class="token function">getShaderInfoLog</span><span class="token punctuation">(</span>fs<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div></section><section aria-labelledby="be_precise_with_glsl_precision_annotations"><a class="dashAnchor" name="//apple_ref/Section/Be%20precise%20with%20GLSL%20precision%20annotations"></a><h2 id="be_precise_with_glsl_precision_annotations"><a href="#be_precise_with_glsl_precision_annotations">Be precise with GLSL precision annotations</a></h2><div class="section-content"><p>If you expect to pass an essl300 <code>int</code> between shaders, and you need it to have 32-bits, you <em>must</em> use <code>highp</code> or you will have portability problems. (Works on Desktop, not on Android)</p>
<p>If you have a float texture, iOS requires that you use <code>highp sampler2D foo;</code>, or it will very painfully give you <code>lowp</code> texture samples! (+/-2.0 max is probably not good enough for you)</p></div></section><section aria-labelledby="implicit_defaults"><h3 id="implicit_defaults"><a href="#implicit_defaults">Implicit defaults</a></h3><div class="section-content"><p>The vertex language has the following predeclared globally scoped default precision statements:</p>
<pre class="notranslate">precision highp float;
precision highp int;
precision lowp sampler2D;
precision lowp samplerCube;
</pre>
<p>The fragment language has the following predeclared globally scoped default precision statements:</p>
<pre class="notranslate">precision mediump int;
precision lowp sampler2D;
precision lowp samplerCube;
</pre></div></section><section aria-labelledby="in_webgl_1_highp_float_support_is_optional_in_fragment_shaders"><h3 id="in_webgl_1_highp_float_support_is_optional_in_fragment_shaders"><a href="#in_webgl_1_highp_float_support_is_optional_in_fragment_shaders">In WebGL 1, "highp float" support is optional in fragment shaders</a></h3><div class="section-content"><p>Using <code>highp</code> precision unconditionally in fragment shaders will prevent your content from working on some older mobile hardware.</p>
<p>While you can use <code>mediump float</code> instead, but be aware that this often results in corrupted rendering due to lack of precision (particularly mobile systems) though the corruption is not going to be visible on a typical desktop computer.</p>
<p>If you know your precision requirements, <code>getShaderPrecisionFormat()</code> will tell you what the system supports.</p>
<p>If <code>highp float</code> is available, <code>GL_FRAGMENT_PRECISION_HIGH</code> will be defined as <code>1</code>.</p>
<p>A good pattern for "always give me the highest precision":</p>
<pre class="notranslate">#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif
</pre></div></section><section aria-labelledby="essl100_minimum_requirements_webgl_1"><h3 id="essl100_minimum_requirements_webgl_1"><a href="#essl100_minimum_requirements_webgl_1">ESSL100 minimum requirements (WebGL 1)</a></h3><div class="section-content"><figure class="table-container"><table>
  <thead>
    <tr>
      <th><code>float</code></th>
      <th>think</th>
      <th>range</th>
      <th>min above zero</th>
      <th>precision</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>highp</code></td>
      <td>float24*</td>
      <td>(-2^62, 2^62)</td>
      <td>2^-62</td>
      <td>2^-16 relative</td>
    </tr>
    <tr>
      <td><code>mediump</code></td>
      <td>IEEE float16</td>
      <td>(-2^14, 2^14)</td>
      <td>2^-14</td>
      <td>2^-10 relative</td>
    </tr>
    <tr>
      <td><code>lowp</code></td>
      <td>10-bit signed fixed</td>
      <td>(-2, 2)</td>
      <td>2^-8</td>
      <td>2^-8 absolute</td>
    </tr>
  </tbody>
</table></figure>
<figure class="table-container"><table>
  <thead>
    <tr>
      <th><code>int</code></th>
      <th>think</th>
      <th>range</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>highp</code></td>
      <td>int17</td>
      <td>(-2^16, 2^16)</td>
    </tr>
    <tr>
      <td><code>mediump</code></td>
      <td>int11</td>
      <td>(-2^10, 2^10)</td>
    </tr>
    <tr>
      <td><code>lowp</code></td>
      <td>int9</td>
      <td>(-2^8, 2^8)</td>
    </tr>
  </tbody>
</table></figure>
<p><em>*float24: sign bit, 7-bit for exponent, 16-bit for mantissa.</em></p></div></section><section aria-labelledby="essl300_minimum_requirements_webgl_2"><h3 id="essl300_minimum_requirements_webgl_2"><a href="#essl300_minimum_requirements_webgl_2">ESSL300 minimum requirements (WebGL 2)</a></h3><div class="section-content"><figure class="table-container"><table>
  <thead>
    <tr>
      <th><code>float</code></th>
      <th>think</th>
      <th>range</th>
      <th>min above zero</th>
      <th>precision</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>highp</code></td>
      <td>IEEE float32</td>
      <td>(-2^126, 2^127)</td>
      <td>2^-126</td>
      <td>2^-24 relative</td>
    </tr>
    <tr>
      <td><code>mediump</code></td>
      <td>IEEE float16</td>
      <td>(-2^14, 2^14)</td>
      <td>2^-14</td>
      <td>2^-10 relative</td>
    </tr>
    <tr>
      <td><code>lowp</code></td>
      <td>10-bit signed fixed</td>
      <td>(-2, 2)</td>
      <td>2^-8</td>
      <td>2^-8 absolute</td>
    </tr>
  </tbody>
</table></figure>
<figure class="table-container"><table>
  <thead>
    <tr>
      <th><code>(u)int</code></th>
      <th>think</th>
      <th><code>int</code> range</th>
      <th><code>unsigned int</code> range</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>highp</code></td>
      <td>(u)int32</td>
      <td>[-2^31, 2^31]</td>
      <td>[0, 2^32]</td>
    </tr>
    <tr>
      <td><code>mediump</code></td>
      <td>(u)int16</td>
      <td>[-2^15, 2^15]</td>
      <td>[0, 2^16]</td>
    </tr>
    <tr>
      <td><code>lowp</code></td>
      <td>(u)int9</td>
      <td>[-2^8, 2^8]</td>
      <td>[0, 2^9]</td>
    </tr>
  </tbody>
</table></figure></div></section><section aria-labelledby="prefer_builtins_instead_of_building_your_own"><a class="dashAnchor" name="//apple_ref/Section/Prefer%20builtins%20instead%20of%20building%20your%20own"></a><h2 id="prefer_builtins_instead_of_building_your_own"><a href="#prefer_builtins_instead_of_building_your_own">Prefer builtins instead of building your own</a></h2><div class="section-content"><p>Prefer builtins like <code>dot</code>, <code>mix</code>, and <code>normalize</code>. At best, custom implementations might run as fast as the builtins they replace, but don't expect them to. Hardware often has hyper-optimized or even specialized instructions for builtins, and the compiler can't reliably replace your custom builtin-replacements with the special builtin codepaths.</p></div></section><section aria-labelledby="use_mipmaps_for_any_texture_youll_see_in_3d"><a class="dashAnchor" name="//apple_ref/Section/Use%20mipmaps%20for%20any%20texture%20you%27ll%20see%20in%203d"></a><h2 id="use_mipmaps_for_any_texture_youll_see_in_3d"><a href="#use_mipmaps_for_any_texture_youll_see_in_3d">Use mipmaps for any texture you'll see in 3d</a></h2><div class="section-content"><p>When in doubt, call <code>generateMipmaps()</code> after texture uploads. Mipmaps are cheap on memory (only 30% overhead) while providing often-large performance advantages when textures are "zoomed out" or generally downscaled in the distance in 3d, or even for cube-maps!</p>
<p>It's quicker to sample from smaller texture images due to better inherent texture fetch cache locality: Zooming out on a non-mipmapped texture ruins texture fetch cache locality, because neighboring pixels no longer sample from neighboring texels!</p>
<p>However, for 2d resources that are never "zoomed out", don't pay the 30% memory surcharge for mipmaps:</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token keyword">const</span> tex <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">createTexture</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
gl<span class="token punctuation">.</span><span class="token function">bindTexture</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">TEXTURE_2D</span><span class="token punctuation">,</span> tex<span class="token punctuation">)</span><span class="token punctuation">;</span>
gl<span class="token punctuation">.</span><span class="token function">texParameterf</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">TEXTURE_2D</span><span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">TEXTURE_MIN_FILTER</span><span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">LINEAR</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Defaults to NEAREST_MIPMAP_LINEAR, for mipmapping!</span>
</code></pre></div>
<p>(In WebGL 2, you should just use <code>texStorage</code> with <code>levels=1</code>)</p>
<p>One caveat: <code>generateMipmaps</code> only works if you would be able to render into the texture if you attached it to a framebuffer. (The spec calls this "color-renderable formats") For example, if a system supports float-textures but not render-to-float, <code>generateMipmaps</code> will fail for float formats.</p></div></section><section aria-labelledby="dont_assume_you_can_render_into_float_textures"><a class="dashAnchor" name="//apple_ref/Section/Don%27t%20assume%20you%20can%20render%20into%20float%20textures"></a><h2 id="dont_assume_you_can_render_into_float_textures"><a href="#dont_assume_you_can_render_into_float_textures">Don't assume you can render into float textures</a></h2><div class="section-content"><p>There are many, many systems that support RGBA32F textures, but if you attach one to a framebuffer you'll get <code>FRAMEBUFFER_INCOMPLETE_ATTACHMENT</code> from <code>checkFramebufferStatus()</code>. It may work on your system, but <em>most</em> mobile systems will not support it!</p>
<p>On WebGL 1, use the <code>EXT_color_buffer_half_float</code> and <code>WEBGL_color_buffer_float</code> extensions to check for render-to-float-texture support for float16 and float32 respectively.</p>
<p>On WebGL 2, <code>EXT_color_buffer_float</code> checks for render-to-float-texture support for both float32 and float16. <code>EXT_color_buffer_half_float</code> is present on systems which only support rendering to float16 textures.</p></div></section><section aria-labelledby="render-to-float32_doesnt_imply_float32-blending!"><h3 id="render-to-float32_doesnt_imply_float32-blending!"><a href="#render-to-float32_doesnt_imply_float32-blending!">Render-to-float32 doesn't imply float32-blending!</a></h3><div class="section-content"><p>It may work on your system, but on many others it won't. Avoid it if you can. Check for the <code>EXT_float_blend</code> extension to check for support.</p>
<p>Float16-blending is always supported.</p></div></section><section aria-labelledby="some_formats_e.g._rgb_may_be_emulated"><a class="dashAnchor" name="//apple_ref/Section/Some%20formats%20%28e%2Eg%2E%20RGB%29%20may%20be%20emulated"></a><h2 id="some_formats_e.g._rgb_may_be_emulated"><a href="#some_formats_e.g._rgb_may_be_emulated">Some formats (e.g. RGB) may be emulated</a></h2><div class="section-content"><p>A number of formats (particularly three-channel formats) are emulated. For example, RGB32F is often actually RGBA32F, and Luminance8 may actually be RGBA8. RGB8 in particular is often surprisingly slow, as masking out the alpha channel and/or patching blend functions has fairly high overhead. Prefer to use RGBA8 and ignore the alpha yourself for better performance.</p></div></section><section aria-labelledby="avoid_alphafalse_which_can_be_expensive"><a class="dashAnchor" name="//apple_ref/Section/Avoid%20alpha%3Afalse%2C%20which%20can%20be%20expensive"></a><h2 id="avoid_alphafalse_which_can_be_expensive"><a href="#avoid_alphafalse_which_can_be_expensive">Avoid alpha:false, which can be expensive</a></h2><div class="section-content"><p>Specifying <code>alpha:false</code> during context creation causes the browser to composite the WebGL-rendered canvas as though it were opaque, ignoring any alpha values the application writes in its fragment shader. On some platforms, this capability unfortunately comes at a significant performance cost. The RGB back buffer may have to be emulated on top of an RGBA surface, and there are relatively few techniques available in the OpenGL API for making it appear to the application that an RGBA surface has no alpha channel. <a href="https://bugs.chromium.org/p/chromium/issues/detail?id=1045643" class="external" target="_blank">It has been found</a> that all of these techniques have approximately equal performance impact on affected platforms.</p>
<p>Most applications, even those requiring alpha blending, can be structured to produce <code>1.0</code> for the alpha channel. The primary exception is any application requiring destination alpha in the blending function. If feasible, it is recommended to do this rather than using <code>alpha:false</code>.</p></div></section><section aria-labelledby="consider_compressed_texture_formats"><a class="dashAnchor" name="//apple_ref/Section/Consider%20compressed%20texture%20formats"></a><h2 id="consider_compressed_texture_formats"><a href="#consider_compressed_texture_formats">Consider compressed texture formats</a></h2><div class="section-content"><p>While JPG and PNG are generally smaller over-the-wire, GPU compressed texture formats are smaller on in GPU memory, and are faster to sample from. (This reduces texture memory bandwidth, which is precious on mobile) However, compressed texture formats have worse quality than JPG, and are generally only acceptable for colors (not e.g. normals or coordinates).</p>
<p>Unfortunately, there's no single universally supported format. Every system has at least one of the following though:</p>
<ul>
  <li>WEBGL_compressed_texture_s3tc (desktop)</li>
  <li>WEBGL_compressed_texture_etc1 (Android)</li>
  <li>WEBGL_compressed_texture_pvrtc (iOS)</li>
</ul>
<p>WebGL 2 has universal support by combining:</p>
<ul>
  <li>WEBGL_compressed_texture_s3tc (desktop)</li>
  <li>WEBGL_compressed_texture_etc (mobile)</li>
</ul>
<p>WEBGL_compressed_texture_astc has both higher quality and/or higher compression, but is only supported on newer hardware.</p></div></section><section aria-labelledby="basis_universal_texture_compression_formatlibrary"><h3 id="basis_universal_texture_compression_formatlibrary"><a href="#basis_universal_texture_compression_formatlibrary">Basis Universal texture compression format/library</a></h3><div class="section-content"><p>Basis Universal solves several of the issues mentioned above. It offers a way to support all common compressed texture formats with a single compressed texture file, through a JavaScript library that efficiently converts formats at load time. It also adds additional compression that makes Basis Universal compressed texture files much smaller than regular compressed textures over-the-wire, more comparable to JPEG.</p>
<p><a href="https://github.com/BinomialLLC/basis_universal/blob/master/webgl/README.md" class="external" target="_blank">https://github.com/BinomialLLC/basis_universal/blob/master/webgl/README.md</a></p></div></section><section aria-labelledby="memory_usage_of_depth_and_stencil_formats"><a class="dashAnchor" name="//apple_ref/Section/Memory%20usage%20of%20depth%20and%20stencil%20formats"></a><h2 id="memory_usage_of_depth_and_stencil_formats"><a href="#memory_usage_of_depth_and_stencil_formats">Memory usage of depth and stencil formats</a></h2><div class="section-content"><p>Depth and stencil attachments and formats are actually inseparable on many devices. You may ask for DEPTH_COMPONENT24 or STENCIL_INDEX8, but you're often getting D24X8 and X24S8 32bpp formats behind the scenes. Assume that the memory usage of depth and stencil formats is rounded up to the nearest four bytes.</p></div></section><section aria-labelledby="teximagetexsubimage_uploads_esp._videos_can_cause_pipeline_flushes"><a class="dashAnchor" name="//apple_ref/Section/texImage%2FtexSubImage%20uploads%20%28esp%2E%20videos%29%20can%20cause%20pipeline%20flushes"></a><h2 id="teximagetexsubimage_uploads_esp._videos_can_cause_pipeline_flushes"><a href="#teximagetexsubimage_uploads_esp._videos_can_cause_pipeline_flushes">texImage/texSubImage uploads (esp. videos) can cause pipeline flushes</a></h2><div class="section-content"><p>Most texture uploads from DOM elements will incur a processing pass that will temporarily switch GL Programs internally, causing a pipeline flush. (Pipelines are formalized explicitly in Vulkan[<a href="https://www.khronos.org/registry/vulkan/specs/1.2/html/chap9.html#VkGraphicsPipelineCreateInfo" class="external" target="_blank">1</a>] et al, but are implicit behind-the-scenes in OpenGL and WebGL. Pipelines are more or less the tuple of shader program, depth/stencil/multisample/blend/rasterization state)</p>
<p>In WebGL:</p>
<pre class="notranslate">    …
    useProgram(prog1)
&lt;pipeline flush&gt;
    bindFramebuffer(target)
    drawArrays()
    bindTexture(webgl_texture)
    texImage2D(HTMLVideoElement)
    drawArrays()
    …
</pre>
<p>Behind the scenes in the browser:</p>
<pre class="notranslate">    …
    useProgram(prog1)
&lt;pipeline flush&gt;
    bindFramebuffer(target)
    drawArrays()
    bindTexture(webgl_texture)
    -texImage2D(HTMLVideoElement):
        +useProgram(_internal_tex_transform_prog)
&lt;pipeline flush&gt;
        +bindFramebuffer(webgl_texture._internal_framebuffer)
        +bindTexture(HTMLVideoElement._internal_video_tex)
        +drawArrays() // y-flip/colorspace-transform/alpha-(un)premultiply
        +bindTexture(webgl_texture)
        +bindFramebuffer(target)
        +useProgram(prog1)
&lt;pipeline flush&gt;
    drawArrays()
    …
</pre>
<p>Prefer doing uploads before starting drawing, or at least between pipelines:</p>
<p>In WebGL:</p>
<pre class="notranslate">    …
    bindTexture(webgl_texture)
    texImage2D(HTMLVideoElement)
    useProgram(prog1)
&lt;pipeline flush&gt;
    bindFramebuffer(target)
    drawArrays()
    bindTexture(webgl_texture)
    drawArrays()
    …
</pre>
<p>Behind the scenes in the browser:</p>
<pre class="notranslate">    …
    bindTexture(webgl_texture)
    -texImage2D(HTMLVideoElement):
        +useProgram(_internal_tex_transform_prog)
&lt;pipeline flush&gt;
        +bindFramebuffer(webgl_texture._internal_framebuffer)
        +bindTexture(HTMLVideoElement._internal_video_tex)
        +drawArrays() // y-flip/colorspace-transform/alpha-(un)premultiply
        +bindTexture(webgl_texture)
        +bindFramebuffer(target)
    useProgram(prog1)
&lt;pipeline flush&gt;
    bindFramebuffer(target)
    drawArrays()
    bindTexture(webgl_texture)
    drawArrays()
    …
</pre></div></section><section aria-labelledby="use_texstorage_to_create_textures"><a class="dashAnchor" name="//apple_ref/Section/Use%20texStorage%20to%20create%20textures"></a><h2 id="use_texstorage_to_create_textures"><a href="#use_texstorage_to_create_textures">Use texStorage to create textures</a></h2><div class="section-content"><p>The WebGL 2.0 <code>texImage*</code> API lets you define each mip level independently and at any size, even the mis-matching mips sizes are not an error until draw time which means there is no way the driver can actually prepare the texture in GPU memory until the first time the texture is drawn.</p>
<p>Further, some drivers might unconditionally allocate the whole mip-chain (+30% memory!) even if you only want a single level.</p>
<p>So, prefer <code>texStorage</code>+<code>texSubImage</code> for textures in WebGL 2</p></div></section><section aria-labelledby="use_invalidateframebuffer"><a class="dashAnchor" name="//apple_ref/Section/Use%20invalidateFramebuffer"></a><h2 id="use_invalidateframebuffer"><a href="#use_invalidateframebuffer">Use invalidateFramebuffer</a></h2><div class="section-content"><p>Storing data that you won't use again can have high cost, particularly on tiled-rendering GPUs common on mobile. When you're done with the contents of a framebuffer attachment, use WebGL 2.0's <code>invalidateFramebuffer</code> to discard the data, instead of leaving the driver to waste time storing the data for later use. DEPTH/STENCIL and/or multisampled attachments in particular are great candidates for <code>invalidateFramebuffer</code>.</p></div></section><section aria-labelledby="use_non-blocking_async_data_readback"><a class="dashAnchor" name="//apple_ref/Section/Use%20non%2Dblocking%20async%20data%20readback"></a><h2 id="use_non-blocking_async_data_readback"><a href="#use_non-blocking_async_data_readback">Use non-blocking async data readback</a></h2><div class="section-content"><p>Operations like <code>readPixels</code> and <code>getBufferSubData</code> are typically synchronous, but using the same APIs, non-blocking, asynchronous data readback can be achieved. The approach in WebGL 2 is analogous to the approach in OpenGL: <a href="https://kdashg.github.io/misc/async-gpu-downloads.html" class="external" target="_blank">Async downloads in blocking APIs</a></p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token keyword">function</span> <span class="token function">clientWaitAsync</span><span class="token punctuation">(</span><span class="token parameter">gl<span class="token punctuation">,</span> sync<span class="token punctuation">,</span> flags<span class="token punctuation">,</span> interval_ms</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> res <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">clientWaitSync</span><span class="token punctuation">(</span>sync<span class="token punctuation">,</span> flags<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>res <span class="token operator">===</span> gl<span class="token punctuation">.</span><span class="token constant">WAIT_FAILED</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">reject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>res <span class="token operator">===</span> gl<span class="token punctuation">.</span><span class="token constant">TIMEOUT_EXPIRED</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span>test<span class="token punctuation">,</span> interval_ms<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getBufferSubDataAsync</span><span class="token punctuation">(</span>
  gl<span class="token punctuation">,</span>
  target<span class="token punctuation">,</span>
  buffer<span class="token punctuation">,</span>
  srcByteOffset<span class="token punctuation">,</span>
  dstBuffer<span class="token punctuation">,</span>
  <span class="token comment">/* optional */</span> dstOffset<span class="token punctuation">,</span>
  <span class="token comment">/* optional */</span> length
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> sync <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">fenceSync</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">SYNC_GPU_COMMANDS_COMPLETE</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">await</span> <span class="token function">clientWaitAsync</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> sync<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">deleteSync</span><span class="token punctuation">(</span>sync<span class="token punctuation">)</span><span class="token punctuation">;</span>

  gl<span class="token punctuation">.</span><span class="token function">bindBuffer</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">getBufferSubData</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> srcByteOffset<span class="token punctuation">,</span> dstBuffer<span class="token punctuation">,</span> dstOffset<span class="token punctuation">,</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">bindBuffer</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> dest<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">readPixelsAsync</span><span class="token punctuation">(</span><span class="token parameter">gl<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> w<span class="token punctuation">,</span> h<span class="token punctuation">,</span> format<span class="token punctuation">,</span> type<span class="token punctuation">,</span> dest</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> buf <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">createBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">bindBuffer</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">PIXEL_PACK_BUFFER</span><span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">bufferData</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">PIXEL_PACK_BUFFER</span><span class="token punctuation">,</span> dest<span class="token punctuation">.</span>byteLength<span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">STREAM_READ</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">readPixels</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> w<span class="token punctuation">,</span> h<span class="token punctuation">,</span> format<span class="token punctuation">,</span> type<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  gl<span class="token punctuation">.</span><span class="token function">bindBuffer</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">PIXEL_PACK_BUFFER</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">await</span> <span class="token function">getBufferSubDataAsync</span><span class="token punctuation">(</span>gl<span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">PIXEL_PACK_BUFFER</span><span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> dest<span class="token punctuation">)</span><span class="token punctuation">;</span>

  gl<span class="token punctuation">.</span><span class="token function">deleteBuffer</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> dest<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div></section><section aria-labelledby="devicepixelratio_and_high-dpi_rendering"><h3 id="devicepixelratio_and_high-dpi_rendering"><a href="#devicepixelratio_and_high-dpi_rendering"><code>devicePixelRatio</code> and high-dpi rendering</a></h3><div class="section-content"><p>Handling <code>devicePixelRatio !== 1.0</code> is tricky. While the common approach is to set <code>canvas.width = width * devicePixelRatio</code>, this will cause moire artifacts with non-integer values of <code>devicePixelRatio</code>, as is common with UI scaling on Windows, as well as zooming on all platforms.</p>
<p>Instead, we can use non-integer values for CSS's <code>top</code>/<code>bottom</code>/<code>left</code>/<code>right</code> to fairly reliably 'pre-snap' our canvas to whole integer device coordinates.</p>
<p>Demo: <a href="https://kdashg.github.io/misc/webgl/device-pixel-presnap.html" class="external" target="_blank">Device pixel presnap</a></p></div></section><section aria-labelledby="resizeobserver_and_device-pixel-content-box"><h3 id="resizeobserver_and_device-pixel-content-box"><a href="#resizeobserver_and_device-pixel-content-box">ResizeObserver and 'device-pixel-content-box'</a></h3><div class="section-content"><p>On supporting browsers (Chromium?), <code>ResizeObserver</code> can be used with <code>'device-pixel-content-box'</code> to request a callback that includes the true device pixel size of an element. This can be used to build an async-but-accurate function:</p>
<div class="code-example"><pre class="brush: js notranslate"><code>window<span class="token punctuation">.</span>getDevicePixelSize <span class="token operator">=</span>
  window<span class="token punctuation">.</span>getDevicePixelSize <span class="token operator">||</span>
  <span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">elem</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">fn_resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> observer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ResizeObserver</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">entries</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> cur <span class="token keyword">of</span> entries<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">const</span> dev_size <span class="token operator">=</span> cur<span class="token punctuation">.</span>devicePixelContentBoxSize<span class="token punctuation">;</span>
          <span class="token keyword">const</span> ret <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">width</span><span class="token operator">:</span> dev_size<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>inlineSize<span class="token punctuation">,</span>
            <span class="token literal-property property">height</span><span class="token operator">:</span> dev_size<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>blockSize<span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">;</span>
          <span class="token function">fn_resolve</span><span class="token punctuation">(</span>ret<span class="token punctuation">)</span><span class="token punctuation">;</span>
          observer<span class="token punctuation">.</span><span class="token function">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">throw</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">device-pixel-content-box not observed for elem </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>elem<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      observer<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>elem<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">box</span><span class="token operator">:</span> <span class="token string">"device-pixel-content-box"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>Please refer to <a href="https://www.w3.org/TR/resize-observer/#resize-observer-interface" class="external" target="_blank">the specification</a> for more details.</p></div></section><section aria-labelledby="imagebitmap_creation"><a class="dashAnchor" name="//apple_ref/Section/ImageBitmap%20creation"></a><h2 id="imagebitmap_creation"><a href="#imagebitmap_creation">ImageBitmap creation</a></h2><div class="section-content"><p>Using the <a href="https://html.spec.whatwg.org/multipage/imagebitmap-and-animations.html#imagebitmapoptions" class="external" target="_blank">ImageBitmapOptions dictionary</a> is essential for properly preparing textures for upload to WebGL, but unfortunately there's no obvious way to query exactly which dictionary members are supported by a given browser.</p>
<p><a href="https://jsfiddle.net/ptkyewhx/" class="external" target="_blank">This JSFiddle</a> illustrates how to determine which dictionary members a given browser supports.</p></div></section><aside class="metadata"><div class="metadata-content-container"><div id="on-github" class="on-github"><h3>Found a content problem with this page?</h3><ul><li>Edit the page <a href="https://github.com/mdn/content/edit/main/files/en-us/web/api/webgl_api/webgl_best_practices/index.md" title="This will take you to GitHub, where you'll need to sign in first." target="_blank" rel="noopener noreferrer">on GitHub</a>.</li><li>Report the <a href="https://github.com/mdn/content/issues/new?template=page-report.yml&amp;mdn-url=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FWebGL_API%2FWebGL_best_practices&amp;metadata=%3C%21--+Do+not+make+changes+below+this+line+--%3E%0A%3Cdetails%3E%0A%3Csummary%3EPage+report+details%3C%2Fsummary%3E%0A%0A*+Folder%3A+%60en-us%2Fweb%2Fapi%2Fwebgl_api%2Fwebgl_best_practices%60%0A*+MDN+URL%3A+https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FWebGL_API%2FWebGL_best_practices%0A*+GitHub+URL%3A+https%3A%2F%2Fgithub.com%2Fmdn%2Fcontent%2Fblob%2Fmain%2Ffiles%2Fen-us%2Fweb%2Fapi%2Fwebgl_api%2Fwebgl_best_practices%2Findex.md%0A*+Last+commit%3A+https%3A%2F%2Fgithub.com%2Fmdn%2Fcontent%2Fcommit%2F65cd9754ed95f116b641c68cad80f14ecf580b41%0A*+Document+last+modified%3A+2023-01-21T12%3A18%3A52.000Z%0A%0A%3C%2Fdetails%3E" title="This will take you to GitHub to file a new issue." target="_blank" rel="noopener noreferrer">content issue</a>.</li><li>View the source <a href="https://github.com/mdn/content/blob/main/files/en-us/web/api/webgl_api/webgl_best_practices/index.md?plain=1" title="Folder: en-us/web/api/webgl_api/webgl_best_practices (Opens in a new tab)" target="_blank" rel="noopener noreferrer">on GitHub</a>.</li></ul>Want to get more involved? Learn<!-- --> <a href="https://github.com/mdn/content/blob/main/CONTRIBUTING.md" title="This will take you to our contribution guidelines on GitHub." target="_blank" rel="noopener noreferrer">how to contribute</a>.</div><p class="last-modified-date">This page was last modified on<!-- --> <time datetime="2023-01-21T12:18:52.000Z">Jan 21, 2023</time> by<!-- --> <a href="WebGL_best_practices/contributors.txt">MDN contributors</a>.</p></div></aside></article></main></div><footer id="nav-footer" class="page-footer"><div><a href="http://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/WebGL_best_practices">WebGL best practices</a> by <a href="http://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/WebGL_best_practices$history">Mozilla Contributors</a> is licensed under <a href="http://creativecommons.org/licenses/by-sa/2.5/">CC-BY-SA 2.5</a>.</div></footer></div></div><script type="application/json" id="hydration">{"doc":{"isMarkdown":true,"isTranslated":false,"isActive":true,"flaws":{},"title":"WebGL best practices","mdn_url":"/en-US/docs/Web/API/WebGL_API/WebGL_best_practices","locale":"en-US","native":"English (US)","sidebarHTML":"<ol><li><strong><a href=\"/en-US/docs/Web/API/WebGL_API\">WebGL API</a></strong></li><li class=\"toggle\"><details open=\"\"><summary>Guides</summary><ol><li><a href=\"/en-US/docs/Web/API/WebGL_API/Constants\">WebGL constants</a></li><li><a href=\"/en-US/docs/Web/API/WebGL_API/Types\">WebGL types</a></li><li><a href=\"/en-US/docs/Web/API/WebGL_API/WebGL_model_view_projection\">WebGL model view projection</a></li><li><em><a href=\"/en-US/docs/Web/API/WebGL_API/WebGL_best_practices\" aria-current=\"page\">WebGL best practices</a></em></li><li><a href=\"/en-US/docs/Web/API/WebGL_API/By_example\">WebGL by example</a></li><li><a href=\"/en-US/docs/Web/API/WebGL_API/Basic_2D_animation_example\">A basic 2D WebGL animation example</a></li><li><a href=\"/en-US/docs/Web/API/WebGL_API/Compressed_texture_formats\">Compressed texture formats</a></li><li><a href=\"/en-US/docs/Web/API/WebGL_API/Data\">Data in WebGL</a></li><li><a href=\"/en-US/docs/Web/API/WebGL_API/Matrix_math_for_the_web\">Matrix math for the web</a></li><li><a href=\"/en-US/docs/Web/API/WebGL_API/Using_Extensions\">Using WebGL extensions</a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Tutorial</summary><ol><li><a href=\"/en-US/docs/Web/API/WebGL_API/Tutorial\">WebGL tutorial</a></li><li><a href=\"/en-US/docs/Web/API/WebGL_API/Tutorial/Getting_started_with_WebGL\">Getting started with WebGL</a></li><li><a href=\"/en-US/docs/Web/API/WebGL_API/Tutorial/Adding_2D_content_to_a_WebGL_context\">Adding 2D content to a WebGL context</a></li><li><a href=\"/en-US/docs/Web/API/WebGL_API/Tutorial/Using_shaders_to_apply_color_in_WebGL\">Using shaders to apply color in WebGL</a></li><li><a href=\"/en-US/docs/Web/API/WebGL_API/Tutorial/Animating_objects_with_WebGL\">Animating objects with WebGL</a></li><li><a href=\"/en-US/docs/Web/API/WebGL_API/Tutorial/Creating_3D_objects_using_WebGL\">Creating 3D objects using WebGL</a></li><li><a href=\"/en-US/docs/Web/API/WebGL_API/Tutorial/Using_textures_in_WebGL\">Using textures in WebGL</a></li><li><a href=\"/en-US/docs/Web/API/WebGL_API/Tutorial/Lighting_in_WebGL\">Lighting in WebGL</a></li><li><a href=\"/en-US/docs/Web/API/WebGL_API/Tutorial/Animating_textures_in_WebGL\">Animating textures in WebGL</a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Interfaces</summary><ol><li><a href=\"/en-US/docs/Web/API/WebGLRenderingContext\"><code>WebGLRenderingContext</code></a></li><li><a href=\"/en-US/docs/Web/API/WebGLBuffer\"><code>WebGLBuffer</code></a></li><li><a href=\"/en-US/docs/Web/API/WebGLFramebuffer\"><code>WebGLFramebuffer</code></a></li><li><a href=\"/en-US/docs/Web/API/WebGLRenderbuffer\"><code>WebGLRenderbuffer</code></a></li><li><a href=\"/en-US/docs/Web/API/WebGLObject\"><code>WebGLObject</code></a></li><li><a href=\"/en-US/docs/Web/API/WebGLProgram\"><code>WebGLProgram</code></a></li><li><a href=\"/en-US/docs/Web/API/WebGLShader\"><code>WebGLShader</code></a></li><li><a href=\"/en-US/docs/Web/API/WebGLTexture\"><code>WebGLTexture</code></a></li><li><a href=\"/en-US/docs/Web/API/WebGLUniformLocation\"><code>WebGLUniformLocation</code></a></li><li><a href=\"/en-US/docs/Web/API/WebGLActiveInfo\"><code>WebGLActiveInfo</code></a></li><li><a href=\"/en-US/docs/Web/API/WebGLShaderPrecisionFormat\"><code>WebGLShaderPrecisionFormat</code></a></li><li><a href=\"/en-US/docs/Web/API/WebGLContextEvent\"><code>WebGLContextEvent</code></a></li><li><a href=\"/en-US/docs/Web/API/WebGLQuery\"><code>WebGLQuery</code></a></li><li><a href=\"/en-US/docs/Web/API/WebGLSampler\"><code>WebGLSampler</code></a></li><li><a href=\"/en-US/docs/Web/API/WebGLSync\"><code>WebGLSync</code></a></li><li><a href=\"/en-US/docs/Web/API/WebGLTransformFeedback\"><code>WebGLTransformFeedback</code></a></li><li><a href=\"/en-US/docs/Web/API/WebGLVertexArrayObject\"><code>WebGLVertexArrayObject</code></a></li><li><a href=\"/en-US/docs/Web/API/WebGL2RenderingContext\"><code>WebGL2RenderingContext</code></a></li><li><a href=\"/en-US/docs/Web/API/WEBGL_compressed_texture_s3tc\"><code>WEBGL_compressed_texture_s3tc</code></a></li><li><a href=\"/en-US/docs/Web/API/WEBGL_compressed_texture_s3tc_srgb\"><code>WEBGL_compressed_texture_s3tc_srgb</code></a></li><li><a href=\"/en-US/docs/Web/API/WEBGL_compressed_texture_etc1\"><code>WEBGL_compressed_texture_etc1</code></a></li><li><a href=\"/en-US/docs/Web/API/WEBGL_compressed_texture_pvrtc\"><code>WEBGL_compressed_texture_pvrtc</code></a></li><li><a href=\"/en-US/docs/Web/API/WEBGL_debug_renderer_info\"><code>WEBGL_debug_renderer_info</code></a></li><li><a href=\"/en-US/docs/Web/API/WEBGL_debug_shaders\"><code>WEBGL_debug_shaders</code></a></li><li><a href=\"/en-US/docs/Web/API/WEBGL_depth_texture\"><code>WEBGL_depth_texture</code></a></li><li><a href=\"/en-US/docs/Web/API/OES_element_index_uint\"><code>OES_element_index_uint</code></a></li><li><a href=\"/en-US/docs/Web/API/EXT_frag_depth\"><code>EXT_frag_depth</code></a></li><li><a href=\"/en-US/docs/Web/API/WEBGL_lose_context\"><code>WEBGL_lose_context</code></a></li><li><a href=\"/en-US/docs/Web/API/EXT_texture_filter_anisotropic\"><code>EXT_texture_filter_anisotropic</code></a></li><li><a href=\"/en-US/docs/Web/API/EXT_sRGB\"><code>EXT_sRGB</code></a></li><li><a href=\"/en-US/docs/Web/API/OES_standard_derivatives\"><code>OES_standard_derivatives</code></a></li><li><a href=\"/en-US/docs/Web/API/OES_texture_float\"><code>OES_texture_float</code></a></li><li><a href=\"/en-US/docs/Web/API/WEBGL_draw_buffers\"><code>WEBGL_draw_buffers</code></a></li><li><a href=\"/en-US/docs/Web/API/OES_texture_float_linear\"><code>OES_texture_float_linear</code></a></li><li><a href=\"/en-US/docs/Web/API/EXT_shader_texture_lod\"><code>EXT_shader_texture_lod</code></a></li><li><a href=\"/en-US/docs/Web/API/OES_texture_half_float\"><code>OES_texture_half_float</code></a></li><li><a href=\"/en-US/docs/Web/API/OES_texture_half_float_linear\"><code>OES_texture_half_float_linear</code></a></li><li><a href=\"/en-US/docs/Web/API/WEBGL_color_buffer_float\"><code>WEBGL_color_buffer_float</code></a></li><li><a href=\"/en-US/docs/Web/API/EXT_color_buffer_half_float\"><code>EXT_color_buffer_half_float</code></a></li><li><a href=\"/en-US/docs/Web/API/OES_vertex_array_object\"><code>OES_vertex_array_object</code></a></li><li><a href=\"/en-US/docs/Web/API/ANGLE_instanced_arrays\"><code>ANGLE_instanced_arrays</code></a></li><li><a href=\"/en-US/docs/Web/API/EXT_blend_minmax\"><code>EXT_blend_minmax</code></a></li><li><a href=\"/en-US/docs/Web/API/EXT_disjoint_timer_query\"><code>EXT_disjoint_timer_query</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Events</summary><ol><li><a href=\"/en-US/docs/Web/API/HTMLCanvasElement/webglcontextcreationerror_event\"><code>HTMLCanvasElement</code>: <code>webglcontextcreationerror</code></a></li><li><a href=\"/en-US/docs/Web/API/HTMLCanvasElement/webglcontextlost_event\"><code>HTMLCanvasElement</code>: <code>webglcontextlost</code></a></li><li><a href=\"/en-US/docs/Web/API/HTMLCanvasElement/webglcontextrestored_event\"><code>HTMLCanvasElement</code>: <code>webglcontextrestored</code></a></li></ol></details></li></ol>","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p>WebGL is a complicated API, and it's often not obvious what the recommended ways to use it are. This page tackles recommendations across the spectrum of expertise, and not only highlights dos and don'ts, but also details <em>why</em>. You can rely on this document to guide your choice of approach, and ensure you're on the right track no matter what browser or hardware your users run.</p>"}},{"type":"prose","value":{"id":"address_and_eliminate_webgl_errors","title":"Address and eliminate WebGL errors","isH3":false,"content":"<p>Your application should run without generating any WebGL errors (as returned by <code>getError</code>). Every WebGL error is reported in the Web Console as a JavaScript warning with a descriptive message. After too many errors (32 in Firefox), WebGL stops generating descriptive messages, which really hinders debugging.</p>\n<p>The <em>only</em> errors a well-formed page generates are <code>OUT_OF_MEMORY</code> and <code>CONTEXT_LOST</code>.</p>"}},{"type":"prose","value":{"id":"understand_extension_availability","title":"Understand extension availability","isH3":false,"content":"<p>The availability of most WebGL extensions depends on the client system. When using WebGL extensions, if possible, try to make them optional by gracefully adapting to the case there they are not supported.</p>\n<p>These WebGL 1 extensions are universally supported, and can be relied upon to be present:</p>\n<ul>\n  <li>ANGLE_instanced_arrays</li>\n  <li>EXT_blend_minmax</li>\n  <li>OES_element_index_uint</li>\n  <li>OES_standard_derivatives</li>\n  <li>OES_vertex_array_object</li>\n  <li>WEBGL_debug_renderer_info</li>\n  <li>WEBGL_lose_context</li>\n</ul>\n<p><em>(see also: <a href=\"https://kdashg.github.io/misc/webgl/webgl-feature-levels.html\" class=\"external\" target=\"_blank\">WebGL feature levels and % support</a>)</em></p>\n<p>Consider polyfilling these into WebGLRenderingContext, like: <a href=\"https://github.com/kdashg/misc/blob/tip/webgl/webgl-v1.1.js\" class=\"external\" target=\"_blank\">https://github.com/kdashg/misc/blob/tip/webgl/webgl-v1.1.js</a></p>"}},{"type":"prose","value":{"id":"understand_system_limits","title":"Understand system limits","isH3":false,"content":"<p>Similarly to extensions, the limits of your system will be different than your clients' systems! Don't assume you can use thirty texture samplers per shader just because it works on your machine!</p>\n<p>The minimum requirements for WebGL are quite low. In practice, effectively all systems support at least the following:</p>\n<pre class=\"notranslate\">MAX_CUBE_MAP_TEXTURE_SIZE: 4096\nMAX_RENDERBUFFER_SIZE: 4096\nMAX_TEXTURE_SIZE: 4096\nMAX_VIEWPORT_DIMS: [4096,4096]\nMAX_VERTEX_TEXTURE_IMAGE_UNITS: 4\nMAX_TEXTURE_IMAGE_UNITS: 8\nMAX_COMBINED_TEXTURE_IMAGE_UNITS: 8\nMAX_VERTEX_ATTRIBS: 16\nMAX_VARYING_VECTORS: 8\nMAX_VERTEX_UNIFORM_VECTORS: 128\nMAX_FRAGMENT_UNIFORM_VECTORS: 64\nALIASED_POINT_SIZE_RANGE: [1,100]\n</pre>\n<p>Your desktop may support 16k textures, or maybe 16 texture units in the vertex shader, but most other systems don't, and content that works for you will not work for them!</p>"}},{"type":"prose","value":{"id":"avoid_invalidating_fbo_attachment_bindings","title":"Avoid invalidating FBO attachment bindings","isH3":false,"content":"<p>Almost any change to an FBO's attachment bindings will invalidate its framebuffer completeness. Set up your hot framebuffers ahead of time.</p>\n<p>In Firefox, setting the pref <code>webgl.perf.max-warnings</code> to <code>-1</code> in about:config will enable performance warnings that include warnings about FB completeness invalidations.</p>"}},{"type":"prose","value":{"id":"avoid_changing_vao_attachments_vertexattribpointer_disableenablevertexattribarray","title":"Avoid changing VAO attachments (vertexAttribPointer, disable/enableVertexAttribArray)","isH3":true,"content":"<p>Drawing from static, unchanging VAOs is faster than mutating the same VAO for every draw call. For unchanged VAOs, browsers can cache the fetch limits, whereas when VAOs change, browsers must revalidate and recalculate limits. The overhead for this is relatively low, but re-using VAOs means fewer <code>vertexAttribPointer</code> calls too, so it's worth doing wherever it's easy.</p>"}},{"type":"prose","value":{"id":"delete_objects_eagerly","title":"Delete objects eagerly","isH3":false,"content":"<p>Don't wait for the garbage collector/cycle collector to realize objects are orphaned and destroy them. Implementations track the liveness of objects, so 'deleting' them at the API level only releases the handle that refers to the actual object. (conceptually releasing the handle's ref-pointer to the object) Only once the object is unused in the implementation is it actually freed. For example, if you never want to access your shader objects directly again, just delete their handles after attaching them to a program object.</p>"}},{"type":"prose","value":{"id":"lose_contexts_eagerly","title":"Lose contexts eagerly","isH3":false,"content":"<p>Consider also eagerly losing WebGL contexts via the <code>WEBGL_lose_context</code> extension when you're definitely done with them and no longer need the target canvas's rendering results. Note that this is not necessary to do when navigating away from a page - don't add an unload event handler just for this purpose.</p>"}},{"type":"prose","value":{"id":"flush_when_expecting_results","title":"Flush when expecting results","isH3":false,"content":"<p>Call <code>flush()</code> when expecting results such as queries, or at completion of a rendering frame.</p>\n<p>Flush tells the implementation to push all pending commands out for execution, flushing them out of the queue, instead of waiting for more commands to enqueue before sending for execution.</p>\n<p>For example, it is possible for the following to never complete without context loss:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>sync <span class=\"token operator\">=</span> <span class=\"token function\">glFenceSync</span><span class=\"token punctuation\">(</span><span class=\"token constant\">GL_SYNC_GPU_COMMANDS_COMPLETE</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">glClientWaitSync</span><span class=\"token punctuation\">(</span>sync<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">GL_TIMEOUT_IGNORED</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>WebGL doesn't have a SwapBuffers call by default, so a flush can help fill the gap, as well.</p>"}},{"type":"prose","value":{"id":"use_webgl.flush_when_not_using_requestanimationframe","title":"Use <code>webgl.flush()</code> when not using requestAnimationFrame","isH3":true,"content":"<p>When not using RAF, (such as when using RPAF; see below) use <code>webgl.flush()</code> to encourage eager execution of enqueued commands.</p>\n<p>Because RAF is directly followed by the frame boundary, an explicit <code>webgl.flush()</code> isn't really needed with RAF.</p>","titleAsText":"Use webgl.flush() when not using requestAnimationFrame"}},{"type":"prose","value":{"id":"avoid_blocking_api_calls_in_production","title":"Avoid blocking API calls in production","isH3":false,"content":"<p>Certain WebGL entry points - including <code>getError</code> and <code>getParameter</code> - cause synchronous stalls on the calling thread. Even basic requests can take as long as 1ms, but they can take even longer if they need to wait for all graphics work to be completed (with an effect similar to <code>glFinish()</code> in native OpenGL).</p>\n<p>In production code, avoid such entry points, especially on the browser main thread where they can cause the entire page to jank (often including scrolling or even the whole browser).</p>\n<ul>\n  <li>\n    <code>getError()</code>: causes a flush + round-trip to fetch errors from the GPU process).\n    For example, within Firefox, the only time glGetError is checked is after allocations (<code>bufferData</code>, <code>*texImage*</code>, <code>texStorage*</code>) to pick up any GL_OUT_OF_MEMORY errors.\n  </li>\n  <li><code>getShader/ProgramParameter()</code>, <code>getShader/ProgramInfoLog()</code>, other <code>get</code>s on shaders/programs: flush + shader compile + round-trip, if not done after shader compilation is complete. (See also <a href=\"#compile_shaders_and_link_programs_in_parallel\">parallel shader compilation</a> below.)</li>\n  <li><code>get*Parameter()</code> in general: possible flush + round-trip. In some cases, these will be cached to avoid the round-trip, but try to avoid relying on this.</li>\n  <li><code>checkFramebufferStatus()</code>: possible flush + round-trip.</li>\n  <li><code>getBufferSubData()</code>: usual finish + round-trip. (This is okay for READ buffers in conjunction with fences - see <a href=\"#non-blocking_async_data_downloadreadback\">async data readback</a> below.)</li>\n  <li><code>readPixels()</code> to the CPU (i.e. without an UNPACK buffer bound): finish + round-trip. Instead, use GPU-GPU <code>readPixels</code> in conjunction with async data readback.</li>\n</ul>"}},{"type":"prose","value":{"id":"always_enable_vertex_attrib_0_as_an_array","title":"Always enable vertex attrib 0 as an array","isH3":false,"content":"<p>If you draw without vertex attrib 0 enabled as an array, you will force the browser to do complicated emulation when running on desktop OpenGL (such as on macOS). This is because in desktop OpenGL, nothing gets drawn if vertex attrib 0 is not array-enabled. You can use <code>bindAttribLocation</code> to force a vertex attribute to use location 0, and use <code>enableVertexAttribArray(0)</code> to make it array-enabled.</p>"}},{"type":"prose","value":{"id":"estimate_a_per-pixel_vram_budget","title":"Estimate a per-pixel VRAM Budget","isH3":false,"content":"<p>WebGL doesn't offer APIs to query the maximum amount of video memory on the system because such queries are not portable. Still, applications must be conscious of VRAM usage and not just allocate as much as possible.</p>\n<p>One technique pioneered by the Google Maps team is the notion of a <em>per-pixel VRAM budget</em>:</p>\n<p>1) For one system (e.g. a particular desktop / laptop), decide the maximum amount of VRAM your application should use. 2) Compute the number of pixels covered by a maximized browser window. E.g. <code>(window.innerWidth * devicePixelRatio) * (window.innerHeight * window.devicePixelRatio)</code> 3) The per-pixel VRAM budget is (1) divided by (2), and is a constant.</p>\n<p>This constant should <em>generally</em> be portable among systems. Mobile devices typically have smaller screens than powerful desktop machines with large monitors. Re-compute this constant on a few target systems to get a reliable estimate.</p>\n<p>Now adjust all internal caching in the application (WebGLBuffers, WebGLTextures, etc.) to obey a maximum size, computed by this constant multiplied by the number of pixels covered by the <em>current</em> browser window. This requires estimating the number of bytes consumed by each texture, for example. The cap also must typically be updated as the browser window resizes, and older resources above the limit must be purged.</p>\n<p>Keeping the application's VRAM usage under this cap will help to avoid out-of-memory errors and associated instability.</p>"}},{"type":"prose","value":{"id":"consider_rendering_to_a_smaller_back_buffer","title":"Consider rendering to a smaller back buffer","isH3":false,"content":"<p>A common (and easy) way to trade off quality for speed is rendering into a smaller back buffer, and upscaling the result. Consider reducing canvas.width and height and keeping canvas.style.width and height at a constant size.</p>"}},{"type":"prose","value":{"id":"batch_draw_calls","title":"Batch draw calls","isH3":false,"content":"<p>\"Batching\" draw calls into fewer, larger draw calls will generally improve performance. If you have 1000 sprites to paint, try to do it as a single drawArrays() or drawElements() call.</p>\n<p>It's common to use \"degenerate triangles\" if you need to draw discontinuous objects as a single drawArrays(TRIANGLE_STRIP) call. Degenerate triangles are triangles with no area, therefore any triangle where more than one point is in the same exact location. These triangles are effectively skipped, which lets you start a new triangle strip unattached to your previous one, without having to split into multiple draw calls.</p>\n<p>Another important method for batching is texture atlasing, where multiple images are placed into a single texture, often like a checkerboard. Since you need to split draw call batches to change textures, texture atlasing lets you combine more draw calls into fewer, bigger batches. See <a href=\"https://webglsamples.org/sprites/readme.html\" class=\"external\" target=\"_blank\">this example</a> demonstrating how to combine even sprites referencing multiple texture atlases into a single draw call.</p>"}},{"type":"prose","value":{"id":"avoid_ifdef_gl_es","title":"Avoid \"#ifdef GL_ES\"","isH3":false,"content":"<p>You should never use <code>#ifdef GL_ES</code> in your WebGL shaders; this condition is always true in WebGL. Although some early examples used this, it's not necessary.</p>"}},{"type":"prose","value":{"id":"prefer_doing_work_in_the_vertex_shader","title":"Prefer doing work in the vertex shader","isH3":false,"content":"<p>Do as much work as you can in the vertex shader, rather than in the fragment shader. This is because per draw call, fragment shaders generally run many more times than vertex shaders. Any calculation that can be done on the vertices and then just interpolated among fragments (via <code>varying</code>s) is a performance boon. (The interpolation of varyings is very cheap, and is done automatically for you through the fixed functionality rasterization phase of the graphics pipeline.)</p>\n<p>For example, a simple animation of a textured surface can be achieved through a time-dependent transformation of texture coordinates. (The simplest case being adding a uniform vector to the texture coordinates attribute vector) If visually acceptable, one can transform the texture coordinates in the vertex shader rather than in the fragment shader, to get better performance.</p>\n<p>One common trade-off is to some lighting calculations per-vertex instead of per-fragment (pixel). In some cases, especially with simple models or dense vertices, this looks good enough.</p>\n<p>The inversion of this is if a model has more vertices than pixels in the rendered output. However, LOD meshes is usually the answer to this problem, rarely moving work from the vertex <em>to</em> the fragment shader.</p>"}},{"type":"prose","value":{"id":"compile_shaders_and_link_programs_in_parallel","title":"Compile Shaders and Link Programs in parallel","isH3":false,"content":"<p>It's tempting to compile shaders and link programs serially, but many browsers can compile and link in parallel on background threads.</p>\n<p>Instead of:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">function</span> <span class=\"token function\">compileOnce</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">gl<span class=\"token punctuation\">,</span> shader</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>shader<span class=\"token punctuation\">.</span>compiled<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n  gl<span class=\"token punctuation\">.</span><span class=\"token function\">compileShader</span><span class=\"token punctuation\">(</span>shader<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  shader<span class=\"token punctuation\">.</span>compiled <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>vs<span class=\"token punctuation\">,</span> fs<span class=\"token punctuation\">,</span> prog<span class=\"token punctuation\">]</span> <span class=\"token keyword\">of</span> programs<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">compileOnce</span><span class=\"token punctuation\">(</span>gl<span class=\"token punctuation\">,</span> vs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">compileOnce</span><span class=\"token punctuation\">(</span>gl<span class=\"token punctuation\">,</span> fs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  gl<span class=\"token punctuation\">.</span><span class=\"token function\">linkProgram</span><span class=\"token punctuation\">(</span>prog<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>gl<span class=\"token punctuation\">.</span><span class=\"token function\">getProgramParameter</span><span class=\"token punctuation\">(</span>prog<span class=\"token punctuation\">,</span> gl<span class=\"token punctuation\">.</span><span class=\"token constant\">LINK_STATUS</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Link failed: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>gl<span class=\"token punctuation\">.</span><span class=\"token function\">getProgramInfoLog</span><span class=\"token punctuation\">(</span>prog<span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">vs info-log: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>gl<span class=\"token punctuation\">.</span><span class=\"token function\">getShaderInfoLog</span><span class=\"token punctuation\">(</span>vs<span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">fs info-log: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>gl<span class=\"token punctuation\">.</span><span class=\"token function\">getShaderInfoLog</span><span class=\"token punctuation\">(</span>fs<span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>Consider:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">function</span> <span class=\"token function\">compileOnce</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">gl<span class=\"token punctuation\">,</span> shader</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>shader<span class=\"token punctuation\">.</span>compiled<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n  gl<span class=\"token punctuation\">.</span><span class=\"token function\">compileShader</span><span class=\"token punctuation\">(</span>shader<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  shader<span class=\"token punctuation\">.</span>compiled <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>vs<span class=\"token punctuation\">,</span> fs<span class=\"token punctuation\">,</span> prog<span class=\"token punctuation\">]</span> <span class=\"token keyword\">of</span> programs<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">compileOnce</span><span class=\"token punctuation\">(</span>gl<span class=\"token punctuation\">,</span> vs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">compileOnce</span><span class=\"token punctuation\">(</span>gl<span class=\"token punctuation\">,</span> fs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>vs<span class=\"token punctuation\">,</span> fs<span class=\"token punctuation\">,</span> prog<span class=\"token punctuation\">]</span> <span class=\"token keyword\">of</span> programs<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  gl<span class=\"token punctuation\">.</span><span class=\"token function\">linkProgram</span><span class=\"token punctuation\">(</span>prog<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>vs<span class=\"token punctuation\">,</span> fs<span class=\"token punctuation\">,</span> prog<span class=\"token punctuation\">]</span> <span class=\"token keyword\">of</span> programs<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>gl<span class=\"token punctuation\">.</span><span class=\"token function\">getProgramParameter</span><span class=\"token punctuation\">(</span>prog<span class=\"token punctuation\">,</span> gl<span class=\"token punctuation\">.</span><span class=\"token constant\">LINK_STATUS</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Link failed: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>gl<span class=\"token punctuation\">.</span><span class=\"token function\">getProgramInfoLog</span><span class=\"token punctuation\">(</span>prog<span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">vs info-log: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>gl<span class=\"token punctuation\">.</span><span class=\"token function\">getShaderInfoLog</span><span class=\"token punctuation\">(</span>vs<span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">fs info-log: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>gl<span class=\"token punctuation\">.</span><span class=\"token function\">getShaderInfoLog</span><span class=\"token punctuation\">(</span>fs<span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"prefer_khr_parallel_shader_compile","title":"Prefer KHR_parallel_shader_compile","isH3":false,"content":"<p>While we've described a pattern to allow browsers to compile and link in parallel, normally checking <code>COMPILE_STATUS</code> or <code>LINK_STATUS</code> blocks until the compile or link completes. In browsers where it's available, the <a href=\"https://www.khronos.org/registry/webgl/extensions/KHR_parallel_shader_compile/\" class=\"external\" target=\"_blank\">KHR_parallel_shader_compile</a> extension provides a <em>non-blocking</em> <code>COMPLETION_STATUS</code> query. Prefer to enable and use this extension.</p>\n<p>Example usage:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>ext <span class=\"token operator\">=</span> gl<span class=\"token punctuation\">.</span><span class=\"token function\">getExtension</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"KHR_parallel_shader_compile\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ngl<span class=\"token punctuation\">.</span><span class=\"token function\">compileProgram</span><span class=\"token punctuation\">(</span>vs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ngl<span class=\"token punctuation\">.</span><span class=\"token function\">compileProgram</span><span class=\"token punctuation\">(</span>fs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ngl<span class=\"token punctuation\">.</span><span class=\"token function\">attachShader</span><span class=\"token punctuation\">(</span>prog<span class=\"token punctuation\">,</span> vs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ngl<span class=\"token punctuation\">.</span><span class=\"token function\">attachShader</span><span class=\"token punctuation\">(</span>prog<span class=\"token punctuation\">,</span> fs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ngl<span class=\"token punctuation\">.</span><span class=\"token function\">linkProgram</span><span class=\"token punctuation\">(</span>prog<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Store program in your data structure.</span>\n<span class=\"token comment\">// Later, for example the next frame:</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>ext<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>gl<span class=\"token punctuation\">.</span><span class=\"token function\">getProgramParameter</span><span class=\"token punctuation\">(</span>prog<span class=\"token punctuation\">,</span> ext<span class=\"token punctuation\">.</span><span class=\"token constant\">COMPLETION_STATUS_KHR</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Check program link status; if OK, use and draw with it.</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Program linking is synchronous.</span>\n  <span class=\"token comment\">// Check program link status; if OK, use and draw with it.</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>This technique may not work in all applications, for example those which require programs to be immediately available for rendering. Still, consider how variations may work.</p>"}},{"type":"prose","value":{"id":"dont_check_shader_compile_status_unless_linking_fails","title":"Don't check shader compile status unless linking fails","isH3":false,"content":"<p>There are very few errors that are guaranteed to cause shader compilation failure, but cannot be deferred to link time. The <a href=\"https://www.khronos.org/registry/OpenGL/specs/es/3.0/GLSL_ES_Specification_3.00.pdf\" class=\"external\" target=\"_blank\">ESSL3 spec</a> says this under \"Error Handling\":</p>\n<blockquote>\n  <p>The implementation should report errors as early a possible but in any case must satisfy the following:</p>\n  <ul>\n    <li>All lexical, grammatical and semantic errors must have been detected following a call to glLinkProgram</li>\n    <li>Errors due to mismatch between the vertex and fragment shader (link errors) must have been detected following a call to glLinkProgram</li>\n    <li>Errors due to exceeding resource limits must have been detected following any draw call or a call to glValidateProgram</li>\n    <li>A call to glValidateProgram must report all errors associated with a program object given the current GL state.</li>\n  </ul>\n  <p>The allocation of tasks between the compiler and linker is implementation dependent. Consequently there are many errors which may be detected either at compile or link time, depending on the implementation.</p>\n</blockquote>\n<p>Additionally, querying compile status is a synchronous call, which breaks pipelining.</p>\n<p>Instead of:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>gl<span class=\"token punctuation\">.</span><span class=\"token function\">compileShader</span><span class=\"token punctuation\">(</span>vs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>gl<span class=\"token punctuation\">.</span><span class=\"token function\">getShaderParameter</span><span class=\"token punctuation\">(</span>vs<span class=\"token punctuation\">,</span> gl<span class=\"token punctuation\">.</span><span class=\"token constant\">COMPILE_STATUS</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">vs compile failed: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>gl<span class=\"token punctuation\">.</span><span class=\"token function\">getShaderInfoLog</span><span class=\"token punctuation\">(</span>vs<span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\ngl<span class=\"token punctuation\">.</span><span class=\"token function\">compileShader</span><span class=\"token punctuation\">(</span>fs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>gl<span class=\"token punctuation\">.</span><span class=\"token function\">getShaderParameter</span><span class=\"token punctuation\">(</span>fs<span class=\"token punctuation\">,</span> gl<span class=\"token punctuation\">.</span><span class=\"token constant\">COMPILE_STATUS</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">fs compile failed: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>gl<span class=\"token punctuation\">.</span><span class=\"token function\">getShaderInfoLog</span><span class=\"token punctuation\">(</span>fs<span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\ngl<span class=\"token punctuation\">.</span><span class=\"token function\">linkProgram</span><span class=\"token punctuation\">(</span>prog<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>gl<span class=\"token punctuation\">.</span><span class=\"token function\">getProgramParameter</span><span class=\"token punctuation\">(</span>vs<span class=\"token punctuation\">,</span> gl<span class=\"token punctuation\">.</span><span class=\"token constant\">LINK_STATUS</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Link failed: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>gl<span class=\"token punctuation\">.</span><span class=\"token function\">getProgramInfoLog</span><span class=\"token punctuation\">(</span>prog<span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>Consider:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>gl<span class=\"token punctuation\">.</span><span class=\"token function\">compileShader</span><span class=\"token punctuation\">(</span>vs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ngl<span class=\"token punctuation\">.</span><span class=\"token function\">compileShader</span><span class=\"token punctuation\">(</span>fs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ngl<span class=\"token punctuation\">.</span><span class=\"token function\">linkProgram</span><span class=\"token punctuation\">(</span>prog<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>gl<span class=\"token punctuation\">.</span><span class=\"token function\">getProgramParameter</span><span class=\"token punctuation\">(</span>vs<span class=\"token punctuation\">,</span> gl<span class=\"token punctuation\">.</span><span class=\"token constant\">LINK_STATUS</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Link failed: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>gl<span class=\"token punctuation\">.</span><span class=\"token function\">getProgramInfoLog</span><span class=\"token punctuation\">(</span>prog<span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">vs info-log: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>gl<span class=\"token punctuation\">.</span><span class=\"token function\">getShaderInfoLog</span><span class=\"token punctuation\">(</span>vs<span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">fs info-log: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>gl<span class=\"token punctuation\">.</span><span class=\"token function\">getShaderInfoLog</span><span class=\"token punctuation\">(</span>fs<span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"be_precise_with_glsl_precision_annotations","title":"Be precise with GLSL precision annotations","isH3":false,"content":"<p>If you expect to pass an essl300 <code>int</code> between shaders, and you need it to have 32-bits, you <em>must</em> use <code>highp</code> or you will have portability problems. (Works on Desktop, not on Android)</p>\n<p>If you have a float texture, iOS requires that you use <code>highp sampler2D foo;</code>, or it will very painfully give you <code>lowp</code> texture samples! (+/-2.0 max is probably not good enough for you)</p>"}},{"type":"prose","value":{"id":"implicit_defaults","title":"Implicit defaults","isH3":true,"content":"<p>The vertex language has the following predeclared globally scoped default precision statements:</p>\n<pre class=\"notranslate\">precision highp float;\nprecision highp int;\nprecision lowp sampler2D;\nprecision lowp samplerCube;\n</pre>\n<p>The fragment language has the following predeclared globally scoped default precision statements:</p>\n<pre class=\"notranslate\">precision mediump int;\nprecision lowp sampler2D;\nprecision lowp samplerCube;\n</pre>"}},{"type":"prose","value":{"id":"in_webgl_1_highp_float_support_is_optional_in_fragment_shaders","title":"In WebGL 1, \"highp float\" support is optional in fragment shaders","isH3":true,"content":"<p>Using <code>highp</code> precision unconditionally in fragment shaders will prevent your content from working on some older mobile hardware.</p>\n<p>While you can use <code>mediump float</code> instead, but be aware that this often results in corrupted rendering due to lack of precision (particularly mobile systems) though the corruption is not going to be visible on a typical desktop computer.</p>\n<p>If you know your precision requirements, <code>getShaderPrecisionFormat()</code> will tell you what the system supports.</p>\n<p>If <code>highp float</code> is available, <code>GL_FRAGMENT_PRECISION_HIGH</code> will be defined as <code>1</code>.</p>\n<p>A good pattern for \"always give me the highest precision\":</p>\n<pre class=\"notranslate\">#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n</pre>"}},{"type":"prose","value":{"id":"essl100_minimum_requirements_webgl_1","title":"ESSL100 minimum requirements (WebGL 1)","isH3":true,"content":"<figure class=\"table-container\"><table>\n  <thead>\n    <tr>\n      <th><code>float</code></th>\n      <th>think</th>\n      <th>range</th>\n      <th>min above zero</th>\n      <th>precision</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code>highp</code></td>\n      <td>float24*</td>\n      <td>(-2^62, 2^62)</td>\n      <td>2^-62</td>\n      <td>2^-16 relative</td>\n    </tr>\n    <tr>\n      <td><code>mediump</code></td>\n      <td>IEEE float16</td>\n      <td>(-2^14, 2^14)</td>\n      <td>2^-14</td>\n      <td>2^-10 relative</td>\n    </tr>\n    <tr>\n      <td><code>lowp</code></td>\n      <td>10-bit signed fixed</td>\n      <td>(-2, 2)</td>\n      <td>2^-8</td>\n      <td>2^-8 absolute</td>\n    </tr>\n  </tbody>\n</table></figure>\n<figure class=\"table-container\"><table>\n  <thead>\n    <tr>\n      <th><code>int</code></th>\n      <th>think</th>\n      <th>range</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code>highp</code></td>\n      <td>int17</td>\n      <td>(-2^16, 2^16)</td>\n    </tr>\n    <tr>\n      <td><code>mediump</code></td>\n      <td>int11</td>\n      <td>(-2^10, 2^10)</td>\n    </tr>\n    <tr>\n      <td><code>lowp</code></td>\n      <td>int9</td>\n      <td>(-2^8, 2^8)</td>\n    </tr>\n  </tbody>\n</table></figure>\n<p><em>*float24: sign bit, 7-bit for exponent, 16-bit for mantissa.</em></p>"}},{"type":"prose","value":{"id":"essl300_minimum_requirements_webgl_2","title":"ESSL300 minimum requirements (WebGL 2)","isH3":true,"content":"<figure class=\"table-container\"><table>\n  <thead>\n    <tr>\n      <th><code>float</code></th>\n      <th>think</th>\n      <th>range</th>\n      <th>min above zero</th>\n      <th>precision</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code>highp</code></td>\n      <td>IEEE float32</td>\n      <td>(-2^126, 2^127)</td>\n      <td>2^-126</td>\n      <td>2^-24 relative</td>\n    </tr>\n    <tr>\n      <td><code>mediump</code></td>\n      <td>IEEE float16</td>\n      <td>(-2^14, 2^14)</td>\n      <td>2^-14</td>\n      <td>2^-10 relative</td>\n    </tr>\n    <tr>\n      <td><code>lowp</code></td>\n      <td>10-bit signed fixed</td>\n      <td>(-2, 2)</td>\n      <td>2^-8</td>\n      <td>2^-8 absolute</td>\n    </tr>\n  </tbody>\n</table></figure>\n<figure class=\"table-container\"><table>\n  <thead>\n    <tr>\n      <th><code>(u)int</code></th>\n      <th>think</th>\n      <th><code>int</code> range</th>\n      <th><code>unsigned int</code> range</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code>highp</code></td>\n      <td>(u)int32</td>\n      <td>[-2^31, 2^31]</td>\n      <td>[0, 2^32]</td>\n    </tr>\n    <tr>\n      <td><code>mediump</code></td>\n      <td>(u)int16</td>\n      <td>[-2^15, 2^15]</td>\n      <td>[0, 2^16]</td>\n    </tr>\n    <tr>\n      <td><code>lowp</code></td>\n      <td>(u)int9</td>\n      <td>[-2^8, 2^8]</td>\n      <td>[0, 2^9]</td>\n    </tr>\n  </tbody>\n</table></figure>"}},{"type":"prose","value":{"id":"prefer_builtins_instead_of_building_your_own","title":"Prefer builtins instead of building your own","isH3":false,"content":"<p>Prefer builtins like <code>dot</code>, <code>mix</code>, and <code>normalize</code>. At best, custom implementations might run as fast as the builtins they replace, but don't expect them to. Hardware often has hyper-optimized or even specialized instructions for builtins, and the compiler can't reliably replace your custom builtin-replacements with the special builtin codepaths.</p>"}},{"type":"prose","value":{"id":"use_mipmaps_for_any_texture_youll_see_in_3d","title":"Use mipmaps for any texture you'll see in 3d","isH3":false,"content":"<p>When in doubt, call <code>generateMipmaps()</code> after texture uploads. Mipmaps are cheap on memory (only 30% overhead) while providing often-large performance advantages when textures are \"zoomed out\" or generally downscaled in the distance in 3d, or even for cube-maps!</p>\n<p>It's quicker to sample from smaller texture images due to better inherent texture fetch cache locality: Zooming out on a non-mipmapped texture ruins texture fetch cache locality, because neighboring pixels no longer sample from neighboring texels!</p>\n<p>However, for 2d resources that are never \"zoomed out\", don't pay the 30% memory surcharge for mipmaps:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">const</span> tex <span class=\"token operator\">=</span> gl<span class=\"token punctuation\">.</span><span class=\"token function\">createTexture</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ngl<span class=\"token punctuation\">.</span><span class=\"token function\">bindTexture</span><span class=\"token punctuation\">(</span>gl<span class=\"token punctuation\">.</span><span class=\"token constant\">TEXTURE_2D</span><span class=\"token punctuation\">,</span> tex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ngl<span class=\"token punctuation\">.</span><span class=\"token function\">texParameterf</span><span class=\"token punctuation\">(</span>gl<span class=\"token punctuation\">.</span><span class=\"token constant\">TEXTURE_2D</span><span class=\"token punctuation\">,</span> gl<span class=\"token punctuation\">.</span><span class=\"token constant\">TEXTURE_MIN_FILTER</span><span class=\"token punctuation\">,</span> gl<span class=\"token punctuation\">.</span><span class=\"token constant\">LINEAR</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Defaults to NEAREST_MIPMAP_LINEAR, for mipmapping!</span>\n</code></pre></div>\n<p>(In WebGL 2, you should just use <code>texStorage</code> with <code>levels=1</code>)</p>\n<p>One caveat: <code>generateMipmaps</code> only works if you would be able to render into the texture if you attached it to a framebuffer. (The spec calls this \"color-renderable formats\") For example, if a system supports float-textures but not render-to-float, <code>generateMipmaps</code> will fail for float formats.</p>"}},{"type":"prose","value":{"id":"dont_assume_you_can_render_into_float_textures","title":"Don't assume you can render into float textures","isH3":false,"content":"<p>There are many, many systems that support RGBA32F textures, but if you attach one to a framebuffer you'll get <code>FRAMEBUFFER_INCOMPLETE_ATTACHMENT</code> from <code>checkFramebufferStatus()</code>. It may work on your system, but <em>most</em> mobile systems will not support it!</p>\n<p>On WebGL 1, use the <code>EXT_color_buffer_half_float</code> and <code>WEBGL_color_buffer_float</code> extensions to check for render-to-float-texture support for float16 and float32 respectively.</p>\n<p>On WebGL 2, <code>EXT_color_buffer_float</code> checks for render-to-float-texture support for both float32 and float16. <code>EXT_color_buffer_half_float</code> is present on systems which only support rendering to float16 textures.</p>"}},{"type":"prose","value":{"id":"render-to-float32_doesnt_imply_float32-blending!","title":"Render-to-float32 doesn't imply float32-blending!","isH3":true,"content":"<p>It may work on your system, but on many others it won't. Avoid it if you can. Check for the <code>EXT_float_blend</code> extension to check for support.</p>\n<p>Float16-blending is always supported.</p>"}},{"type":"prose","value":{"id":"some_formats_e.g._rgb_may_be_emulated","title":"Some formats (e.g. RGB) may be emulated","isH3":false,"content":"<p>A number of formats (particularly three-channel formats) are emulated. For example, RGB32F is often actually RGBA32F, and Luminance8 may actually be RGBA8. RGB8 in particular is often surprisingly slow, as masking out the alpha channel and/or patching blend functions has fairly high overhead. Prefer to use RGBA8 and ignore the alpha yourself for better performance.</p>"}},{"type":"prose","value":{"id":"avoid_alphafalse_which_can_be_expensive","title":"Avoid alpha:false, which can be expensive","isH3":false,"content":"<p>Specifying <code>alpha:false</code> during context creation causes the browser to composite the WebGL-rendered canvas as though it were opaque, ignoring any alpha values the application writes in its fragment shader. On some platforms, this capability unfortunately comes at a significant performance cost. The RGB back buffer may have to be emulated on top of an RGBA surface, and there are relatively few techniques available in the OpenGL API for making it appear to the application that an RGBA surface has no alpha channel. <a href=\"https://bugs.chromium.org/p/chromium/issues/detail?id=1045643\" class=\"external\" target=\"_blank\">It has been found</a> that all of these techniques have approximately equal performance impact on affected platforms.</p>\n<p>Most applications, even those requiring alpha blending, can be structured to produce <code>1.0</code> for the alpha channel. The primary exception is any application requiring destination alpha in the blending function. If feasible, it is recommended to do this rather than using <code>alpha:false</code>.</p>"}},{"type":"prose","value":{"id":"consider_compressed_texture_formats","title":"Consider compressed texture formats","isH3":false,"content":"<p>While JPG and PNG are generally smaller over-the-wire, GPU compressed texture formats are smaller on in GPU memory, and are faster to sample from. (This reduces texture memory bandwidth, which is precious on mobile) However, compressed texture formats have worse quality than JPG, and are generally only acceptable for colors (not e.g. normals or coordinates).</p>\n<p>Unfortunately, there's no single universally supported format. Every system has at least one of the following though:</p>\n<ul>\n  <li>WEBGL_compressed_texture_s3tc (desktop)</li>\n  <li>WEBGL_compressed_texture_etc1 (Android)</li>\n  <li>WEBGL_compressed_texture_pvrtc (iOS)</li>\n</ul>\n<p>WebGL 2 has universal support by combining:</p>\n<ul>\n  <li>WEBGL_compressed_texture_s3tc (desktop)</li>\n  <li>WEBGL_compressed_texture_etc (mobile)</li>\n</ul>\n<p>WEBGL_compressed_texture_astc has both higher quality and/or higher compression, but is only supported on newer hardware.</p>"}},{"type":"prose","value":{"id":"basis_universal_texture_compression_formatlibrary","title":"Basis Universal texture compression format/library","isH3":true,"content":"<p>Basis Universal solves several of the issues mentioned above. It offers a way to support all common compressed texture formats with a single compressed texture file, through a JavaScript library that efficiently converts formats at load time. It also adds additional compression that makes Basis Universal compressed texture files much smaller than regular compressed textures over-the-wire, more comparable to JPEG.</p>\n<p><a href=\"https://github.com/BinomialLLC/basis_universal/blob/master/webgl/README.md\" class=\"external\" target=\"_blank\">https://github.com/BinomialLLC/basis_universal/blob/master/webgl/README.md</a></p>"}},{"type":"prose","value":{"id":"memory_usage_of_depth_and_stencil_formats","title":"Memory usage of depth and stencil formats","isH3":false,"content":"<p>Depth and stencil attachments and formats are actually inseparable on many devices. You may ask for DEPTH_COMPONENT24 or STENCIL_INDEX8, but you're often getting D24X8 and X24S8 32bpp formats behind the scenes. Assume that the memory usage of depth and stencil formats is rounded up to the nearest four bytes.</p>"}},{"type":"prose","value":{"id":"teximagetexsubimage_uploads_esp._videos_can_cause_pipeline_flushes","title":"texImage/texSubImage uploads (esp. videos) can cause pipeline flushes","isH3":false,"content":"<p>Most texture uploads from DOM elements will incur a processing pass that will temporarily switch GL Programs internally, causing a pipeline flush. (Pipelines are formalized explicitly in Vulkan[<a href=\"https://www.khronos.org/registry/vulkan/specs/1.2/html/chap9.html#VkGraphicsPipelineCreateInfo\" class=\"external\" target=\"_blank\">1</a>] et al, but are implicit behind-the-scenes in OpenGL and WebGL. Pipelines are more or less the tuple of shader program, depth/stencil/multisample/blend/rasterization state)</p>\n<p>In WebGL:</p>\n<pre class=\"notranslate\">    …\n    useProgram(prog1)\n&lt;pipeline flush&gt;\n    bindFramebuffer(target)\n    drawArrays()\n    bindTexture(webgl_texture)\n    texImage2D(HTMLVideoElement)\n    drawArrays()\n    …\n</pre>\n<p>Behind the scenes in the browser:</p>\n<pre class=\"notranslate\">    …\n    useProgram(prog1)\n&lt;pipeline flush&gt;\n    bindFramebuffer(target)\n    drawArrays()\n    bindTexture(webgl_texture)\n    -texImage2D(HTMLVideoElement):\n        +useProgram(_internal_tex_transform_prog)\n&lt;pipeline flush&gt;\n        +bindFramebuffer(webgl_texture._internal_framebuffer)\n        +bindTexture(HTMLVideoElement._internal_video_tex)\n        +drawArrays() // y-flip/colorspace-transform/alpha-(un)premultiply\n        +bindTexture(webgl_texture)\n        +bindFramebuffer(target)\n        +useProgram(prog1)\n&lt;pipeline flush&gt;\n    drawArrays()\n    …\n</pre>\n<p>Prefer doing uploads before starting drawing, or at least between pipelines:</p>\n<p>In WebGL:</p>\n<pre class=\"notranslate\">    …\n    bindTexture(webgl_texture)\n    texImage2D(HTMLVideoElement)\n    useProgram(prog1)\n&lt;pipeline flush&gt;\n    bindFramebuffer(target)\n    drawArrays()\n    bindTexture(webgl_texture)\n    drawArrays()\n    …\n</pre>\n<p>Behind the scenes in the browser:</p>\n<pre class=\"notranslate\">    …\n    bindTexture(webgl_texture)\n    -texImage2D(HTMLVideoElement):\n        +useProgram(_internal_tex_transform_prog)\n&lt;pipeline flush&gt;\n        +bindFramebuffer(webgl_texture._internal_framebuffer)\n        +bindTexture(HTMLVideoElement._internal_video_tex)\n        +drawArrays() // y-flip/colorspace-transform/alpha-(un)premultiply\n        +bindTexture(webgl_texture)\n        +bindFramebuffer(target)\n    useProgram(prog1)\n&lt;pipeline flush&gt;\n    bindFramebuffer(target)\n    drawArrays()\n    bindTexture(webgl_texture)\n    drawArrays()\n    …\n</pre>"}},{"type":"prose","value":{"id":"use_texstorage_to_create_textures","title":"Use texStorage to create textures","isH3":false,"content":"<p>The WebGL 2.0 <code>texImage*</code> API lets you define each mip level independently and at any size, even the mis-matching mips sizes are not an error until draw time which means there is no way the driver can actually prepare the texture in GPU memory until the first time the texture is drawn.</p>\n<p>Further, some drivers might unconditionally allocate the whole mip-chain (+30% memory!) even if you only want a single level.</p>\n<p>So, prefer <code>texStorage</code>+<code>texSubImage</code> for textures in WebGL 2</p>"}},{"type":"prose","value":{"id":"use_invalidateframebuffer","title":"Use invalidateFramebuffer","isH3":false,"content":"<p>Storing data that you won't use again can have high cost, particularly on tiled-rendering GPUs common on mobile. When you're done with the contents of a framebuffer attachment, use WebGL 2.0's <code>invalidateFramebuffer</code> to discard the data, instead of leaving the driver to waste time storing the data for later use. DEPTH/STENCIL and/or multisampled attachments in particular are great candidates for <code>invalidateFramebuffer</code>.</p>"}},{"type":"prose","value":{"id":"use_non-blocking_async_data_readback","title":"Use non-blocking async data readback","isH3":false,"content":"<p>Operations like <code>readPixels</code> and <code>getBufferSubData</code> are typically synchronous, but using the same APIs, non-blocking, asynchronous data readback can be achieved. The approach in WebGL 2 is analogous to the approach in OpenGL: <a href=\"https://kdashg.github.io/misc/async-gpu-downloads.html\" class=\"external\" target=\"_blank\">Async downloads in blocking APIs</a></p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">function</span> <span class=\"token function\">clientWaitAsync</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">gl<span class=\"token punctuation\">,</span> sync<span class=\"token punctuation\">,</span> flags<span class=\"token punctuation\">,</span> interval_ms</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> res <span class=\"token operator\">=</span> gl<span class=\"token punctuation\">.</span><span class=\"token function\">clientWaitSync</span><span class=\"token punctuation\">(</span>sync<span class=\"token punctuation\">,</span> flags<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>res <span class=\"token operator\">===</span> gl<span class=\"token punctuation\">.</span><span class=\"token constant\">WAIT_FAILED</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>res <span class=\"token operator\">===</span> gl<span class=\"token punctuation\">.</span><span class=\"token constant\">TIMEOUT_EXPIRED</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span>test<span class=\"token punctuation\">,</span> interval_ms<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">getBufferSubDataAsync</span><span class=\"token punctuation\">(</span>\n  gl<span class=\"token punctuation\">,</span>\n  target<span class=\"token punctuation\">,</span>\n  buffer<span class=\"token punctuation\">,</span>\n  srcByteOffset<span class=\"token punctuation\">,</span>\n  dstBuffer<span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">/* optional */</span> dstOffset<span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">/* optional */</span> length\n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> sync <span class=\"token operator\">=</span> gl<span class=\"token punctuation\">.</span><span class=\"token function\">fenceSync</span><span class=\"token punctuation\">(</span>gl<span class=\"token punctuation\">.</span><span class=\"token constant\">SYNC_GPU_COMMANDS_COMPLETE</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  gl<span class=\"token punctuation\">.</span><span class=\"token function\">flush</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">await</span> <span class=\"token function\">clientWaitAsync</span><span class=\"token punctuation\">(</span>gl<span class=\"token punctuation\">,</span> sync<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  gl<span class=\"token punctuation\">.</span><span class=\"token function\">deleteSync</span><span class=\"token punctuation\">(</span>sync<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  gl<span class=\"token punctuation\">.</span><span class=\"token function\">bindBuffer</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">,</span> buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  gl<span class=\"token punctuation\">.</span><span class=\"token function\">getBufferSubData</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">,</span> srcByteOffset<span class=\"token punctuation\">,</span> dstBuffer<span class=\"token punctuation\">,</span> dstOffset<span class=\"token punctuation\">,</span> length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  gl<span class=\"token punctuation\">.</span><span class=\"token function\">bindBuffer</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> dest<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">readPixelsAsync</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">gl<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> w<span class=\"token punctuation\">,</span> h<span class=\"token punctuation\">,</span> format<span class=\"token punctuation\">,</span> type<span class=\"token punctuation\">,</span> dest</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> buf <span class=\"token operator\">=</span> gl<span class=\"token punctuation\">.</span><span class=\"token function\">createBuffer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  gl<span class=\"token punctuation\">.</span><span class=\"token function\">bindBuffer</span><span class=\"token punctuation\">(</span>gl<span class=\"token punctuation\">.</span><span class=\"token constant\">PIXEL_PACK_BUFFER</span><span class=\"token punctuation\">,</span> buf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  gl<span class=\"token punctuation\">.</span><span class=\"token function\">bufferData</span><span class=\"token punctuation\">(</span>gl<span class=\"token punctuation\">.</span><span class=\"token constant\">PIXEL_PACK_BUFFER</span><span class=\"token punctuation\">,</span> dest<span class=\"token punctuation\">.</span>byteLength<span class=\"token punctuation\">,</span> gl<span class=\"token punctuation\">.</span><span class=\"token constant\">STREAM_READ</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  gl<span class=\"token punctuation\">.</span><span class=\"token function\">readPixels</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> w<span class=\"token punctuation\">,</span> h<span class=\"token punctuation\">,</span> format<span class=\"token punctuation\">,</span> type<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  gl<span class=\"token punctuation\">.</span><span class=\"token function\">bindBuffer</span><span class=\"token punctuation\">(</span>gl<span class=\"token punctuation\">.</span><span class=\"token constant\">PIXEL_PACK_BUFFER</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">await</span> <span class=\"token function\">getBufferSubDataAsync</span><span class=\"token punctuation\">(</span>gl<span class=\"token punctuation\">,</span> gl<span class=\"token punctuation\">.</span><span class=\"token constant\">PIXEL_PACK_BUFFER</span><span class=\"token punctuation\">,</span> buf<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> dest<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  gl<span class=\"token punctuation\">.</span><span class=\"token function\">deleteBuffer</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> dest<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"devicepixelratio_and_high-dpi_rendering","title":"<code>devicePixelRatio</code> and high-dpi rendering","isH3":true,"content":"<p>Handling <code>devicePixelRatio !== 1.0</code> is tricky. While the common approach is to set <code>canvas.width = width * devicePixelRatio</code>, this will cause moire artifacts with non-integer values of <code>devicePixelRatio</code>, as is common with UI scaling on Windows, as well as zooming on all platforms.</p>\n<p>Instead, we can use non-integer values for CSS's <code>top</code>/<code>bottom</code>/<code>left</code>/<code>right</code> to fairly reliably 'pre-snap' our canvas to whole integer device coordinates.</p>\n<p>Demo: <a href=\"https://kdashg.github.io/misc/webgl/device-pixel-presnap.html\" class=\"external\" target=\"_blank\">Device pixel presnap</a></p>","titleAsText":"devicePixelRatio and high-dpi rendering"}},{"type":"prose","value":{"id":"resizeobserver_and_device-pixel-content-box","title":"ResizeObserver and 'device-pixel-content-box'","isH3":true,"content":"<p>On supporting browsers (Chromium?), <code>ResizeObserver</code> can be used with <code>'device-pixel-content-box'</code> to request a callback that includes the true device pixel size of an element. This can be used to build an async-but-accurate function:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>window<span class=\"token punctuation\">.</span>getDevicePixelSize <span class=\"token operator\">=</span>\n  window<span class=\"token punctuation\">.</span>getDevicePixelSize <span class=\"token operator\">||</span>\n  <span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">elem</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">await</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">fn_resolve</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> observer <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ResizeObserver</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">entries</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> cur <span class=\"token keyword\">of</span> entries<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">const</span> dev_size <span class=\"token operator\">=</span> cur<span class=\"token punctuation\">.</span>devicePixelContentBoxSize<span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">const</span> ret <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token literal-property property\">width</span><span class=\"token operator\">:</span> dev_size<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>inlineSize<span class=\"token punctuation\">,</span>\n            <span class=\"token literal-property property\">height</span><span class=\"token operator\">:</span> dev_size<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>blockSize<span class=\"token punctuation\">,</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n          <span class=\"token function\">fn_resolve</span><span class=\"token punctuation\">(</span>ret<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          observer<span class=\"token punctuation\">.</span><span class=\"token function\">disconnect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">throw</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">device-pixel-content-box not observed for elem </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>elem<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      observer<span class=\"token punctuation\">.</span><span class=\"token function\">observe</span><span class=\"token punctuation\">(</span>elem<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">box</span><span class=\"token operator\">:</span> <span class=\"token string\">\"device-pixel-content-box\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Please refer to <a href=\"https://www.w3.org/TR/resize-observer/#resize-observer-interface\" class=\"external\" target=\"_blank\">the specification</a> for more details.</p>"}},{"type":"prose","value":{"id":"imagebitmap_creation","title":"ImageBitmap creation","isH3":false,"content":"<p>Using the <a href=\"https://html.spec.whatwg.org/multipage/imagebitmap-and-animations.html#imagebitmapoptions\" class=\"external\" target=\"_blank\">ImageBitmapOptions dictionary</a> is essential for properly preparing textures for upload to WebGL, but unfortunately there's no obvious way to query exactly which dictionary members are supported by a given browser.</p>\n<p><a href=\"https://jsfiddle.net/ptkyewhx/\" class=\"external\" target=\"_blank\">This JSFiddle</a> illustrates how to determine which dictionary members a given browser supports.</p>"}}],"toc":[{"text":"Address and eliminate WebGL errors","id":"address_and_eliminate_webgl_errors"},{"text":"Understand extension availability","id":"understand_extension_availability"},{"text":"Understand system limits","id":"understand_system_limits"},{"text":"Avoid invalidating FBO attachment bindings","id":"avoid_invalidating_fbo_attachment_bindings"},{"text":"Delete objects eagerly","id":"delete_objects_eagerly"},{"text":"Lose contexts eagerly","id":"lose_contexts_eagerly"},{"text":"Flush when expecting results","id":"flush_when_expecting_results"},{"text":"Avoid blocking API calls in production","id":"avoid_blocking_api_calls_in_production"},{"text":"Always enable vertex attrib 0 as an array","id":"always_enable_vertex_attrib_0_as_an_array"},{"text":"Estimate a per-pixel VRAM Budget","id":"estimate_a_per-pixel_vram_budget"},{"text":"Consider rendering to a smaller back buffer","id":"consider_rendering_to_a_smaller_back_buffer"},{"text":"Batch draw calls","id":"batch_draw_calls"},{"text":"Avoid \"#ifdef GL_ES\"","id":"avoid_ifdef_gl_es"},{"text":"Prefer doing work in the vertex shader","id":"prefer_doing_work_in_the_vertex_shader"},{"text":"Compile Shaders and Link Programs in parallel","id":"compile_shaders_and_link_programs_in_parallel"},{"text":"Prefer KHR_parallel_shader_compile","id":"prefer_khr_parallel_shader_compile"},{"text":"Don't check shader compile status unless linking fails","id":"dont_check_shader_compile_status_unless_linking_fails"},{"text":"Be precise with GLSL precision annotations","id":"be_precise_with_glsl_precision_annotations"},{"text":"Prefer builtins instead of building your own","id":"prefer_builtins_instead_of_building_your_own"},{"text":"Use mipmaps for any texture you'll see in 3d","id":"use_mipmaps_for_any_texture_youll_see_in_3d"},{"text":"Don't assume you can render into float textures","id":"dont_assume_you_can_render_into_float_textures"},{"text":"Some formats (e.g. RGB) may be emulated","id":"some_formats_e.g._rgb_may_be_emulated"},{"text":"Avoid alpha:false, which can be expensive","id":"avoid_alphafalse_which_can_be_expensive"},{"text":"Consider compressed texture formats","id":"consider_compressed_texture_formats"},{"text":"Memory usage of depth and stencil formats","id":"memory_usage_of_depth_and_stencil_formats"},{"text":"texImage/texSubImage uploads (esp. videos) can cause pipeline flushes","id":"teximagetexsubimage_uploads_esp._videos_can_cause_pipeline_flushes"},{"text":"Use texStorage to create textures","id":"use_texstorage_to_create_textures"},{"text":"Use invalidateFramebuffer","id":"use_invalidateframebuffer"},{"text":"Use non-blocking async data readback","id":"use_non-blocking_async_data_readback"},{"text":"ImageBitmap creation","id":"imagebitmap_creation"}],"summary":"WebGL is a complicated API, and it's often not obvious what the recommended ways to use it are. This page tackles recommendations across the spectrum of expertise, and not only highlights dos and don'ts, but also details why. You can rely on this document to guide your choice of approach, and ensure you're on the right track no matter what browser or hardware your users run.","popularity":0,"modified":"2023-01-21T12:18:52.000Z","other_translations":[{"title":"WebGL best practices","locale":"ja","native":"日本語"},{"title":"WebGL best practices","locale":"ko","native":"한국어"},{"title":"Лучшие практики WebGL","locale":"ru","native":"Русский"},{"title":"WebGL best practices","locale":"zh-CN","native":"中文 (简体)"}],"source":{"folder":"en-us/web/api/webgl_api/webgl_best_practices","github_url":"https://github.com/mdn/content/blob/main/files/en-us/web/api/webgl_api/webgl_best_practices/index.md","last_commit_url":"https://github.com/mdn/content/commit/65cd9754ed95f116b641c68cad80f14ecf580b41","filename":"index.md"},"short_title":"WebGL best practices","parents":[{"uri":"/en-US/docs/Web","title":"References"},{"uri":"/en-US/docs/Web/API","title":"Web APIs"},{"uri":"/en-US/docs/Web/API/WebGL_API","title":"WebGL: 2D and 3D graphics for the web"},{"uri":"/en-US/docs/Web/API/WebGL_API/WebGL_best_practices","title":"WebGL best practices"}],"pageTitle":"WebGL best practices - Web APIs | MDN","noIndexing":false}}</script>
<!-- Mirrored from developer.mozilla.org/en-US/docs/Web/API/WebGL_API/WebGL_best_practices by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 14 Feb 2023 04:49:37 GMT -->
</body></html>