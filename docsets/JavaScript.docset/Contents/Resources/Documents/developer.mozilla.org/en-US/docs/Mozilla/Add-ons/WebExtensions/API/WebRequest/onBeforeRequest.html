<html><!-- Mirrored from developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/onBeforeRequest by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 14 Feb 2023 06:11:47 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" href="../../../../../../../favicon-48x48.cbbd161b.png"><link rel="apple-touch-icon" href="../../../../../../../apple-touch-icon.6803c6f0.png"><meta name="theme-color" content="#ffffff"><link rel="manifest" href="../../../../../../../manifest.56b1cedc.json"><link rel="search" type="application/opensearchdescription+xml" href="https://developer.mozilla.org/opensearch.xml" title="MDN Web Docs"><title>webRequest.onBeforeRequest</title><link rel="alternate" title="webRequest.onBeforeRequest" href="../../../../../../../fr/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/onBeforeRequest.html" hreflang="fr"><link rel="alternate" title="webRequest.onBeforeRequest" href="../../../../../../../ko/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/onBeforeRequest.html" hreflang="ko"><link rel="alternate" title="webRequest.onBeforeRequest" href="onBeforeRequest.html" hreflang="en"><meta name="robots" content="index, follow"><meta name="description" content="This event is triggered when a request is about to be made, and before headers are available. This is a good place to listen if you want to cancel or redirect the request."><meta property="og:url" content="onBeforeRequest.html"><meta property="og:title" content="webRequest.onBeforeRequest - Mozilla | MDN"><meta property="og:locale" content="en-US"><meta property="og:description" content="This event is triggered when a request is about to be made, and before headers are available. This is a good place to listen if you want to cancel or redirect the request."><meta property="og:image" content="../../../../../../../mdn-social-share.cd6c4a5a.png"><meta property="twitter:card" content="summary_large_image"><link rel="canonical" href="onBeforeRequest.html"><style media="print">.article-actions-container,.document-toc-container,.language-menu,.main-menu-toggle,.mdn-cta-container,.on-github,.page-footer,.sidebar,.top-navigation-main,ul.prev-next{display:none!important}.main-page-content,.main-page-content pre{padding:2px}.main-page-content pre{border-left-width:2px}</style><script src="../../../../../../../static/js/ga.js" defer=""></script><script defer="defer" src="../../../../../../../static/js/main.5c9d40d0.js"></script><link href="../../../../../../../static/css/main.7d378400.css" rel="stylesheet"></head><body><script>document.body.addEventListener("load",(t=>{t.target.classList.contains("interactive")&&t.target.setAttribute("data-readystate","complete")}),{capture:!0});const c={light:"#ffffff",dark:"#1b1b1b"};if(window&&document.documentElement)try{const t=window.localStorage.getItem("theme");t&&(document.documentElement.className=t,document.documentElement.style.backgroundColor=c[t])}catch(t){console.warn("Unable to read theme from localStorage",t)}</script><div id="root"><ul id="nav-access" class="a11y-nav"><li><a id="skip-main" href="#content">Skip to main content</a></li><li><a id="skip-search" href="#top-nav-search-input">Skip to search</a></li><li><a id="skip-select-language" href="#languages-switcher-button">Skip to select language</a></li></ul><div class="page-wrapper   document-page"><div class="main-document-header-container"><header class="main-document-header-container top-navigation 
      
      "><div class="container "><div class="top-navigation-wrap"><a href="https://developer.mozilla.org/en-US/" class="logo" aria-label="MDN homepage"><svg id="mdn-docs-logo" xmlns="http://www.w3.org/2000/svg" x="0" y="0" viewBox="0 0 694.9 104.4" style="enable-background:new 0 0 694.9 104.4" xml:space="preserve" role="img"><title>MDN Web Docs</title><style>.logo-m{fill:var(--text-link)}</style><g class="logo-m"><path d="M40.3 0 11.7 92.1H0L28.5 0h11.8zM50.7 0v92.1H40.3V0h10.4zM91 0 62.5 92.1H50.8L79.3 0H91zM101.4 0v92.1H91V0h10.4z"></path></g><path class="logo-m" d="M627.9 95.6h67v8.8h-67v-8.8z"></path><g style="fill:var(--text-primary)"><path d="M367 42h-4l-10.7 30.8h-5.5l-10.8-26h-.4l-10.5 26h-5.2L308.7 42h-3.8v-5.6H323V42h-6.5l6.8 20.4h.4l10.3-26h4.7l11.2 26h.5l5.7-20.3h-6.2v-5.6H367V42zM401.9 62c-.4 3.2-2 5.9-4.7 8.2-2.8 2.3-6.5 3.4-11.3 3.4-5.4 0-9.7-1.6-13.1-4.7-3.3-3.2-5-7.7-5-13.7 0-5.7 1.6-10.3 4.7-14s7.4-5.5 12.9-5.5c5.1 0 9.1 1.6 11.9 4.7s4.3 6.9 4.3 11.3c0 1.5-.2 3-.5 4.7h-25.6c.3 7.7 4 11.6 10.9 11.6 2.9 0 5.1-.7 6.5-2 1.5-1.4 2.5-3 3-4.9l6 .9zM394 51.3c.2-2.4-.4-4.7-1.8-6.9s-3.8-3.3-7-3.3c-3.1 0-5.3 1-6.9 3-1.5 2-2.5 4.4-2.8 7.2H394zM445 53.7c0 5-1.3 9.5-4 13.7s-6.9 6.2-12.7 6.2c-6 0-10.3-2.2-12.7-6.7-.1.4-.2 1.4-.4 2.9s-.3 2.5-.4 2.9h-7.3c.3-1.7.6-3.5.8-5.3.3-1.8.4-3.7.4-5.5V22.3h-6v-5.6H416v27c1.1-2.2 2.7-4.1 4.7-5.7 2-1.6 4.8-2.4 8.4-2.4 4.6 0 8.4 1.6 11.4 4.7 3 3.2 4.5 7.6 4.5 13.4zm-7.7.6c0-4.2-1-7.4-3-9.5-2-2.2-4.4-3.3-7.4-3.3-3.4 0-6 1.2-8 3.7-1.9 2.4-2.9 5-3 7.7V57c0 3 1 5.6 3 7.7s4.5 3.1 7.6 3.1c3.6 0 6.3-1.3 8.1-3.9 1.8-2.7 2.7-5.9 2.7-9.6zM506.5 72.8h-13.2v-7.2c-1.2 2.2-2.8 4.1-4.9 5.6-2.1 1.6-4.8 2.4-8.3 2.4-4.8 0-8.7-1.6-11.6-4.9-2.9-3.2-4.3-7.7-4.3-13.3 0-5 1.3-9.6 4-13.7 2.6-4.1 6.9-6.2 12.8-6.2 5.7 0 9.8 2.2 12.3 6.5V22.3h-8.6v-5.6h15.8v50.6h6v5.5zM493.2 56v-4.4c-.1-3-1.2-5.5-3.2-7.3s-4.4-2.8-7.2-2.8c-3.6 0-6.3 1.3-8.2 3.9-1.9 2.6-2.8 5.8-2.8 9.6 0 4.1 1 7.3 3 9.5s4.5 3.3 7.4 3.3c3.2 0 5.8-1.3 7.8-3.8 2.1-2.6 3.1-5.3 3.2-8zM546.3 54.6c0 5.6-1.8 10.2-5.3 13.7s-8.2 5.3-13.9 5.3-10.1-1.7-13.4-5.1c-3.3-3.4-5-7.9-5-13.5 0-5.3 1.6-9.9 4.7-13.7 3.2-3.8 7.9-5.7 14.2-5.7s11 1.9 14.1 5.7c3 3.7 4.6 8.1 4.6 13.3zm-7.7-.2c0-4-1-7.2-3-9.5s-4.8-3.5-8.2-3.5c-3.6 0-6.4 1.2-8.3 3.7s-2.9 5.6-2.9 9.5c0 3.7.9 6.8 2.8 9.4 1.9 2.6 4.6 3.9 8.3 3.9 3.6 0 6.4-1.3 8.4-3.8 1.9-2.6 2.9-5.8 2.9-9.7zM583.6 60.2c-.4 3.2-1.9 6.3-4.4 9.1-2.5 2.9-6.4 4.3-11.8 4.3-5.2 0-9.4-1.6-12.6-4.8-3.2-3.2-4.8-7.7-4.8-13.7 0-5.5 1.6-10.1 4.7-13.9 3.2-3.8 7.6-5.7 13.2-5.7 2.3 0 4.6.3 6.7.8 2.2.5 4.2 1.5 6.2 2.9l1.5 9.5-5.9.7-1.3-6.1c-2.1-1.2-4.5-1.8-7.2-1.8-3.5 0-6.1 1.2-7.7 3.7-1.7 2.5-2.5 5.7-2.5 9.6 0 4.1.9 7.3 2.7 9.5 1.8 2.3 4.4 3.4 7.8 3.4 5.2 0 8.2-2.9 9.2-8.8l6.2 1.3zM618.3 62.1c0 3.6-1.5 6.5-4.6 8.5s-7 3-11.7 3c-5.7 0-10.6-1.2-14.6-3.6l1.2-8.8 5.7.6-.2 4.7c1.1.5 2.3.9 3.6 1.1s2.6.3 3.9.3c2.4 0 4.5-.4 6.5-1.3 1.9-.9 2.9-2.2 2.9-4.1 0-1.8-.8-3.1-2.3-3.8s-3.5-1.3-5.8-1.7-4.6-.9-6.9-1.4c-2.3-.6-4.2-1.6-5.7-2.9-1.6-1.4-2.3-3.5-2.3-6.3 0-4.1 1.5-6.9 4.6-8.5s6.4-2.4 9.9-2.4c2.6 0 5 .3 7.2.9 2.2.6 4.3 1.4 6.1 2.4l.8 8.8-5.8.7-.8-5.7c-2.3-1-4.7-1.6-7.2-1.6-2.1 0-3.7.4-5.1 1.1-1.3.8-2 2-2 3.8 0 1.7.8 2.9 2.3 3.6 1.5.7 3.4 1.2 5.7 1.6 2.2.4 4.5.8 6.7 1.4 2.2.6 4.1 1.6 5.7 3 1.4 1.6 2.2 3.7 2.2 6.6zM197.6 73.2h-17.1v-5.5h3.8V51.9c0-3.7-.7-6.3-2.1-7.9-1.4-1.6-3.3-2.3-5.7-2.3-3.2 0-5.6 1.1-7.2 3.4s-2.4 4.6-2.5 6.9v15.6h6v5.5h-17.1v-5.5h3.8V51.9c0-3.8-.7-6.4-2.1-7.9-1.4-1.5-3.3-2.3-5.6-2.3-3.2 0-5.5 1.1-7.2 3.3-1.6 2.2-2.4 4.5-2.5 6.9v15.8h6.9v5.5h-20.2v-5.5h6V42.4h-6.1v-5.6h13.4v6.4c1.2-2.1 2.7-3.8 4.7-5.2 2-1.3 4.4-2 7.3-2s5.3.7 7.5 2.1c2.2 1.4 3.7 3.5 4.5 6.4 1.1-2.5 2.7-4.5 4.9-6.1s4.8-2.4 7.9-2.4c3.5 0 6.5 1.1 8.9 3.3s3.7 5.6 3.7 10.2v18.2h6.1v5.5zm42.5 0h-13.2V66c-1.2 2.2-2.8 4.1-4.9 5.6-2.1 1.6-4.8 2.4-8.3 2.4-4.8 0-8.7-1.6-11.6-4.9-2.9-3.2-4.3-7.7-4.3-13.3 0-5 1.3-9.6 4-13.7 2.6-4.1 6.9-6.2 12.8-6.2s9.8 2.2 12.3 6.5V22.7h-8.6v-5.6h15.8v50.6h6v5.5zm-13.3-16.8V52c-.1-3-1.2-5.5-3.2-7.3s-4.4-2.8-7.2-2.8c-3.6 0-6.3 1.3-8.2 3.9-1.9 2.6-2.8 5.8-2.8 9.6 0 4.1 1 7.3 3 9.5s4.5 3.3 7.4 3.3c3.2 0 5.8-1.3 7.8-3.8 2.1-2.6 3.1-5.3 3.2-8zm61.5 16.8H269v-5.5h6V51.9c0-3.7-.7-6.3-2.2-7.9-1.4-1.6-3.4-2.3-5.7-2.3-3.1 0-5.6 1-7.4 3s-2.8 4.4-2.9 7v15.9h6v5.5h-19.3v-5.5h6V42.4h-6.2v-5.6h13.6V43c2.6-4.6 6.8-6.9 12.7-6.9 3.6 0 6.7 1.1 9.2 3.3s3.7 5.6 3.7 10.2v18.2h6v5.4h-.2z"></path></g></svg></a><button title="Open main menu" type="button" class="button action has-icon main-menu-toggle" aria-haspopup="menu" aria-label="Open main menu" aria-expanded="false"><span class="button-wrap"><span class="icon icon-menu "></span><span class="visually-hidden">Open main menu</span></span></button></div><div class="top-navigation-main"><nav class="main-nav" aria-label="Main menu"><ul class="main-menu nojs"><li class="top-level-entry-container"><button type="button" id="references-button" class="top-level-entry menu-toggle" aria-controls="references-menu" aria-expanded="false">References</button><a href="https://developer.mozilla.org/en-US/docs/Web" class="top-level-entry">References</a><ul id="references-menu" class="submenu references hidden inline-submenu-lg" aria-labelledby="references-button"><li class="apis-link-container mobile-only "><a href="https://developer.mozilla.org/en-US/docs/Web" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">Overview / Web Technology</div><p class="submenu-item-description">Web technology reference for developers</p></div></a></li><li class="html-link-container "><a href="https://developer.mozilla.org/en-US/docs/Web/HTML" class="submenu-item "><div class="submenu-icon html"></div><div class="submenu-content-container"><div class="submenu-item-heading">HTML</div><p class="submenu-item-description">Structure of content on the web</p></div></a></li><li class="css-link-container "><a href="https://developer.mozilla.org/en-US/docs/Web/CSS" class="submenu-item "><div class="submenu-icon css"></div><div class="submenu-content-container"><div class="submenu-item-heading">CSS</div><p class="submenu-item-description">Code used to describe document style</p></div></a></li><li class="javascript-link-container "><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript" class="submenu-item "><div class="submenu-icon javascript"></div><div class="submenu-content-container"><div class="submenu-item-heading">JavaScript</div><p class="submenu-item-description">General-purpose scripting language</p></div></a></li><li class="http-link-container "><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP" class="submenu-item "><div class="submenu-icon http"></div><div class="submenu-content-container"><div class="submenu-item-heading">HTTP</div><p class="submenu-item-description">Protocol for transmitting web resources</p></div></a></li><li class="apis-link-container "><a href="../../../../../Web/API.html" class="submenu-item "><div class="submenu-icon apis"></div><div class="submenu-content-container"><div class="submenu-item-heading">Web APIs</div><p class="submenu-item-description">Interfaces for building web applications</p></div></a></li><li class="apis-link-container "><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">Web Extensions</div><p class="submenu-item-description">Developing extensions for web browsers</p></div></a></li><li class="apis-link-container desktop-only "><a href="https://developer.mozilla.org/en-US/docs/Web" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">Web Technology</div><p class="submenu-item-description">Web technology reference for developers</p></div></a></li></ul></li><li class="top-level-entry-container"><button type="button" id="guides-button" class="top-level-entry menu-toggle" aria-controls="guides-menu" aria-expanded="false">Guides</button><a href="https://developer.mozilla.org/en-US/docs/Learn" class="top-level-entry">Guides</a><ul id="guides-menu" class="submenu guides hidden inline-submenu-lg" aria-labelledby="guides-button"><li class="apis-link-container mobile-only "><a href="https://developer.mozilla.org/en-US/docs/Learn" class="submenu-item "><div class="submenu-icon learn"></div><div class="submenu-content-container"><div class="submenu-item-heading">Overview / MDN Learning Area</div><p class="submenu-item-description">Learn web development</p></div></a></li><li class="apis-link-container desktop-only "><a href="https://developer.mozilla.org/en-US/docs/Learn" class="submenu-item "><div class="submenu-icon learn"></div><div class="submenu-content-container"><div class="submenu-item-heading">MDN Learning Area</div><p class="submenu-item-description">Learn web development</p></div></a></li><li class="html-link-container "><a href="https://developer.mozilla.org/en-US/docs/Learn/HTML" class="submenu-item "><div class="submenu-icon html"></div><div class="submenu-content-container"><div class="submenu-item-heading">HTML</div><p class="submenu-item-description">Learn to structure web content with HTML</p></div></a></li><li class="css-link-container "><a href="https://developer.mozilla.org/en-US/docs/Learn/CSS" class="submenu-item "><div class="submenu-icon css"></div><div class="submenu-content-container"><div class="submenu-item-heading">CSS</div><p class="submenu-item-description">Learn to style content using CSS</p></div></a></li><li class="javascript-link-container "><a href="https://developer.mozilla.org/en-US/docs/Learn/JavaScript" class="submenu-item "><div class="submenu-icon javascript"></div><div class="submenu-content-container"><div class="submenu-item-heading">JavaScript</div><p class="submenu-item-description">Learn to run scripts in the browser</p></div></a></li><li class=" "><a href="https://developer.mozilla.org/en-US/docs/Web/Accessibility" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">Accessibility</div><p class="submenu-item-description">Learn to make the web accessible to all</p></div></a></li></ul></li><li class="top-level-entry-container"><button type="button" id="mdn-plus-button" class="top-level-entry menu-toggle" aria-controls="mdn-plus-menu" aria-expanded="false">MDN Plus</button><a href="https://developer.mozilla.org/en-US/plus" class="top-level-entry">MDN Plus</a><ul id="mdn-plus-menu" class="submenu mdn-plus hidden inline-submenu-lg" aria-labelledby="mdn-plus-button"><li class=" "><a href="https://developer.mozilla.org/en-US/plus" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">Overview</div><p class="submenu-item-description">A customized MDN experience</p></div></a></li><li class=" "><a href="https://developer.mozilla.org/en-US/plus/updates" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">Updates</div><p class="submenu-item-description">All browser compatibility updates at a glance</p></div></a></li><li class=" "><a href="https://developer.mozilla.org/en-US/plus/docs/features/overview" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">Documentation</div><p class="submenu-item-description">Learn how to use MDN Plus</p></div></a></li><li class=" "><a href="https://developer.mozilla.org/en-US/plus/docs/faq" class="submenu-item "><div class="submenu-icon"></div><div class="submenu-content-container"><div class="submenu-item-heading">FAQ</div><p class="submenu-item-description">Frequently asked questions about MDN Plus</p></div></a></li></ul></li></ul></nav><div class="header-search"><form action="https://developer.mozilla.org/en-US/search" role="search" aria-haspopup="listbox" aria-owns="top-nav-search-menu" aria-expanded="false" class="search-form search-widget" id="top-nav-search-form"><label id="top-nav-search-label" for="top-nav-search-input" class="visually-hidden">Search MDN</label><input id="top-nav-search-input" aria-autocomplete="list" aria-controls="top-nav-search-menu" aria-labelledby="top-nav-search-label" autocomplete="off" type="search" class="search-input-field" name="q" placeholder="   " required="" value=""><button type="button" class="button action has-icon clear-search-button"><span class="button-wrap"><span class="icon icon-cancel "></span><span class="visually-hidden">Clear search input</span></span></button><button type="submit" class="button action has-icon search-button"><span class="button-wrap"><span class="icon icon-search "></span><span class="visually-hidden">Search</span></span></button><div id="top-nav-search-menu" role="listbox" aria-labelledby="top-nav-search-label"></div></form></div><div class="theme-switcher-menu"><button type="button" class="button action has-icon theme-switcher-menu small" aria-haspopup="menu"><span class="button-wrap"><span class="icon icon-theme-os-default "></span>Theme</span></button></div><ul class="auth-container"><li><a href="https://developer.mozilla.org/users/fxa/login/authenticate/?next=%2Fen-US%2Fdocs%2FMozilla%2FAdd-ons%2FWebExtensions%2FAPI%2FwebRequest%2FonBeforeRequest" class="signin-link" rel="nofollow">Already a subscriber?</a></li><li><a class="button primary mdn-plus-subscribe-link" href="https://developer.mozilla.org/en-US/plus"><span class="button-wrap">Get MDN Plus</span></a></li></ul></div></div></header><div class="article-actions-container"><div class="container"><button type="button" class="button action has-icon sidebar-button" aria-label="Expand sidebar" aria-expanded="false" aria-controls="sidebar-quicklinks"><span class="button-wrap"><span class="icon icon-sidebar "></span></span></button><nav class="breadcrumbs-container" aria-label="Breadcrumb"><ol typeof="BreadcrumbList" vocab="https://schema.org/" aria-label="breadcrumbs"><li property="itemListElement" typeof="ListItem"><a class="breadcrumb" property="item" typeof="WebPage" href="https://developer.mozilla.org/en-US/docs/Mozilla"><span property="name">Mozilla</span></a><meta property="position" content="1"></li><li property="itemListElement" typeof="ListItem"><a class="breadcrumb" property="item" typeof="WebPage" href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons"><span property="name">Add-ons</span></a><meta property="position" content="2"></li><li property="itemListElement" typeof="ListItem"><a class="breadcrumb" property="item" typeof="WebPage" href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions"><span property="name">Browser Extensions</span></a><meta property="position" content="3"></li><li property="itemListElement" typeof="ListItem"><a class="breadcrumb" property="item" typeof="WebPage" href="../../API.html"><span property="name">JavaScript APIs</span></a><meta property="position" content="4"></li><li property="itemListElement" typeof="ListItem"><a class="breadcrumb" property="item" typeof="WebPage" href="../webRequest.html"><span property="name">webRequest</span></a><meta property="position" content="5"></li><li property="itemListElement" typeof="ListItem"><a class="breadcrumb-current-page" property="item" typeof="WebPage" href="onBeforeRequest.html"><span property="name">webRequest.onBeforeRequest</span></a><meta property="position" content="6"></li></ol></nav><div class="article-actions"><button type="button" class="button action has-icon article-actions-toggle" aria-label="Article actions"><span class="button-wrap"><span class="icon icon-ellipses "></span><span class="article-actions-dialog-heading">Article Actions</span></span></button><ul class="article-actions-entries"><li class="article-actions-entry"><div class="languages-switcher-menu open-on-focus-within"><button id="languages-switcher-button" type="button" class="button action small has-icon languages-switcher-menu" aria-haspopup="menu"><span class="button-wrap"><span class="icon icon-language "></span>English (US)</span></button></div></li></ul></div></div></div></div><div class="main-wrapper"><aside id="sidebar-quicklinks" class="sidebar"><button type="button" class="button action backdrop" aria-label="Collapse sidebar"><span class="button-wrap"></span></button><nav aria-label="Related Topics" class="sidebar-inner"><div class="in-nav-toc"><div class="document-toc-container"><section class="document-toc"><header><h2 class="document-toc-heading">In this article</h2></header><ul class="document-toc-list"><li class="document-toc-item "><a class="document-toc-link" href="#syntax">Syntax</a></li><li class="document-toc-item "><a class="document-toc-link" href="#addlistener_syntax">addListener syntax</a></li><li class="document-toc-item "><a class="document-toc-link" href="#additional_objects">Additional objects</a></li><li class="document-toc-item "><a class="document-toc-link" href="#browser_compatibility">Browser compatibility</a></li><li class="document-toc-item "><a class="document-toc-link" href="#examples">Examples</a></li></ul></section></div></div><div>
  <ol>
    <li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions"><strong>Browser extensions</strong></a></li>
    <li class="toggle">
      <details>
        <summary>Getting started</summary>
        <ol>
          <li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/What_are_WebExtensions">What are extensions?</a></li>
          <li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Your_first_WebExtension">Your first extension</a></li>
          <li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Your_second_WebExtension">Your second extension</a></li>
          <li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Anatomy_of_a_WebExtension">Anatomy of an extension</a></li>
          <li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Examples">Example extensions</a></li>
          <li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/What_next_">What next?</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary>Concepts</summary>
        <ol>
          <li><a href="../../API.html">Using the JavaScript APIs</a></li>
          <li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Content_scripts">Content scripts</a></li>
          <li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Background_scripts">Background scripts</a></li>
          <li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Match_patterns">Match patterns</a></li>
          <li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Working_with_files">Working with files</a></li>
          <li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Internationalization">Internationalization</a></li>
          <li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Content_Security_Policy">Content Security Policy</a></li>
          <li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Native_messaging">Native messaging</a></li>
          <li><a href="../../Differences_between_API_implementations.html">Differences between API implementations</a></li>
          <li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Chrome_incompatibilities">Chrome incompatibilities</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary>User interface</summary>
        <ol>
          <li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface">User Interface</a></li>
          <li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Browser_action">Toolbar button</a></li>
          <li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Page_actions">Address bar button</a></li>
          <li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Sidebars">Sidebars</a></li>
          <li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Context_menu_items">Context menu items</a></li>
          <li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Options_pages">Options page</a></li>
          <li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Extension_pages">Extension pages</a></li>
          <li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Notifications">Notifications</a></li>
          <li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Omnibox">Address bar suggestions</a></li>
          <li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/devtools_panels">Developer tools panels</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary>How to</summary>
        <ol>
          <li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Intercept_HTTP_requests">Intercept HTTP requests</a></li>
          <li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Modify_a_web_page">Modify a web page</a></li>
          <li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Safely_inserting_external_content_into_a_page">Insert external content</a></li>
          <li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Sharing_objects_with_page_scripts">Share objects with page scripts</a></li>
          <li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Add_a_button_to_the_toolbar">Add a button to the toolbar</a></li>
          <li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Implement_a_settings_page">Implement a settings page</a></li>
          <li><a href="../../Working_with_the_Tabs_API.html">Work with the Tabs API</a></li>
          <li><a href="../../Work_with_the_Bookmarks_API.html">Work with the Bookmarks API</a></li>
          <li><a href="../../Work_with_the_Cookies_API.html">Work with the Cookies API</a></li>
          <li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Work_with_contextual_identities">Work with contextual identities</a></li>
          <li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Interact_with_the_clipboard">Interact with the clipboard</a></li>
          <li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Extending_the_developer_tools">Extending the developer tools</a></li>
          <li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Build_a_cross_browser_extension">Build a cross-browser extension</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Firefox_differentiators">Firefox differentiators</a></summary>
      </details>
    </li>
    <li class="toggle">
      <details open="">
        <summary>JavaScript APIs</summary>
        <ol><li><a href="../../Browser_support_for_JavaScript_APIs.html">Browser support for JavaScript APIs</a></li><li><a href="../action.html">action</a></li><li><a href="../alarms.html">alarms</a></li><li><a href="../bookmarks.html">bookmarks</a></li><li><a href="../browserAction.html">browserAction</a></li><li><a href="../browserSettings.html">browserSettings</a></li><li><a href="../browsingData.html">browsingData</a></li><li><a href="../captivePortal.html">captivePortal</a></li><li><a href="../clipboard.html">clipboard</a></li><li><a href="../commands.html">commands</a></li><li><a href="../contentScripts.html">contentScripts</a></li><li><a href="../contextualIdentities.html">contextualIdentities</a></li><li><a href="../cookies.html">cookies</a></li><li><a href="../devtools.html">devtools</a></li><li><a href="../dns.html">dns</a></li><li><a href="../dom.html">dom</a></li><li><a href="../downloads.html">downloads</a></li><li><a href="../events.html">events</a></li><li><a href="../extension.html">extension</a></li><li><a href="../extensionTypes.html">extensionTypes</a></li><li><a href="../find.html">find</a></li><li><a href="../history.html">history</a></li><li><a href="../i18n.html">i18n</a></li><li><a href="../identity.html">identity</a></li><li><a href="../idle.html">idle</a></li><li><a href="../management.html">management</a></li><li><a href="../menus.html">menus</a></li><li><a href="../notifications.html">notifications</a></li><li><a href="../omnibox.html">omnibox</a></li><li><a href="../pageAction.html">pageAction</a></li><li><a href="../permissions.html">permissions</a></li><li><a href="../pkcs11.html">pkcs11</a></li><li><a href="../privacy.html">privacy</a></li><li><a href="../proxy.html">proxy</a></li><li><a href="../runtime.html">runtime</a></li><li><a href="../scripting.html">scripting</a></li><li><a href="../search.html">search</a></li><li><a href="../sessions.html">sessions</a></li><li><a href="../sidebarAction.html">sidebarAction</a></li><li><a href="../storage.html">storage</a></li><li><a href="../tabs.html">tabs</a></li><li><a href="../theme.html">theme</a></li><li><a href="../topSites.html">topSites</a></li><li><a href="../types.html">types</a></li><li><a href="../userScripts.html">userScripts</a></li><li><a href="../webNavigation.html">webNavigation</a></li><li class="webextension-api-sidebar"><a href="../webRequest.html">webRequest</a><ol><li data-default-state="open"><a href="#"><strong>Methods</strong></a><ol><li><a href="filterResponseData.html"><code>filterResponseData()</code></a></li><li><a href="getSecurityInfo.html"><code>getSecurityInfo()</code></a></li><li><a href="handlerBehaviorChanged.html"><code>handlerBehaviorChanged()</code></a></li></ol></li><li data-default-state="open"><a href="#"><strong>Properties</strong></a><ol><li><a href="MAX_HANDLER_BEHAVIOR_CHANGED_CALLS_PER_10_MINUTES.html"><code>MAX_HANDLER_BEHAVIOR_CHANGED_CALLS_PER_10_MINUTES</code></a></li></ol></li><li data-default-state="open"><a href="#"><strong>Types</strong></a><ol><li><a href="BlockingResponse.html"><code>BlockingResponse</code></a></li><li><a href="CertificateInfo.html"><code>CertificateInfo</code></a></li><li><a href="HttpHeaders.html"><code>HttpHeaders</code></a></li><li><a href="RequestFilter.html"><code>RequestFilter</code></a></li><li><a href="ResourceType.html"><code>ResourceType</code></a></li><li><a href="SecurityInfo.html"><code>SecurityInfo</code></a></li><li><a href="StreamFilter.html"><code>StreamFilter</code></a></li><li><a href="UploadData.html"><code>UploadData</code></a></li></ol></li><li data-default-state="open"><a href="#"><strong>Events</strong></a><ol><li><a href="onAuthRequired.html"><code>onAuthRequired</code></a></li><li><a href="onBeforeRedirect.html"><code>onBeforeRedirect</code></a></li><li><em><code>onBeforeRequest</code> </em></li><li><a href="onBeforeSendHeaders.html"><code>onBeforeSendHeaders</code></a></li><li><a href="onCompleted.html"><code>onCompleted</code></a></li><li><a href="onErrorOccurred.html"><code>onErrorOccurred</code></a></li><li><a href="onHeadersReceived.html"><code>onHeadersReceived</code></a></li><li><a href="onResponseStarted.html"><code>onResponseStarted</code></a></li><li><a href="onSendHeaders.html"><code>onSendHeaders</code></a></li></ol></li></ol></li><li><a href="../windows.html">windows</a></li></ol>
      </details>
    </li>
    <li class="toggle">
      <details>
      <summary>Manifest keys</summary>
        <ol>
          <li><a href="../../manifest.html">Introduction</a></li>
        </ol>
      <ol><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/action">action</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/author">author</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/background">background</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_action">browser_action</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_specific_settings">browser_specific_settings</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/chrome_settings_overrides">chrome_settings_overrides</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/chrome_url_overrides">chrome_url_overrides</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/commands">commands</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/content_scripts">content_scripts</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/content_security_policy">content_security_policy</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/default_locale">default_locale</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/description">description</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/developer">developer</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/devtools_page">devtools_page</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/dictionaries">dictionaries</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/externally_connectable">externally_connectable</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/homepage_url">homepage_url</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/host_permissions">host_permissions</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/icons">icons</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/incognito">incognito</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/manifest_version">manifest_version</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/name">name</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/offline_enabled">offline_enabled</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/omnibox">omnibox</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/optional_permissions">optional_permissions</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/options_page">options_page</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/options_ui">options_ui</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/page_action">page_action</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions">permissions</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/protocol_handlers">protocol_handlers</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/short_name">short_name</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/sidebar_action">sidebar_action</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/storage">storage</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/theme">theme</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/theme_experiment">theme_experiment</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/user_scripts">user_scripts</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/version">version</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/version_name">version_name</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/web_accessible_resources">web_accessible_resources</a></li></ol>
      </details>
    </li>
     <li class="toggle">
      <details>
        <summary>Extension Workshop</summary>
        <ol>
          <li><a href="https://extensionworkshop.com/documentation/develop/">Develop</a></li>
          <li><a href="https://extensionworkshop.com/documentation/publish/">Publish</a></li>
          <li><a href="https://extensionworkshop.com/documentation/manage/">Manage</a></li>
          <li><a href="https://extensionworkshop.com/documentation/enterprise/">Enterprise</a></li>
        </ol>
      </details>
    </li>
    <li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/Contact_us"><strong>Contact us</strong></a></li>
    <li class="toggle">
      <details>
        <summary>Channels</summary>
        <ol>
          <li><a href="https://blog.mozilla.org/addons">Add-ons blog</a></li>
          <li><a href="https://discourse.mozilla.org/c/add-ons">Add-ons forum</a></li>
          <li><a href="https://chat.mozilla.org/#/room/%23addons:mozilla.org">Add-ons chat</a></li>
        </ol>
      </details>
    </li>
  </ol>
</div></nav></aside><aside class="toc"><nav><div class="document-toc-container"><section class="document-toc"><header><h2 class="document-toc-heading">In this article</h2></header><ul class="document-toc-list"><li class="document-toc-item "><a class="document-toc-link" href="#syntax">Syntax</a></li><li class="document-toc-item "><a class="document-toc-link" href="#addlistener_syntax">addListener syntax</a></li><li class="document-toc-item "><a class="document-toc-link" href="#additional_objects">Additional objects</a></li><li class="document-toc-item "><a class="document-toc-link" href="#browser_compatibility">Browser compatibility</a></li><li class="document-toc-item "><a class="document-toc-link" href="#examples">Examples</a></li></ul></section></div></nav></aside><main id="content" class="main-content  "><article class="main-page-content" lang="en-US"><h1>webRequest.onBeforeRequest</h1><div class="section-content"><p>This event is triggered when a request is about to be made, and before headers are available. This is a good place to listen if you want to cancel or redirect the request.</p>
<p>To cancel or redirect the request, first include <code>"blocking"</code> in the <code>extraInfoSpec</code> array argument to <code>addListener()</code>. Then, in the listener function, return a <a href="BlockingResponse.html"><code>BlockingResponse</code></a> object, setting the appropriate property:</p>
<ul>
  <li>to cancel the request, include a property <code>cancel</code> with the value <code>true</code>.</li>
  <li>to redirect the request, include a property <code>redirectUrl</code> with the value set to the URL to which you want to redirect.</li>
</ul>
<p>If an extension wants to redirect a public (e.g. HTTPS) URL to an <a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Extension_pages">extension page</a>, the extension's manifest.json file must contain a <a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/web_accessible_resources">web_accessible_resources</a> key that lists the URL for the extension page.</p>
<p>When multiple blocking handlers modify a request, only one set of modifications take effect. Redirects and cancellations have the same precedence. So if you canceled a request, you might see another request with the same <code>requestId</code> again if another blocking handler redirected the request.</p>
<p>From Firefox 52 onwards, instead of returning <code>BlockingResponse</code>, the listener can return a <a href="../../../../../Web/JavaScript/Reference/Global_Objects/Promise.html"><code>Promise</code></a> which is resolved with a <code>BlockingResponse</code>. This enables the listener to process the request asynchronously.</p>
<p>If you use <code>"blocking"</code>, you must have the <a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions#api_permissions">"webRequestBlocking" API permission</a> in your manifest.json.</p></div><section aria-labelledby="syntax"><a class="dashAnchor" name="//apple_ref/Section/Syntax"></a><h2 id="syntax"><a href="#syntax">Syntax</a></h2><div class="section-content"><div class="code-example"><pre class="brush: js notranslate"><code>browser<span class="token punctuation">.</span>webRequest<span class="token punctuation">.</span>onBeforeRequest<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span>
  listener<span class="token punctuation">,</span>             <span class="token comment">// function</span>
  filter<span class="token punctuation">,</span>               <span class="token comment">//  object</span>
  extraInfoSpec         <span class="token comment">//  optional array of strings</span>
<span class="token punctuation">)</span>
browser<span class="token punctuation">.</span>webRequest<span class="token punctuation">.</span>onBeforeRequest<span class="token punctuation">.</span><span class="token function">removeListener</span><span class="token punctuation">(</span>listener<span class="token punctuation">)</span>
browser<span class="token punctuation">.</span>webRequest<span class="token punctuation">.</span>onBeforeRequest<span class="token punctuation">.</span><span class="token function">hasListener</span><span class="token punctuation">(</span>listener<span class="token punctuation">)</span>
</code></pre></div>
<p>Events have three functions:</p>
<dl>
  <dt id="addlistenercallback_filter_extrainfospec"><code>addListener(callback, filter, extraInfoSpec)</code></dt>
  <dd>
    <p>Adds a listener to this event.</p>
  </dd>
  <dt id="removelistenerlistener"><code>removeListener(listener)</code></dt>
  <dd>
    <p>Stop listening to this event. The <code>listener</code> argument is the listener to remove.</p>
  </dd>
  <dt id="haslistenerlistener"><code>hasListener(listener)</code></dt>
  <dd>
    <p>Check whether <code>listener</code> is registered for this event. Returns <code>true</code> if it is listening, <code>false</code> otherwise.</p>
  </dd>
</dl></div></section><section aria-labelledby="addlistener_syntax"><a class="dashAnchor" name="//apple_ref/Section/addListener%20syntax"></a><h2 id="addlistener_syntax"><a href="#addlistener_syntax">addListener syntax</a></h2><div class="section-content"></div></section><section aria-labelledby="parameters"><h3 id="parameters"><a href="#parameters">Parameters</a></h3><div class="section-content"><dl>
  <dt id="callback"><code>callback</code></dt>
  <dd>
    <p>Function that will be called when this event occurs. The function will be passed the following arguments:</p>
    <dl>
      <dt id="details"><code>details</code></dt>
      <dd>
        <p><code>object</code>. Details about the request. See the <a href="#details_2">details</a> section for more information.</p>
      </dd>
    </dl>
    <p>Returns: <a href="BlockingResponse.html"><code>webRequest.BlockingResponse</code></a>. If <code>"blocking"</code> is specified in the <code>extraInfoSpec</code> parameter, the event listener should return a <code>BlockingResponse</code> object, and can set either its <code>cancel</code> or its <code>redirectUrl</code> properties. From Firefox 52 onwards, instead of returning <code>BlockingResponse</code>, the listener can return a <a href="../../../../../Web/JavaScript/Reference/Global_Objects/Promise.html"><code>Promise</code></a> which is resolved with a <code>BlockingResponse</code>. This enables the listener to process the request asynchronously.</p>
  </dd>
  <dt id="filter"><code>filter</code></dt>
  <dd>
    <p><a href="RequestFilter.html"><code>webRequest.RequestFilter</code></a>. A filter that restricts the events that will be sent to this listener.</p>
  </dd>
  <dt id="extrainfospec"><code>extraInfoSpec</code> <span class="badge inline optional">Optional</span></dt>
  <dd>
    <p><code>array</code> of <code>string</code>. Extra options for the event. You can pass any of the following values:</p>
    <ul>
      <li><code>"blocking"</code>: make the request synchronous, so you can cancel or redirect the request</li>
      <li><code>"requestBody"</code>: include <code>requestBody</code> in the <code>details</code> object passed to the listener</li>
    </ul>
  </dd>
</dl></div></section><section aria-labelledby="additional_objects"><a class="dashAnchor" name="//apple_ref/Section/Additional%20objects"></a><h2 id="additional_objects"><a href="#additional_objects">Additional objects</a></h2><div class="section-content"></div></section><section aria-labelledby="details_2"><h3 id="details_2"><a href="#details_2">details</a></h3><div class="section-content"><dl>
  <dt id="cookiestoreid"><code>cookieStoreId</code></dt>
  <dd>
    <p><code>string</code>. If the request is from a tab open in a contextual identity, the cookie store ID of the contextual identity.</p>
  </dd>
  <dt id="documenturl"><code>documentUrl</code></dt>
  <dd>
    <p><code>string</code>. URL of the document in which the resource will be loaded. For example, if the web page at "<a href="https://example.com/" class="external" target="_blank">https://example.com</a>" contains an image or an iframe, then the <code>documentUrl</code> for the image or iframe will be "<a href="https://example.com/" class="external" target="_blank">https://example.com</a>". For a top-level document, <code>documentUrl</code> is undefined.</p>
  </dd>
  <dt id="frameancestors"><code>frameAncestors</code></dt>
  <dd>
    <p><code>array</code>. Contains information for each document in the frame hierarchy up to the top-level document. The first element in the array contains information about the immediate parent of the document being requested, and the last element contains information about the top-level document. If the load is actually for the top-level document, then this array is empty.</p>
    <dl>
      <dt id="url"><code>url</code></dt>
      <dd>
        <p><code>string</code>. The URL that the document was loaded from.</p>
      </dd>
      <dt id="frameid"><code>frameId</code></dt>
      <dd>
        <p><code>integer</code>. The <code>frameId</code> of the document. <code>details.frameAncestors[0].frameId</code> is the same as <code>details.parentFrameId</code>.</p>
      </dd>
    </dl>
  </dd>
  <dt id="frameid_2"><code>frameId</code></dt>
  <dd>
    <p><code>integer</code>. Zero if the request happens in the main frame; a positive value is the ID of a subframe in which the request happens. If the document of a (sub-)frame is loaded (<code>type</code> is <code>main_frame</code> or <code>sub_frame</code>), <code>frameId</code> indicates the ID of this frame, not the ID of the outer frame. Frame IDs are unique within a tab.</p>
  </dd>
  <dt id="incognito"><code>incognito</code></dt>
  <dd>
    <p><code>boolean</code>. Whether the request is from a private browsing window.</p>
  </dd>
  <dt id="method"><code>method</code></dt>
  <dd>
    <p><code>string</code>. Standard HTTP method: for example, "GET" or "POST".</p>
  </dd>
  <dt id="originurl"><code>originUrl</code></dt>
  <dd>
    <p><code>string</code>. URL of the resource which triggered the request. For example, if "<a href="https://example.com/" class="external" target="_blank">https://example.com</a>" contains a link, and the user clicks the link, then the <code>originUrl</code> for the resulting request is "<a href="https://example.com/" class="external" target="_blank">https://example.com</a>".</p>
    <p>The <code>originUrl</code> is often but not always the same as the <code>documentUrl</code>. For example, if a page contains an iframe, and the iframe contains a link that loads a new document into the iframe, then the <code>documentUrl</code> for the resulting request will be the iframe's parent document, but the <code>originUrl</code> will be the URL of the document in the iframe that contained the link.</p>
  </dd>
  <dt id="parentframeid"><code>parentFrameId</code></dt>
  <dd>
    <p><code>integer</code>. ID of the frame that contains the frame which sent the request. Set to -1 if no parent frame exists.</p>
  </dd>
  <dt id="proxyinfo"><code>proxyInfo</code></dt>
  <dd>
    <p><code>object</code>. This property is present only if the request is being proxied. It contains the following properties:</p>
    <dl>
      <dt id="host"><code>host</code></dt>
      <dd>
        <p><code>string</code>. The hostname of the proxy server.</p>
      </dd>
      <dt id="port"><code>port</code></dt>
      <dd>
        <p><code>integer</code>. The port number of the proxy server.</p>
      </dd>
      <dt id="type"><code>type</code></dt>
      <dd>
        <p><code>string</code>. The type of proxy server. One of:</p>
        <ul>
          <li>"http": HTTP proxy (or SSL CONNECT for HTTPS)</li>
          <li>"https": HTTP proxying over TLS connection to proxy</li>
          <li>"socks": SOCKS v5 proxy</li>
          <li>"socks4": SOCKS v4 proxy</li>
          <li>"direct": no proxy</li>
          <li>"unknown": unknown proxy</li>
        </ul>
      </dd>
      <dt id="username"><code>username</code></dt>
      <dd>
        <p><code>string</code>. Username for the proxy service.</p>
      </dd>
      <dt id="proxydns"><code>proxyDNS</code></dt>
      <dd>
        <p><code>boolean</code>. True if the proxy will perform domain name resolution based on the hostname supplied, meaning that the client should not do its own DNS lookup.</p>
      </dd>
      <dt id="failovertimeout"><code>failoverTimeout</code></dt>
      <dd>
        <p><code>integer</code>. Failover timeout in seconds. If the proxy connection fails, the proxy will not be used again for this period.</p>
      </dd>
    </dl>
  </dd>
  <dt id="requestbody"><code>requestBody</code> <span class="badge inline optional">Optional</span></dt>
  <dd>
    <p><code>object</code>. Contains the HTTP request body data. Only provided if <code>extraInfoSpec</code> contains <code>"requestBody"</code>.</p>
    <dl>
      <dt id="error"><code>error</code> <span class="badge inline optional">Optional</span></dt>
      <dd>
        <p><code>string</code>. This is set if any errors were encountered when obtaining request body data.</p>
      </dd>
      <dt id="formdata"><code>formData</code> <span class="badge inline optional">Optional</span></dt>
      <dd>
        <p><code>object</code>. This object is present if the request method is POST and the body is a sequence of key-value pairs encoded in UTF-8 as either "multipart/form-data" or "application/x-www-form-urlencoded".</p>
        <p>It is a dictionary in which each key contains the list of all values for that key. For example: <code>{'key': ['value1', 'value2']}</code>. If the data is of another media type, or if it is malformed, the object is not present.</p>
      </dd>
      <dt id="raw"><code>raw</code> <span class="badge inline optional">Optional</span></dt>
      <dd>
        <p><code>array</code> of <code><a href="UploadData.html"><code>webRequest.UploadData</code></a></code>. If the request method is PUT or POST, and the body is not already parsed in <code>formData</code>, then this array contains the unparsed request body elements.</p>
      </dd>
    </dl>
  </dd>
  <dt id="requestid"><code>requestId</code></dt>
  <dd>
    <p><code>string</code>. The ID of the request. Request IDs are unique within a browser session, so you can use them to relate different events associated with the same request.</p>
  </dd>
  <dt id="tabid"><code>tabId</code></dt>
  <dd>
    <p><code>integer</code>. ID of the tab in which the request takes place. Set to -1 if the request isn't related to a tab.</p>
  </dd>
  <dt id="thirdparty"><code>thirdParty</code></dt>
  <dd>
    <p><code>boolean</code>. Indicates whether the request and its content window hierarchy are third party.</p>
  </dd>
  <dt id="timestamp"><code>timeStamp</code></dt>
  <dd>
    <p><code>number</code>. The time when this event fired, in <a href="https://en.wikipedia.org/wiki/Unix_time" class="external" target="_blank">milliseconds since the epoch</a>.</p>
  </dd>
  <dt id="type_2"><code>type</code></dt>
  <dd>
    <p><a href="ResourceType.html"><code>webRequest.ResourceType</code></a>. The type of resource being requested: for example, "image", "script", "stylesheet".</p>
  </dd>
  <dt id="url_2"><code>url</code></dt>
  <dd>
    <p><code>string</code>. Target of the request.</p>
  </dd>
  <dt id="urlclassification"><code>urlClassification</code></dt>
  <dd>
    <p><code>object</code>. The type of tracking associated with the request, if with the request has been classified by <a href="https://support.mozilla.org/en-US/kb/enhanced-tracking-protection-firefox-desktop" class="external" target="_blank">Firefox Tracking Protection</a>. This is an object with the following properties:</p>
    <dl>
      <dt id="firstparty"><code>firstParty</code></dt>
      <dd>
        <p><code>array</code> of <code>strings</code>. Classification flags for the request's first party.</p>
      </dd>
      <dt id="thirdparty_2"><code>thirdParty</code></dt>
      <dd>
        <p><code>array</code> of <code>strings</code>. Classification flags for the request or its window hierarchy's third parties.</p>
      </dd>
    </dl>
    <p>The classification flags include:</p>
    <ul>
      <li><code>fingerprinting</code> and <code>fingerprinting_content</code>: indicates the request is involved in fingerprinting. <code>fingerprinting_content</code> indicates the request is loaded from an origin that has been found to fingerprint but is not considered to participate in tracking, such as a payment provider.</li>
      <li><code>cryptomining</code> and <code>cryptomining_content</code>: similar to the fingerprinting category but for cryptomining resources.</li>
      <li><code>tracking</code>, <code>tracking_ad</code>, <code>tracking_analytics</code>, <code>tracking_social</code>, and <code>tracking_content</code>: indicates the request is involved in tracking. <code>tracking</code> is any generic tracking request, the <code>ad</code>, <code>analytics</code>, <code>social</code>, and <code>content</code> suffixes identify the type of tracker.</li>
      <li><code>any_basic_tracking</code>: a meta flag that combines any tracking and fingerprinting flags, excluding <code>tracking_content</code> and <code>fingerprinting_content</code>.</li>
      <li><code>any_strict_tracking</code>: a meta flag that combines any tracking and fingerprinting flags, including <code>tracking_content</code> and <code>fingerprinting_content</code>.</li>
      <li><code>any_social_tracking</code>: a meta flag that combines any social tracking flags.</li>
    </ul>
  </dd>
</dl></div></section><a class="dashAnchor" name="//apple_ref/Section/Browser%20compatibility"></a><h2 id="browser_compatibility"><a href="#browser_compatibility">Browser compatibility</a></h2><p><table class="bc-table bc-table-web"><thead><tr class="bc-platforms"><td></td><th class="bc-platform bc-platform-desktop" colspan="5" title="desktop"><span class="icon icon-desktop"></span><span class="visually-hidden">desktop</span></th><th class="bc-platform bc-platform-mobile" colspan="2" title="mobile"><span class="icon icon-mobile"></span><span class="visually-hidden">mobile</span></th></tr><tr class="bc-browsers"><td></td><th class="bc-browser bc-browser-chrome"><div class="bc-head-txt-label bc-head-icon-chrome">Chrome</div><div class="bc-head-icon-symbol icon icon-chrome"></div></th><th class="bc-browser bc-browser-edge"><div class="bc-head-txt-label bc-head-icon-edge">Edge</div><div class="bc-head-icon-symbol icon icon-edge"></div></th><th class="bc-browser bc-browser-firefox"><div class="bc-head-txt-label bc-head-icon-firefox">Firefox</div><div class="bc-head-icon-symbol icon icon-simple-firefox"></div></th><th class="bc-browser bc-browser-opera"><div class="bc-head-txt-label bc-head-icon-opera">Opera</div><div class="bc-head-icon-symbol icon icon-opera"></div></th><th class="bc-browser bc-browser-safari"><div class="bc-head-txt-label bc-head-icon-safari">Safari</div><div class="bc-head-icon-symbol icon icon-safari"></div></th><th class="bc-browser bc-browser-firefox_android"><div class="bc-head-txt-label bc-head-icon-firefox_android">Firefox for Android</div><div class="bc-head-icon-symbol icon icon-simple-firefox"></div></th><th class="bc-browser bc-browser-safari_ios"><div class="bc-head-txt-label bc-head-icon-safari_ios">Safari on iOS</div><div class="bc-head-icon-symbol icon icon-safari"></div></th></tr></thead><tbody><tr><th class="bc-feature bc-feature-depth-0" scope="row"><div class="bc-table-row-header"><code>onBeforeRequest</code></div></th><td class="bc-support bc-browser-chrome bc-supports-yes bc-has-history" aria-expanded="false"><button type="button" title="Toggle history"><div class="bcd-cell-text-wrapper"><div class="bcd-cell-icons"><span class="icon-wrap"><abbr class="
              bc-level-yes
              icon
              icon-yes" title="Full support"><span class="bc-support-level">Full support</span></abbr></span></div><div class="bcd-cell-text-copy"><span class="bc-browser-name">Chrome</span><span class="bc-version-label">Yes</span></div><div class="bc-icons"><abbr class="only-icon" title="See implementation notes."><span>footnote</span><i class="icon icon-footnote"></i></abbr></div></div><span class="offscreen">Toggle history</span></button></td><td class="bc-support bc-browser-edge bc-supports-yes bc-has-history" aria-expanded="false"><button type="button" title="Toggle history"><div class="bcd-cell-text-wrapper"><div class="bcd-cell-icons"><span class="icon-wrap"><abbr class="
              bc-level-yes
              icon
              icon-yes" title="Full support"><span class="bc-support-level">Full support</span></abbr></span></div><div class="bcd-cell-text-copy"><span class="bc-browser-name">Edge</span><span class="bc-version-label" title="Released 2016-08-02">14</span></div><div class="bc-icons"><abbr class="only-icon" title="See implementation notes."><span>footnote</span><i class="icon icon-footnote"></i></abbr></div></div><span class="offscreen">Toggle history</span></button></td><td class="bc-support bc-browser-firefox bc-supports-yes bc-has-history" aria-expanded="false"><button type="button" title="Toggle history"><div class="bcd-cell-text-wrapper"><div class="bcd-cell-icons"><span class="icon-wrap"><abbr class="
              bc-level-yes
              icon
              icon-yes" title="Full support"><span class="bc-support-level">Full support</span></abbr></span></div><div class="bcd-cell-text-copy"><span class="bc-browser-name">Firefox</span><span class="bc-version-label" title="Released 2016-04-26">46</span></div><div class="bc-icons"><abbr class="only-icon" title="See implementation notes."><span>footnote</span><i class="icon icon-footnote"></i></abbr></div></div><span class="offscreen">Toggle history</span></button></td><td class="bc-support bc-browser-opera bc-supports-yes bc-has-history" aria-expanded="false"><button type="button" title="Toggle history"><div class="bcd-cell-text-wrapper"><div class="bcd-cell-icons"><span class="icon-wrap"><abbr class="
              bc-level-yes
              icon
              icon-yes" title="Full support"><span class="bc-support-level">Full support</span></abbr></span></div><div class="bcd-cell-text-copy"><span class="bc-browser-name">Opera</span><span class="bc-version-label">Yes</span></div><div class="bc-icons"><abbr class="only-icon" title="See implementation notes."><span>footnote</span><i class="icon icon-footnote"></i></abbr></div></div><span class="offscreen">Toggle history</span></button></td><td class="bc-support bc-browser-safari bc-supports-yes bc-has-history" aria-expanded="false"><button type="button" title="Toggle history"><div class="bcd-cell-text-wrapper"><div class="bcd-cell-icons"><span class="icon-wrap"><abbr class="
              bc-level-yes
              icon
              icon-yes" title="Full support"><span class="bc-support-level">Full support</span></abbr></span></div><div class="bcd-cell-text-copy"><span class="bc-browser-name">Safari</span><span class="bc-version-label" title="Released 2020-09-16">14</span></div><div class="bc-icons"><abbr class="only-icon" title="See implementation notes."><span>footnote</span><i class="icon icon-footnote"></i></abbr></div></div><span class="offscreen">Toggle history</span></button></td><td class="bc-support bc-browser-firefox_android bc-supports-yes bc-has-history" aria-expanded="false"><button type="button" title="Toggle history"><div class="bcd-cell-text-wrapper"><div class="bcd-cell-icons"><span class="icon-wrap"><abbr class="
              bc-level-yes
              icon
              icon-yes" title="Full support"><span class="bc-support-level">Full support</span></abbr></span></div><div class="bcd-cell-text-copy"><span class="bc-browser-name">Firefox for Android</span><span class="bc-version-label" title="Released 2016-08-02">48</span></div><div class="bc-icons"><abbr class="only-icon" title="See implementation notes."><span>footnote</span><i class="icon icon-footnote"></i></abbr></div></div><span class="offscreen">Toggle history</span></button></td><td class="bc-support bc-browser-safari_ios bc-supports-no bc-has-history" aria-expanded="false"><button type="button" title="Toggle history"><div class="bcd-cell-text-wrapper"><div class="bcd-cell-icons"><span class="icon-wrap"><abbr class="
              bc-level-no
              icon
              icon-no" title="No support"><span class="bc-support-level">No support</span></abbr></span></div><div class="bcd-cell-text-copy"><span class="bc-browser-name">Safari on iOS</span><span class="bc-version-label">No</span></div></div><span class="offscreen">Toggle history</span></button></td></tr></tbody></table></p><section aria-labelledby="dns_resolution_ordering_when_blockingresponse_is_used"><h3 id="dns_resolution_ordering_when_blockingresponse_is_used"><a href="#dns_resolution_ordering_when_blockingresponse_is_used">DNS resolution ordering when BlockingResponse is used</a></h3><div class="section-content"><p>Regarding DNS resolution when BlockingResponse is used with OnBeforeRequest: In HTTP Channel, onBeforeRequest with blocking response does happen prior to DNS resolution and also prior to speculative connect. For other channels, speculative connect may cause DNS requests to happen before onBeforeRequest. This ordering is not something an extension developer ought to rely on as it may vary across browsers, and from one browser version to another, let alone one request channel to another. Refer <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1466099" class="external" target="_blank">BugZilla issue clarification provided by Mozilla developers on DNS resolution ordering</a></p></div></section><section aria-labelledby="examples"><a class="dashAnchor" name="//apple_ref/Section/Examples"></a><h2 id="examples"><a href="#examples">Examples</a></h2><div class="section-content"><p>This code logs the URL for every resource requested which matches the <a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Match_patterns#all_urls">&lt;all_urls&gt;</a> pattern:</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token keyword">function</span> <span class="token function">logURL</span><span class="token punctuation">(</span><span class="token parameter">requestDetails</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Loading: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>requestDetails<span class="token punctuation">.</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

browser<span class="token punctuation">.</span>webRequest<span class="token punctuation">.</span>onBeforeRequest<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span>
  logURL<span class="token punctuation">,</span>
  <span class="token punctuation">{</span><span class="token literal-property property">urls</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"&lt;all_urls&gt;"</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>This code cancels requests for images that are made to URLs under "<a href="https://developer.mozilla.org/">https://developer.mozilla.org/</a>" (to see the effect, visit any page on MDN that contains images, such as <a href="../webRequest.html">webRequest</a>):</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token comment">// match pattern for the URLs to redirect</span>
<span class="token keyword">let</span> pattern <span class="token operator">=</span> <span class="token string">"https://developer.mozilla.org/*"</span><span class="token punctuation">;</span>

<span class="token comment">// cancel function returns an object</span>
<span class="token comment">// which contains a property `cancel` set to `true`</span>
<span class="token keyword">function</span> <span class="token function">cancel</span><span class="token punctuation">(</span><span class="token parameter">requestDetails</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Canceling: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>requestDetails<span class="token punctuation">.</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">cancel</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// add the listener,</span>
<span class="token comment">// passing the filter argument and "blocking"</span>
browser<span class="token punctuation">.</span>webRequest<span class="token punctuation">.</span>onBeforeRequest<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span>
  cancel<span class="token punctuation">,</span>
  <span class="token punctuation">{</span><span class="token literal-property property">urls</span><span class="token operator">:</span> <span class="token punctuation">[</span>pattern<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token literal-property property">types</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"image"</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">"blocking"</span><span class="token punctuation">]</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>This code replaces, by redirection, all network requests for images that are made to URLs under "<a href="https://developer.mozilla.org/">https://developer.mozilla.org/</a>" (to see the effect, visit any page on MDN that contains images, such as <a href="../webRequest.html">webRequest</a>):</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token comment">// match pattern for the URLs to redirect</span>
<span class="token keyword">let</span> pattern <span class="token operator">=</span> <span class="token string">"https://developer.mozilla.org/*"</span><span class="token punctuation">;</span>

<span class="token comment">// redirect function</span>
<span class="token comment">// returns an object with a property `redirectURL`</span>
<span class="token comment">// set to the new URL</span>
<span class="token keyword">function</span> <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token parameter">requestDetails</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Redirecting: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>requestDetails<span class="token punctuation">.</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">redirectUrl</span><span class="token operator">:</span> <span class="token string">"https://38.media.tumblr.com/tumblr_ldbj01lZiP1qe0eclo1_500.gif"</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// add the listener,</span>
<span class="token comment">// passing the filter argument and "blocking"</span>
browser<span class="token punctuation">.</span>webRequest<span class="token punctuation">.</span>onBeforeRequest<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span>
  redirect<span class="token punctuation">,</span>
  <span class="token punctuation">{</span><span class="token literal-property property">urls</span><span class="token operator">:</span><span class="token punctuation">[</span>pattern<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token literal-property property">types</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">"image"</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">"blocking"</span><span class="token punctuation">]</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>This code is exactly like the previous example, except that the listener handles the request asynchronously. It returns a <a href="../../../../../Web/JavaScript/Reference/Global_Objects/Promise.html"><code>Promise</code></a> that sets a timer, and resolves with the redirect URL when the timer expires:</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token comment">// match pattern for the URLs to redirect</span>
<span class="token keyword">let</span> pattern <span class="token operator">=</span> <span class="token string">"https://developer.mozilla.org/*"</span><span class="token punctuation">;</span>

<span class="token comment">// URL we will redirect to</span>
<span class="token keyword">let</span> redirectUrl <span class="token operator">=</span> <span class="token string">"https://38.media.tumblr.com/tumblr_ldbj01lZiP1qe0eclo1_500.gif"</span><span class="token punctuation">;</span>

<span class="token comment">// redirect function returns a Promise</span>
<span class="token comment">// which is resolved with the redirect URL when a timer expires</span>
<span class="token keyword">function</span> <span class="token function">redirectAsync</span><span class="token punctuation">(</span><span class="token parameter">requestDetails</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Redirecting async: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>requestDetails<span class="token punctuation">.</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span> redirectUrl <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// add the listener,</span>
<span class="token comment">// passing the filter argument and "blocking"</span>
browser<span class="token punctuation">.</span>webRequest<span class="token punctuation">.</span>onBeforeRequest<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span>
  redirectAsync<span class="token punctuation">,</span>
  <span class="token punctuation">{</span><span class="token literal-property property">urls</span><span class="token operator">:</span> <span class="token punctuation">[</span>pattern<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token literal-property property">types</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"image"</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">"blocking"</span><span class="token punctuation">]</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>Another example, that redirects all images to a data URL:</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token keyword">let</span> pattern <span class="token operator">=</span> <span class="token string">"https://developer.mozilla.org/*"</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> image <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  &lt;svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%"&gt;
    &lt;rect style="stroke-width: 10; stroke: #666;" width="100%" height="100%" fill="#d4d0c8" /&gt;
    &lt;text transform="translate(0, 9)" x="50%" y="50%" width="100%" fill="#666" height="100%" style="text-anchor: middle; font: bold 10pt 'Segoe UI', Arial, Helvetica, Sans-serif;"&gt;Blocked&lt;/text&gt;
  &lt;/svg&gt;
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">listener</span><span class="token punctuation">(</span><span class="token parameter">details</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> redirectUrl <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">data:image/svg+xml,</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">encodeURIComponent</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span> redirectUrl <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

browser<span class="token punctuation">.</span>webRequest<span class="token punctuation">.</span>onBeforeRequest<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span>
  listener<span class="token punctuation">,</span>
  <span class="token punctuation">{</span><span class="token literal-property property">urls</span><span class="token operator">:</span> <span class="token punctuation">[</span>pattern<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token literal-property property">types</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"image"</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">"blocking"</span><span class="token punctuation">]</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>Here's another version:</p>
<div class="code-example"><pre class="brush: js notranslate"><code><span class="token keyword">function</span> <span class="token function">randomColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">#</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">16777215</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> pattern <span class="token operator">=</span> <span class="token string">"https://developer.mozilla.org/*"</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> image <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  &lt;svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%"&gt;
    &lt;rect width="100%" height="100%" fill="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">randomColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">"/&gt;
  &lt;/svg&gt;
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">listener</span><span class="token punctuation">(</span><span class="token parameter">details</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> redirectUrl <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">data:image/svg+xml,</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">encodeURIComponent</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span> redirectUrl <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

browser<span class="token punctuation">.</span>webRequest<span class="token punctuation">.</span>onBeforeRequest<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span>
  listener<span class="token punctuation">,</span>
  <span class="token punctuation">{</span><span class="token literal-property property">urls</span><span class="token operator">:</span> <span class="token punctuation">[</span>pattern<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token literal-property property">types</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"image"</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">"blocking"</span><span class="token punctuation">]</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div></section><section aria-labelledby="example_extensions"><h3 id="example_extensions"><a href="#example_extensions">Example extensions</a></h3><div class="section-content"><ul><li><a href="https://github.com/mdn/webextensions-examples/tree/master/http-response" class="external" target="_blank">http-response</a></li></ul>
<div class="notecard note" id="sect2">
  <p><strong>Note:</strong> This API is based on Chromium's <a href="https://developer.chrome.com/docs/extensions/reference/webRequest/#event-onBeforeRequest" class="external" target="_blank"><code>chrome.webRequest</code></a> API. This documentation is derived from <a href="https://chromium.googlesource.com/chromium/src/+/master/extensions/common/api/web_request.json" class="external" target="_blank"><code>web_request.json</code></a> in the Chromium code.</p>
</div><!--
// Copyright 2015 The Chromium Authors. All rights reserved.
//
// Redistribution and use in source and binary forms, with or without
// modification, are permitted provided that the following conditions are
// met:
//
//    * Redistributions of source code must retain the above copyright
// notice, this list of conditions and the following disclaimer.
//    * Redistributions in binary form must reproduce the above
// copyright notice, this list of conditions and the following disclaimer
// in the documentation and/or other materials provided with the
// distribution.
//    * Neither the name of Google Inc. nor the names of its
// contributors may be used to endorse or promote products derived from
// this software without specific prior written permission.
//
// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
// "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
--></div></section><aside class="metadata"><div class="metadata-content-container"><div id="on-github" class="on-github"><h3>Found a content problem with this page?</h3><ul><li>Edit the page <a href="https://github.com/mdn/content/edit/main/files/en-us/mozilla/add-ons/webextensions/api/webrequest/onbeforerequest/index.md" title="This will take you to GitHub, where you'll need to sign in first." target="_blank" rel="noopener noreferrer">on GitHub</a>.</li><li>Report the <a href="https://github.com/mdn/content/issues/new?template=page-report.yml&amp;mdn-url=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FMozilla%2FAdd-ons%2FWebExtensions%2FAPI%2FwebRequest%2FonBeforeRequest&amp;metadata=%3C%21--+Do+not+make+changes+below+this+line+--%3E%0A%3Cdetails%3E%0A%3Csummary%3EPage+report+details%3C%2Fsummary%3E%0A%0A*+Folder%3A+%60en-us%2Fmozilla%2Fadd-ons%2Fwebextensions%2Fapi%2Fwebrequest%2Fonbeforerequest%60%0A*+MDN+URL%3A+https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FMozilla%2FAdd-ons%2FWebExtensions%2FAPI%2FwebRequest%2FonBeforeRequest%0A*+GitHub+URL%3A+https%3A%2F%2Fgithub.com%2Fmdn%2Fcontent%2Fblob%2Fmain%2Ffiles%2Fen-us%2Fmozilla%2Fadd-ons%2Fwebextensions%2Fapi%2Fwebrequest%2Fonbeforerequest%2Findex.md%0A*+Last+commit%3A+https%3A%2F%2Fgithub.com%2Fmdn%2Fcontent%2Fcommit%2F915cae6eac9c6ab3cf2e5c03f8bcedb91a414b1d%0A*+Document+last+modified%3A+2022-12-15T03%3A18%3A02.000Z%0A%0A%3C%2Fdetails%3E" title="This will take you to GitHub to file a new issue." target="_blank" rel="noopener noreferrer">content issue</a>.</li><li>View the source <a href="https://github.com/mdn/content/blob/main/files/en-us/mozilla/add-ons/webextensions/api/webrequest/onbeforerequest/index.md?plain=1" title="Folder: en-us/mozilla/add-ons/webextensions/api/webrequest/onbeforerequest (Opens in a new tab)" target="_blank" rel="noopener noreferrer">on GitHub</a>.</li></ul>Want to get more involved? Learn<!-- --> <a href="https://github.com/mdn/content/blob/main/CONTRIBUTING.md" title="This will take you to our contribution guidelines on GitHub." target="_blank" rel="noopener noreferrer">how to contribute</a>.</div><p class="last-modified-date">This page was last modified on<!-- --> <time datetime="2022-12-15T03:18:02.000Z">Dec 15, 2022</time> by<!-- --> <a href="onBeforeRequest/contributors.txt">MDN contributors</a>.</p></div></aside></article></main></div><footer id="nav-footer" class="page-footer"><div><a href="http://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/onBeforeRequest">webRequest.onBeforeRequest</a> by <a href="http://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/onBeforeRequest$history">Mozilla Contributors</a> is licensed under <a href="http://creativecommons.org/licenses/by-sa/2.5/">CC-BY-SA 2.5</a>.</div></footer></div></div><script type="application/json" id="hydration">{"doc":{"isMarkdown":true,"isTranslated":false,"isActive":true,"flaws":{},"title":"webRequest.onBeforeRequest","mdn_url":"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/onBeforeRequest","locale":"en-US","native":"English (US)","browserCompat":["webextensions.api.webRequest.onBeforeRequest"],"sidebarHTML":"\n  <ol>\n    <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions\"><strong>Browser extensions</strong></a></li>\n    <li class=\"toggle\">\n      <details>\n        <summary>Getting started</summary>\n        <ol>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/What_are_WebExtensions\">What are extensions?</a></li>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Your_first_WebExtension\">Your first extension</a></li>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Your_second_WebExtension\">Your second extension</a></li>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Anatomy_of_a_WebExtension\">Anatomy of an extension</a></li>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Examples\">Example extensions</a></li>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/What_next_\">What next?</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary>Concepts</summary>\n        <ol>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Using_the_JavaScript_APIs\">Using the JavaScript APIs</a></li>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Content_scripts\">Content scripts</a></li>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Background_scripts\">Background scripts</a></li>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Match_patterns\">Match patterns</a></li>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Working_with_files\">Working with files</a></li>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Internationalization\">Internationalization</a></li>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Content_Security_Policy\">Content Security Policy</a></li>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Native_messaging\">Native messaging</a></li>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Differences_between_API_implementations\">Differences between API implementations</a></li>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Chrome_incompatibilities\">Chrome incompatibilities</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary>User interface</summary>\n        <ol>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface\">User Interface</a></li>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Browser_action\">Toolbar button</a></li>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Page_actions\">Address bar button</a></li>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Sidebars\">Sidebars</a></li>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Context_menu_items\">Context menu items</a></li>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Options_pages\">Options page</a></li>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Extension_pages\">Extension pages</a></li>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Notifications\">Notifications</a></li>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Omnibox\">Address bar suggestions</a></li>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/devtools_panels\">Developer tools panels</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary>How to</summary>\n        <ol>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Intercept_HTTP_requests\">Intercept HTTP requests</a></li>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Modify_a_web_page\">Modify a web page</a></li>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Safely_inserting_external_content_into_a_page\">Insert external content</a></li>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Sharing_objects_with_page_scripts\">Share objects with page scripts</a></li>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Add_a_button_to_the_toolbar\">Add a button to the toolbar</a></li>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Implement_a_settings_page\">Implement a settings page</a></li>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Working_with_the_Tabs_API\">Work with the Tabs API</a></li>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Work_with_the_Bookmarks_API\">Work with the Bookmarks API</a></li>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Work_with_the_Cookies_API\">Work with the Cookies API</a></li>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Work_with_contextual_identities\">Work with contextual identities</a></li>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Interact_with_the_clipboard\">Interact with the clipboard</a></li>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Extending_the_developer_tools\">Extending the developer tools</a></li>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Build_a_cross_browser_extension\">Build a cross-browser extension</a></li>\n        </ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n        <summary><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Firefox_differentiators\">Firefox differentiators</a></summary>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details open=\"\">\n        <summary>JavaScript APIs</summary>\n        <ol><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Browser_support_for_JavaScript_APIs\">Browser support for JavaScript APIs</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/action\">action</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/alarms\">alarms</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/bookmarks\">bookmarks</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/browserAction\">browserAction</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/browserSettings\">browserSettings</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/browsingData\">browsingData</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/captivePortal\">captivePortal</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/clipboard\">clipboard</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/commands\">commands</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/contentScripts\">contentScripts</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/contextualIdentities\">contextualIdentities</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/cookies\">cookies</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/devtools\">devtools</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/dns\">dns</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/dom\">dom</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/downloads\">downloads</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/events\">events</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/extension\">extension</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/extensionTypes\">extensionTypes</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/find\">find</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/history\">history</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/i18n\">i18n</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/identity\">identity</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/idle\">idle</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/management\">management</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/menus\">menus</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/notifications\">notifications</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/omnibox\">omnibox</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/pageAction\">pageAction</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/permissions\">permissions</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/pkcs11\">pkcs11</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/privacy\">privacy</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/proxy\">proxy</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime\">runtime</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/scripting\">scripting</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/search\">search</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/sessions\">sessions</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/sidebarAction\">sidebarAction</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/storage\">storage</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs\">tabs</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/theme\">theme</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/topSites\">topSites</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/types\">types</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/userScripts\">userScripts</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webNavigation\">webNavigation</a></li><li class=\"webextension-api-sidebar\"><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest\">webRequest</a><ol><li data-default-state=\"open\"><a href=\"#\"><strong>Methods</strong></a><ol><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/filterResponseData\"><code>filterResponseData()</code></a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/getSecurityInfo\"><code>getSecurityInfo()</code></a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/handlerBehaviorChanged\"><code>handlerBehaviorChanged()</code></a></li></ol></li><li data-default-state=\"open\"><a href=\"#\"><strong>Properties</strong></a><ol><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/MAX_HANDLER_BEHAVIOR_CHANGED_CALLS_PER_10_MINUTES\"><code>MAX_HANDLER_BEHAVIOR_CHANGED_CALLS_PER_10_MINUTES</code></a></li></ol></li><li data-default-state=\"open\"><a href=\"#\"><strong>Types</strong></a><ol><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/BlockingResponse\"><code>BlockingResponse</code></a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/CertificateInfo\"><code>CertificateInfo</code></a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/HttpHeaders\"><code>HttpHeaders</code></a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/RequestFilter\"><code>RequestFilter</code></a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/ResourceType\"><code>ResourceType</code></a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/SecurityInfo\"><code>SecurityInfo</code></a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/StreamFilter\"><code>StreamFilter</code></a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/UploadData\"><code>UploadData</code></a></li></ol></li><li data-default-state=\"open\"><a href=\"#\"><strong>Events</strong></a><ol><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/onAuthRequired\"><code>onAuthRequired</code></a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/onBeforeRedirect\"><code>onBeforeRedirect</code></a></li><li><em><code>onBeforeRequest</code> </em></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/onBeforeSendHeaders\"><code>onBeforeSendHeaders</code></a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/onCompleted\"><code>onCompleted</code></a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/onErrorOccurred\"><code>onErrorOccurred</code></a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/onHeadersReceived\"><code>onHeadersReceived</code></a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/onResponseStarted\"><code>onResponseStarted</code></a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/onSendHeaders\"><code>onSendHeaders</code></a></li></ol></li></ol></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/windows\">windows</a></li></ol>\n      </details>\n    </li>\n    <li class=\"toggle\">\n      <details>\n      <summary>Manifest keys</summary>\n        <ol>\n          <li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json\">Introduction</a></li>\n        </ol>\n      <ol><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/action\">action</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/author\">author</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/background\">background</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_action\">browser_action</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_specific_settings\">browser_specific_settings</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/chrome_settings_overrides\">chrome_settings_overrides</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/chrome_url_overrides\">chrome_url_overrides</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/commands\">commands</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/content_scripts\">content_scripts</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/content_security_policy\">content_security_policy</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/default_locale\">default_locale</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/description\">description</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/developer\">developer</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/devtools_page\">devtools_page</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/dictionaries\">dictionaries</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/externally_connectable\">externally_connectable</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/homepage_url\">homepage_url</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/host_permissions\">host_permissions</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/icons\">icons</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/incognito\">incognito</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/manifest_version\">manifest_version</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/name\">name</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/offline_enabled\">offline_enabled</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/omnibox\">omnibox</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/optional_permissions\">optional_permissions</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/options_page\">options_page</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/options_ui\">options_ui</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/page_action\">page_action</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions\">permissions</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/protocol_handlers\">protocol_handlers</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/short_name\">short_name</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/sidebar_action\">sidebar_action</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/storage\">storage</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/theme\">theme</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/theme_experiment\">theme_experiment</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/user_scripts\">user_scripts</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/version\">version</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/version_name\">version_name</a></li><li><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/web_accessible_resources\">web_accessible_resources</a></li></ol>\n      </details>\n    </li>\n     <li class=\"toggle\">\n      <details>\n        <summary>Extension Workshop</summary>\n        <ol>\n          <li><a href=\"https://extensionworkshop.com/documentation/develop/\">Develop</a></li>\n          <li><a href=\"https://extensionworkshop.com/documentation/publish/\">Publish</a></li>\n          <li><a href=\"https://extensionworkshop.com/documentation/manage/\">Manage</a></li>\n          <li><a href=\"https://extensionworkshop.com/documentation/enterprise/\">Enterprise</a></li>\n        </ol>\n      </details>\n    </li>\n    <li><a href=\"/en-US/docs/Mozilla/Add-ons/Contact_us\"><strong>Contact us</strong></a></li>\n    <li class=\"toggle\">\n      <details>\n        <summary>Channels</summary>\n        <ol>\n          <li><a href=\"https://blog.mozilla.org/addons\">Add-ons blog</a></li>\n          <li><a href=\"https://discourse.mozilla.org/c/add-ons\">Add-ons forum</a></li>\n          <li><a href=\"https://chat.mozilla.org/#/room/%23addons:mozilla.org\">Add-ons chat</a></li>\n        </ol>\n      </details>\n    </li>\n  </ol>\n","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<p>This event is triggered when a request is about to be made, and before headers are available. This is a good place to listen if you want to cancel or redirect the request.</p>\n<p>To cancel or redirect the request, first include <code>\"blocking\"</code> in the <code>extraInfoSpec</code> array argument to <code>addListener()</code>. Then, in the listener function, return a <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/BlockingResponse\"><code>BlockingResponse</code></a> object, setting the appropriate property:</p>\n<ul>\n  <li>to cancel the request, include a property <code>cancel</code> with the value <code>true</code>.</li>\n  <li>to redirect the request, include a property <code>redirectUrl</code> with the value set to the URL to which you want to redirect.</li>\n</ul>\n<p>If an extension wants to redirect a public (e.g. HTTPS) URL to an <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/user_interface/Extension_pages\">extension page</a>, the extension's manifest.json file must contain a <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/web_accessible_resources\">web_accessible_resources</a> key that lists the URL for the extension page.</p>\n<p>When multiple blocking handlers modify a request, only one set of modifications take effect. Redirects and cancellations have the same precedence. So if you canceled a request, you might see another request with the same <code>requestId</code> again if another blocking handler redirected the request.</p>\n<p>From Firefox 52 onwards, instead of returning <code>BlockingResponse</code>, the listener can return a <a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise\"><code>Promise</code></a> which is resolved with a <code>BlockingResponse</code>. This enables the listener to process the request asynchronously.</p>\n<p>If you use <code>\"blocking\"</code>, you must have the <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions#api_permissions\">\"webRequestBlocking\" API permission</a> in your manifest.json.</p>"}},{"type":"prose","value":{"id":"syntax","title":"Syntax","isH3":false,"content":"<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code>browser<span class=\"token punctuation\">.</span>webRequest<span class=\"token punctuation\">.</span>onBeforeRequest<span class=\"token punctuation\">.</span><span class=\"token function\">addListener</span><span class=\"token punctuation\">(</span>\n  listener<span class=\"token punctuation\">,</span>             <span class=\"token comment\">// function</span>\n  filter<span class=\"token punctuation\">,</span>               <span class=\"token comment\">//  object</span>\n  extraInfoSpec         <span class=\"token comment\">//  optional array of strings</span>\n<span class=\"token punctuation\">)</span>\nbrowser<span class=\"token punctuation\">.</span>webRequest<span class=\"token punctuation\">.</span>onBeforeRequest<span class=\"token punctuation\">.</span><span class=\"token function\">removeListener</span><span class=\"token punctuation\">(</span>listener<span class=\"token punctuation\">)</span>\nbrowser<span class=\"token punctuation\">.</span>webRequest<span class=\"token punctuation\">.</span>onBeforeRequest<span class=\"token punctuation\">.</span><span class=\"token function\">hasListener</span><span class=\"token punctuation\">(</span>listener<span class=\"token punctuation\">)</span>\n</code></pre></div>\n<p>Events have three functions:</p>\n<dl>\n  <dt id=\"addlistenercallback_filter_extrainfospec\"><code>addListener(callback, filter, extraInfoSpec)</code></dt>\n  <dd>\n    <p>Adds a listener to this event.</p>\n  </dd>\n  <dt id=\"removelistenerlistener\"><code>removeListener(listener)</code></dt>\n  <dd>\n    <p>Stop listening to this event. The <code>listener</code> argument is the listener to remove.</p>\n  </dd>\n  <dt id=\"haslistenerlistener\"><code>hasListener(listener)</code></dt>\n  <dd>\n    <p>Check whether <code>listener</code> is registered for this event. Returns <code>true</code> if it is listening, <code>false</code> otherwise.</p>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"addlistener_syntax","title":"addListener syntax","isH3":false,"content":""}},{"type":"prose","value":{"id":"parameters","title":"Parameters","isH3":true,"content":"<dl>\n  <dt id=\"callback\"><code>callback</code></dt>\n  <dd>\n    <p>Function that will be called when this event occurs. The function will be passed the following arguments:</p>\n    <dl>\n      <dt id=\"details\"><code>details</code></dt>\n      <dd>\n        <p><code>object</code>. Details about the request. See the <a href=\"#details_2\">details</a> section for more information.</p>\n      </dd>\n    </dl>\n    <p>Returns: <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/BlockingResponse\"><code>webRequest.BlockingResponse</code></a>. If <code>\"blocking\"</code> is specified in the <code>extraInfoSpec</code> parameter, the event listener should return a <code>BlockingResponse</code> object, and can set either its <code>cancel</code> or its <code>redirectUrl</code> properties. From Firefox 52 onwards, instead of returning <code>BlockingResponse</code>, the listener can return a <a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise\"><code>Promise</code></a> which is resolved with a <code>BlockingResponse</code>. This enables the listener to process the request asynchronously.</p>\n  </dd>\n  <dt id=\"filter\"><code>filter</code></dt>\n  <dd>\n    <p><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/RequestFilter\"><code>webRequest.RequestFilter</code></a>. A filter that restricts the events that will be sent to this listener.</p>\n  </dd>\n  <dt id=\"extrainfospec\"><code>extraInfoSpec</code> <span class=\"badge inline optional\">Optional</span></dt>\n  <dd>\n    <p><code>array</code> of <code>string</code>. Extra options for the event. You can pass any of the following values:</p>\n    <ul>\n      <li><code>\"blocking\"</code>: make the request synchronous, so you can cancel or redirect the request</li>\n      <li><code>\"requestBody\"</code>: include <code>requestBody</code> in the <code>details</code> object passed to the listener</li>\n    </ul>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"additional_objects","title":"Additional objects","isH3":false,"content":""}},{"type":"prose","value":{"id":"details_2","title":"details","isH3":true,"content":"<dl>\n  <dt id=\"cookiestoreid\"><code>cookieStoreId</code></dt>\n  <dd>\n    <p><code>string</code>. If the request is from a tab open in a contextual identity, the cookie store ID of the contextual identity.</p>\n  </dd>\n  <dt id=\"documenturl\"><code>documentUrl</code></dt>\n  <dd>\n    <p><code>string</code>. URL of the document in which the resource will be loaded. For example, if the web page at \"<a href=\"https://example.com\" class=\"external\" target=\"_blank\">https://example.com</a>\" contains an image or an iframe, then the <code>documentUrl</code> for the image or iframe will be \"<a href=\"https://example.com\" class=\"external\" target=\"_blank\">https://example.com</a>\". For a top-level document, <code>documentUrl</code> is undefined.</p>\n  </dd>\n  <dt id=\"frameancestors\"><code>frameAncestors</code></dt>\n  <dd>\n    <p><code>array</code>. Contains information for each document in the frame hierarchy up to the top-level document. The first element in the array contains information about the immediate parent of the document being requested, and the last element contains information about the top-level document. If the load is actually for the top-level document, then this array is empty.</p>\n    <dl>\n      <dt id=\"url\"><code>url</code></dt>\n      <dd>\n        <p><code>string</code>. The URL that the document was loaded from.</p>\n      </dd>\n      <dt id=\"frameid\"><code>frameId</code></dt>\n      <dd>\n        <p><code>integer</code>. The <code>frameId</code> of the document. <code>details.frameAncestors[0].frameId</code> is the same as <code>details.parentFrameId</code>.</p>\n      </dd>\n    </dl>\n  </dd>\n  <dt id=\"frameid_2\"><code>frameId</code></dt>\n  <dd>\n    <p><code>integer</code>. Zero if the request happens in the main frame; a positive value is the ID of a subframe in which the request happens. If the document of a (sub-)frame is loaded (<code>type</code> is <code>main_frame</code> or <code>sub_frame</code>), <code>frameId</code> indicates the ID of this frame, not the ID of the outer frame. Frame IDs are unique within a tab.</p>\n  </dd>\n  <dt id=\"incognito\"><code>incognito</code></dt>\n  <dd>\n    <p><code>boolean</code>. Whether the request is from a private browsing window.</p>\n  </dd>\n  <dt id=\"method\"><code>method</code></dt>\n  <dd>\n    <p><code>string</code>. Standard HTTP method: for example, \"GET\" or \"POST\".</p>\n  </dd>\n  <dt id=\"originurl\"><code>originUrl</code></dt>\n  <dd>\n    <p><code>string</code>. URL of the resource which triggered the request. For example, if \"<a href=\"https://example.com\" class=\"external\" target=\"_blank\">https://example.com</a>\" contains a link, and the user clicks the link, then the <code>originUrl</code> for the resulting request is \"<a href=\"https://example.com\" class=\"external\" target=\"_blank\">https://example.com</a>\".</p>\n    <p>The <code>originUrl</code> is often but not always the same as the <code>documentUrl</code>. For example, if a page contains an iframe, and the iframe contains a link that loads a new document into the iframe, then the <code>documentUrl</code> for the resulting request will be the iframe's parent document, but the <code>originUrl</code> will be the URL of the document in the iframe that contained the link.</p>\n  </dd>\n  <dt id=\"parentframeid\"><code>parentFrameId</code></dt>\n  <dd>\n    <p><code>integer</code>. ID of the frame that contains the frame which sent the request. Set to -1 if no parent frame exists.</p>\n  </dd>\n  <dt id=\"proxyinfo\"><code>proxyInfo</code></dt>\n  <dd>\n    <p><code>object</code>. This property is present only if the request is being proxied. It contains the following properties:</p>\n    <dl>\n      <dt id=\"host\"><code>host</code></dt>\n      <dd>\n        <p><code>string</code>. The hostname of the proxy server.</p>\n      </dd>\n      <dt id=\"port\"><code>port</code></dt>\n      <dd>\n        <p><code>integer</code>. The port number of the proxy server.</p>\n      </dd>\n      <dt id=\"type\"><code>type</code></dt>\n      <dd>\n        <p><code>string</code>. The type of proxy server. One of:</p>\n        <ul>\n          <li>\"http\": HTTP proxy (or SSL CONNECT for HTTPS)</li>\n          <li>\"https\": HTTP proxying over TLS connection to proxy</li>\n          <li>\"socks\": SOCKS v5 proxy</li>\n          <li>\"socks4\": SOCKS v4 proxy</li>\n          <li>\"direct\": no proxy</li>\n          <li>\"unknown\": unknown proxy</li>\n        </ul>\n      </dd>\n      <dt id=\"username\"><code>username</code></dt>\n      <dd>\n        <p><code>string</code>. Username for the proxy service.</p>\n      </dd>\n      <dt id=\"proxydns\"><code>proxyDNS</code></dt>\n      <dd>\n        <p><code>boolean</code>. True if the proxy will perform domain name resolution based on the hostname supplied, meaning that the client should not do its own DNS lookup.</p>\n      </dd>\n      <dt id=\"failovertimeout\"><code>failoverTimeout</code></dt>\n      <dd>\n        <p><code>integer</code>. Failover timeout in seconds. If the proxy connection fails, the proxy will not be used again for this period.</p>\n      </dd>\n    </dl>\n  </dd>\n  <dt id=\"requestbody\"><code>requestBody</code> <span class=\"badge inline optional\">Optional</span></dt>\n  <dd>\n    <p><code>object</code>. Contains the HTTP request body data. Only provided if <code>extraInfoSpec</code> contains <code>\"requestBody\"</code>.</p>\n    <dl>\n      <dt id=\"error\"><code>error</code> <span class=\"badge inline optional\">Optional</span></dt>\n      <dd>\n        <p><code>string</code>. This is set if any errors were encountered when obtaining request body data.</p>\n      </dd>\n      <dt id=\"formdata\"><code>formData</code> <span class=\"badge inline optional\">Optional</span></dt>\n      <dd>\n        <p><code>object</code>. This object is present if the request method is POST and the body is a sequence of key-value pairs encoded in UTF-8 as either \"multipart/form-data\" or \"application/x-www-form-urlencoded\".</p>\n        <p>It is a dictionary in which each key contains the list of all values for that key. For example: <code>{'key': ['value1', 'value2']}</code>. If the data is of another media type, or if it is malformed, the object is not present.</p>\n      </dd>\n      <dt id=\"raw\"><code>raw</code> <span class=\"badge inline optional\">Optional</span></dt>\n      <dd>\n        <p><code>array</code> of <code><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/UploadData\"><code>webRequest.UploadData</code></a></code>. If the request method is PUT or POST, and the body is not already parsed in <code>formData</code>, then this array contains the unparsed request body elements.</p>\n      </dd>\n    </dl>\n  </dd>\n  <dt id=\"requestid\"><code>requestId</code></dt>\n  <dd>\n    <p><code>string</code>. The ID of the request. Request IDs are unique within a browser session, so you can use them to relate different events associated with the same request.</p>\n  </dd>\n  <dt id=\"tabid\"><code>tabId</code></dt>\n  <dd>\n    <p><code>integer</code>. ID of the tab in which the request takes place. Set to -1 if the request isn't related to a tab.</p>\n  </dd>\n  <dt id=\"thirdparty\"><code>thirdParty</code></dt>\n  <dd>\n    <p><code>boolean</code>. Indicates whether the request and its content window hierarchy are third party.</p>\n  </dd>\n  <dt id=\"timestamp\"><code>timeStamp</code></dt>\n  <dd>\n    <p><code>number</code>. The time when this event fired, in <a href=\"https://en.wikipedia.org/wiki/Unix_time\" class=\"external\" target=\"_blank\">milliseconds since the epoch</a>.</p>\n  </dd>\n  <dt id=\"type_2\"><code>type</code></dt>\n  <dd>\n    <p><a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/ResourceType\"><code>webRequest.ResourceType</code></a>. The type of resource being requested: for example, \"image\", \"script\", \"stylesheet\".</p>\n  </dd>\n  <dt id=\"url_2\"><code>url</code></dt>\n  <dd>\n    <p><code>string</code>. Target of the request.</p>\n  </dd>\n  <dt id=\"urlclassification\"><code>urlClassification</code></dt>\n  <dd>\n    <p><code>object</code>. The type of tracking associated with the request, if with the request has been classified by <a href=\"https://support.mozilla.org/en-US/kb/enhanced-tracking-protection-firefox-desktop\" class=\"external\" target=\"_blank\">Firefox Tracking Protection</a>. This is an object with the following properties:</p>\n    <dl>\n      <dt id=\"firstparty\"><code>firstParty</code></dt>\n      <dd>\n        <p><code>array</code> of <code>strings</code>. Classification flags for the request's first party.</p>\n      </dd>\n      <dt id=\"thirdparty_2\"><code>thirdParty</code></dt>\n      <dd>\n        <p><code>array</code> of <code>strings</code>. Classification flags for the request or its window hierarchy's third parties.</p>\n      </dd>\n    </dl>\n    <p>The classification flags include:</p>\n    <ul>\n      <li><code>fingerprinting</code> and <code>fingerprinting_content</code>: indicates the request is involved in fingerprinting. <code>fingerprinting_content</code> indicates the request is loaded from an origin that has been found to fingerprint but is not considered to participate in tracking, such as a payment provider.</li>\n      <li><code>cryptomining</code> and <code>cryptomining_content</code>: similar to the fingerprinting category but for cryptomining resources.</li>\n      <li><code>tracking</code>, <code>tracking_ad</code>, <code>tracking_analytics</code>, <code>tracking_social</code>, and <code>tracking_content</code>: indicates the request is involved in tracking. <code>tracking</code> is any generic tracking request, the <code>ad</code>, <code>analytics</code>, <code>social</code>, and <code>content</code> suffixes identify the type of tracker.</li>\n      <li><code>any_basic_tracking</code>: a meta flag that combines any tracking and fingerprinting flags, excluding <code>tracking_content</code> and <code>fingerprinting_content</code>.</li>\n      <li><code>any_strict_tracking</code>: a meta flag that combines any tracking and fingerprinting flags, including <code>tracking_content</code> and <code>fingerprinting_content</code>.</li>\n      <li><code>any_social_tracking</code>: a meta flag that combines any social tracking flags.</li>\n    </ul>\n  </dd>\n</dl>"}},{"type":"browser_compatibility","value":{"title":"Browser compatibility","id":"browser_compatibility","isH3":false,"query":"webextensions.api.webRequest.onBeforeRequest"}},{"type":"prose","value":{"id":"dns_resolution_ordering_when_blockingresponse_is_used","title":"DNS resolution ordering when BlockingResponse is used","isH3":true,"content":"<p>Regarding DNS resolution when BlockingResponse is used with OnBeforeRequest: In HTTP Channel, onBeforeRequest with blocking response does happen prior to DNS resolution and also prior to speculative connect. For other channels, speculative connect may cause DNS requests to happen before onBeforeRequest. This ordering is not something an extension developer ought to rely on as it may vary across browsers, and from one browser version to another, let alone one request channel to another. Refer <a href=\"https://bugzilla.mozilla.org/show_bug.cgi?id=1466099\" class=\"external\" target=\"_blank\">BugZilla issue clarification provided by Mozilla developers on DNS resolution ordering</a></p>"}},{"type":"prose","value":{"id":"examples","title":"Examples","isH3":false,"content":"<p>This code logs the URL for every resource requested which matches the <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/Match_patterns#all_urls\">&lt;all_urls&gt;</a> pattern:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">function</span> <span class=\"token function\">logURL</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">requestDetails</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Loading: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>requestDetails<span class=\"token punctuation\">.</span>url<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\nbrowser<span class=\"token punctuation\">.</span>webRequest<span class=\"token punctuation\">.</span>onBeforeRequest<span class=\"token punctuation\">.</span><span class=\"token function\">addListener</span><span class=\"token punctuation\">(</span>\n  logURL<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">urls</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"&lt;all_urls&gt;\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>This code cancels requests for images that are made to URLs under \"<a href=\"/\">https://developer.mozilla.org/</a>\" (to see the effect, visit any page on MDN that contains images, such as <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest\">webRequest</a>):</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// match pattern for the URLs to redirect</span>\n<span class=\"token keyword\">let</span> pattern <span class=\"token operator\">=</span> <span class=\"token string\">\"https://developer.mozilla.org/*\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// cancel function returns an object</span>\n<span class=\"token comment\">// which contains a property `cancel` set to `true`</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">cancel</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">requestDetails</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Canceling: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>requestDetails<span class=\"token punctuation\">.</span>url<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">cancel</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// add the listener,</span>\n<span class=\"token comment\">// passing the filter argument and \"blocking\"</span>\nbrowser<span class=\"token punctuation\">.</span>webRequest<span class=\"token punctuation\">.</span>onBeforeRequest<span class=\"token punctuation\">.</span><span class=\"token function\">addListener</span><span class=\"token punctuation\">(</span>\n  cancel<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">urls</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>pattern<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">types</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"image\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">[</span><span class=\"token string\">\"blocking\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>This code replaces, by redirection, all network requests for images that are made to URLs under \"<a href=\"/\">https://developer.mozilla.org/</a>\" (to see the effect, visit any page on MDN that contains images, such as <a href=\"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest\">webRequest</a>):</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// match pattern for the URLs to redirect</span>\n<span class=\"token keyword\">let</span> pattern <span class=\"token operator\">=</span> <span class=\"token string\">\"https://developer.mozilla.org/*\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// redirect function</span>\n<span class=\"token comment\">// returns an object with a property `redirectURL`</span>\n<span class=\"token comment\">// set to the new URL</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">redirect</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">requestDetails</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Redirecting: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>requestDetails<span class=\"token punctuation\">.</span>url<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">redirectUrl</span><span class=\"token operator\">:</span> <span class=\"token string\">\"https://38.media.tumblr.com/tumblr_ldbj01lZiP1qe0eclo1_500.gif\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// add the listener,</span>\n<span class=\"token comment\">// passing the filter argument and \"blocking\"</span>\nbrowser<span class=\"token punctuation\">.</span>webRequest<span class=\"token punctuation\">.</span>onBeforeRequest<span class=\"token punctuation\">.</span><span class=\"token function\">addListener</span><span class=\"token punctuation\">(</span>\n  redirect<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">urls</span><span class=\"token operator\">:</span><span class=\"token punctuation\">[</span>pattern<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">types</span><span class=\"token operator\">:</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"image\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">[</span><span class=\"token string\">\"blocking\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>This code is exactly like the previous example, except that the listener handles the request asynchronously. It returns a <a href=\"/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise\"><code>Promise</code></a> that sets a timer, and resolves with the redirect URL when the timer expires:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token comment\">// match pattern for the URLs to redirect</span>\n<span class=\"token keyword\">let</span> pattern <span class=\"token operator\">=</span> <span class=\"token string\">\"https://developer.mozilla.org/*\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// URL we will redirect to</span>\n<span class=\"token keyword\">let</span> redirectUrl <span class=\"token operator\">=</span> <span class=\"token string\">\"https://38.media.tumblr.com/tumblr_ldbj01lZiP1qe0eclo1_500.gif\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// redirect function returns a Promise</span>\n<span class=\"token comment\">// which is resolved with the redirect URL when a timer expires</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">redirectAsync</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">requestDetails</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Redirecting async: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>requestDetails<span class=\"token punctuation\">.</span>url<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> redirectUrl <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// add the listener,</span>\n<span class=\"token comment\">// passing the filter argument and \"blocking\"</span>\nbrowser<span class=\"token punctuation\">.</span>webRequest<span class=\"token punctuation\">.</span>onBeforeRequest<span class=\"token punctuation\">.</span><span class=\"token function\">addListener</span><span class=\"token punctuation\">(</span>\n  redirectAsync<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">urls</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>pattern<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">types</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"image\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">[</span><span class=\"token string\">\"blocking\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Another example, that redirects all images to a data URL:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">let</span> pattern <span class=\"token operator\">=</span> <span class=\"token string\">\"https://developer.mozilla.org/*\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">let</span> image <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n  &lt;svg xmlns=\"http://www.w3.org/2000/svg\" width=\"100%\" height=\"100%\"&gt;\n    &lt;rect style=\"stroke-width: 10; stroke: #666;\" width=\"100%\" height=\"100%\" fill=\"#d4d0c8\" /&gt;\n    &lt;text transform=\"translate(0, 9)\" x=\"50%\" y=\"50%\" width=\"100%\" fill=\"#666\" height=\"100%\" style=\"text-anchor: middle; font: bold 10pt 'Segoe UI', Arial, Helvetica, Sans-serif;\"&gt;Blocked&lt;/text&gt;\n  &lt;/svg&gt;\n</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">listener</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">details</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> redirectUrl <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">data:image/svg+xml,</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token function\">encodeURIComponent</span><span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> redirectUrl <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\nbrowser<span class=\"token punctuation\">.</span>webRequest<span class=\"token punctuation\">.</span>onBeforeRequest<span class=\"token punctuation\">.</span><span class=\"token function\">addListener</span><span class=\"token punctuation\">(</span>\n  listener<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">urls</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>pattern<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">types</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"image\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">[</span><span class=\"token string\">\"blocking\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>Here's another version:</p>\n<div class=\"code-example\"><pre class=\"brush: js notranslate\"><code><span class=\"token keyword\">function</span> <span class=\"token function\">randomColor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">#</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token number\">16777215</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> pattern <span class=\"token operator\">=</span> <span class=\"token string\">\"https://developer.mozilla.org/*\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">let</span> image <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n  &lt;svg xmlns=\"http://www.w3.org/2000/svg\" width=\"100%\" height=\"100%\"&gt;\n    &lt;rect width=\"100%\" height=\"100%\" fill=\"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token function\">randomColor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\"/&gt;\n  &lt;/svg&gt;\n</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">listener</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">details</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> redirectUrl <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">data:image/svg+xml,</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token function\">encodeURIComponent</span><span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> redirectUrl <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\nbrowser<span class=\"token punctuation\">.</span>webRequest<span class=\"token punctuation\">.</span>onBeforeRequest<span class=\"token punctuation\">.</span><span class=\"token function\">addListener</span><span class=\"token punctuation\">(</span>\n  listener<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">urls</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>pattern<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">types</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"image\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">[</span><span class=\"token string\">\"blocking\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>"}},{"type":"prose","value":{"id":"example_extensions","title":"Example extensions","isH3":true,"content":"<ul><li><a href=\"https://github.com/mdn/webextensions-examples/tree/master/http-response\" class=\"external\" target=\"_blank\">http-response</a></li></ul>\n<div class=\"notecard note\" id=\"sect2\">\n  <p><strong>Note:</strong> This API is based on Chromium's <a href=\"https://developer.chrome.com/docs/extensions/reference/webRequest/#event-onBeforeRequest\" class=\"external\" target=\"_blank\"><code>chrome.webRequest</code></a> API. This documentation is derived from <a href=\"https://chromium.googlesource.com/chromium/src/+/master/extensions/common/api/web_request.json\" class=\"external\" target=\"_blank\"><code>web_request.json</code></a> in the Chromium code.</p>\n</div>\u003c!--\n// Copyright 2015 The Chromium Authors. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are\n// met:\n//\n//    * Redistributions of source code must retain the above copyright\n// notice, this list of conditions and the following disclaimer.\n//    * Redistributions in binary form must reproduce the above\n// copyright notice, this list of conditions and the following disclaimer\n// in the documentation and/or other materials provided with the\n// distribution.\n//    * Neither the name of Google Inc. nor the names of its\n// contributors may be used to endorse or promote products derived from\n// this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n// \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n-->"}}],"toc":[{"text":"Syntax","id":"syntax"},{"text":"addListener syntax","id":"addlistener_syntax"},{"text":"Additional objects","id":"additional_objects"},{"text":"Browser compatibility","id":"browser_compatibility"},{"text":"Examples","id":"examples"}],"summary":"This event is triggered when a request is about to be made, and before headers are available. This is a good place to listen if you want to cancel or redirect the request.","popularity":0,"modified":"2022-12-15T03:18:02.000Z","other_translations":[{"title":"webRequest.onBeforeRequest","locale":"fr","native":"Français"},{"title":"webRequest.onBeforeRequest","locale":"ko","native":"한국어"}],"source":{"folder":"en-us/mozilla/add-ons/webextensions/api/webrequest/onbeforerequest","github_url":"https://github.com/mdn/content/blob/main/files/en-us/mozilla/add-ons/webextensions/api/webrequest/onbeforerequest/index.md","last_commit_url":"https://github.com/mdn/content/commit/915cae6eac9c6ab3cf2e5c03f8bcedb91a414b1d","filename":"index.md"},"short_title":"webRequest.onBeforeRequest","parents":[{"uri":"/en-US/docs/Mozilla","title":"Mozilla"},{"uri":"/en-US/docs/Mozilla/Add-ons","title":"Add-ons"},{"uri":"/en-US/docs/Mozilla/Add-ons/WebExtensions","title":"Browser Extensions"},{"uri":"/en-US/docs/Mozilla/Add-ons/WebExtensions/API","title":"JavaScript APIs"},{"uri":"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest","title":"webRequest"},{"uri":"/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/onBeforeRequest","title":"webRequest.onBeforeRequest"}],"pageTitle":"webRequest.onBeforeRequest - Mozilla | MDN","noIndexing":false}}</script>
<!-- Mirrored from developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webRequest/onBeforeRequest by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 14 Feb 2023 06:11:47 GMT -->
</body></html>